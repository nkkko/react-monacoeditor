{"version":3,"file":"static/js/monaco-editor-vendor.1b18e904.a41328d6.js","mappings":"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","sources":["../../node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/foldingModel.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/hiddenRangeModel.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/foldingDecorations.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/folding.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/foldingRanges.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/indentRangeProvider.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/syntaxRangeProvider.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/fontZoom/browser/fontZoom.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/format/browser/format.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/format/browser/formatActions.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/format/browser/formattingEdit.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/browser/markerNavigationService.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/browser/gotoErrorWidget.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/browser/gotoError.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/symbolNavigation.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/goToCommands.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/goToSymbol.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/link/clickLinkGesture.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/link/goToDefinitionAtPosition.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/peek/referencesTree.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/peek/referencesWidget.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/peek/referencesController.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/referencesModel.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Emitter } from '../../../../base/common/event.js';\nimport { FoldingRegions } from './foldingRanges.js';\nimport { hash } from '../../../../base/common/hash.js';\nexport class FoldingModel {\n    get regions() { return this._regions; }\n    get textModel() { return this._textModel; }\n    constructor(textModel, decorationProvider) {\n        this._updateEventEmitter = new Emitter();\n        this.onDidChange = this._updateEventEmitter.event;\n        this._textModel = textModel;\n        this._decorationProvider = decorationProvider;\n        this._regions = new FoldingRegions(new Uint32Array(0), new Uint32Array(0));\n        this._editorDecorationIds = [];\n    }\n    toggleCollapseState(toggledRegions) {\n        if (!toggledRegions.length) {\n            return;\n        }\n        toggledRegions = toggledRegions.sort((r1, r2) => r1.regionIndex - r2.regionIndex);\n        const processed = {};\n        this._decorationProvider.changeDecorations(accessor => {\n            let k = 0; // index from [0 ... this.regions.length]\n            let dirtyRegionEndLine = -1; // end of the range where decorations need to be updated\n            let lastHiddenLine = -1; // the end of the last hidden lines\n            const updateDecorationsUntil = (index) => {\n                while (k < index) {\n                    const endLineNumber = this._regions.getEndLineNumber(k);\n                    const isCollapsed = this._regions.isCollapsed(k);\n                    if (endLineNumber <= dirtyRegionEndLine) {\n                        const isManual = this.regions.getSource(k) !== 0 /* FoldSource.provider */;\n                        accessor.changeDecorationOptions(this._editorDecorationIds[k], this._decorationProvider.getDecorationOption(isCollapsed, endLineNumber <= lastHiddenLine, isManual));\n                    }\n                    if (isCollapsed && endLineNumber > lastHiddenLine) {\n                        lastHiddenLine = endLineNumber;\n                    }\n                    k++;\n                }\n            };\n            for (const region of toggledRegions) {\n                const index = region.regionIndex;\n                const editorDecorationId = this._editorDecorationIds[index];\n                if (editorDecorationId && !processed[editorDecorationId]) {\n                    processed[editorDecorationId] = true;\n                    updateDecorationsUntil(index); // update all decorations up to current index using the old dirtyRegionEndLine\n                    const newCollapseState = !this._regions.isCollapsed(index);\n                    this._regions.setCollapsed(index, newCollapseState);\n                    dirtyRegionEndLine = Math.max(dirtyRegionEndLine, this._regions.getEndLineNumber(index));\n                }\n            }\n            updateDecorationsUntil(this._regions.length);\n        });\n        this._updateEventEmitter.fire({ model: this, collapseStateChanged: toggledRegions });\n    }\n    removeManualRanges(ranges) {\n        const newFoldingRanges = new Array();\n        const intersects = (foldRange) => {\n            for (const range of ranges) {\n                if (!(range.startLineNumber > foldRange.endLineNumber || foldRange.startLineNumber > range.endLineNumber)) {\n                    return true;\n                }\n            }\n            return false;\n        };\n        for (let i = 0; i < this._regions.length; i++) {\n            const foldRange = this._regions.toFoldRange(i);\n            if (foldRange.source === 0 /* FoldSource.provider */ || !intersects(foldRange)) {\n                newFoldingRanges.push(foldRange);\n            }\n        }\n        this.updatePost(FoldingRegions.fromFoldRanges(newFoldingRanges));\n    }\n    update(newRegions, blockedLineNumers = []) {\n        const foldedOrManualRanges = this._currentFoldedOrManualRanges(blockedLineNumers);\n        const newRanges = FoldingRegions.sanitizeAndMerge(newRegions, foldedOrManualRanges, this._textModel.getLineCount());\n        this.updatePost(FoldingRegions.fromFoldRanges(newRanges));\n    }\n    updatePost(newRegions) {\n        const newEditorDecorations = [];\n        let lastHiddenLine = -1;\n        for (let index = 0, limit = newRegions.length; index < limit; index++) {\n            const startLineNumber = newRegions.getStartLineNumber(index);\n            const endLineNumber = newRegions.getEndLineNumber(index);\n            const isCollapsed = newRegions.isCollapsed(index);\n            const isManual = newRegions.getSource(index) !== 0 /* FoldSource.provider */;\n            const decorationRange = {\n                startLineNumber: startLineNumber,\n                startColumn: this._textModel.getLineMaxColumn(startLineNumber),\n                endLineNumber: endLineNumber,\n                endColumn: this._textModel.getLineMaxColumn(endLineNumber) + 1\n            };\n            newEditorDecorations.push({ range: decorationRange, options: this._decorationProvider.getDecorationOption(isCollapsed, endLineNumber <= lastHiddenLine, isManual) });\n            if (isCollapsed && endLineNumber > lastHiddenLine) {\n                lastHiddenLine = endLineNumber;\n            }\n        }\n        this._decorationProvider.changeDecorations(accessor => this._editorDecorationIds = accessor.deltaDecorations(this._editorDecorationIds, newEditorDecorations));\n        this._regions = newRegions;\n        this._updateEventEmitter.fire({ model: this });\n    }\n    _currentFoldedOrManualRanges(blockedLineNumers = []) {\n        const isBlocked = (startLineNumber, endLineNumber) => {\n            for (const blockedLineNumber of blockedLineNumers) {\n                if (startLineNumber < blockedLineNumber && blockedLineNumber <= endLineNumber) { // first line is visible\n                    return true;\n                }\n            }\n            return false;\n        };\n        const foldedRanges = [];\n        for (let i = 0, limit = this._regions.length; i < limit; i++) {\n            let isCollapsed = this.regions.isCollapsed(i);\n            const source = this.regions.getSource(i);\n            if (isCollapsed || source !== 0 /* FoldSource.provider */) {\n                const foldRange = this._regions.toFoldRange(i);\n                const decRange = this._textModel.getDecorationRange(this._editorDecorationIds[i]);\n                if (decRange) {\n                    if (isCollapsed && isBlocked(decRange.startLineNumber, decRange.endLineNumber)) {\n                        isCollapsed = false; // uncollapse is the range is blocked\n                    }\n                    foldedRanges.push({\n                        startLineNumber: decRange.startLineNumber,\n                        endLineNumber: decRange.endLineNumber,\n                        type: foldRange.type,\n                        isCollapsed,\n                        source\n                    });\n                }\n            }\n        }\n        return foldedRanges;\n    }\n    /**\n     * Collapse state memento, for persistence only\n     */\n    getMemento() {\n        const foldedOrManualRanges = this._currentFoldedOrManualRanges();\n        const result = [];\n        const maxLineNumber = this._textModel.getLineCount();\n        for (let i = 0, limit = foldedOrManualRanges.length; i < limit; i++) {\n            const range = foldedOrManualRanges[i];\n            if (range.startLineNumber >= range.endLineNumber || range.startLineNumber < 1 || range.endLineNumber > maxLineNumber) {\n                continue;\n            }\n            const checksum = this._getLinesChecksum(range.startLineNumber + 1, range.endLineNumber);\n            result.push({\n                startLineNumber: range.startLineNumber,\n                endLineNumber: range.endLineNumber,\n                isCollapsed: range.isCollapsed,\n                source: range.source,\n                checksum: checksum\n            });\n        }\n        return (result.length > 0) ? result : undefined;\n    }\n    /**\n     * Apply persisted state, for persistence only\n     */\n    applyMemento(state) {\n        var _a, _b;\n        if (!Array.isArray(state)) {\n            return;\n        }\n        const rangesToRestore = [];\n        const maxLineNumber = this._textModel.getLineCount();\n        for (const range of state) {\n            if (range.startLineNumber >= range.endLineNumber || range.startLineNumber < 1 || range.endLineNumber > maxLineNumber) {\n                continue;\n            }\n            const checksum = this._getLinesChecksum(range.startLineNumber + 1, range.endLineNumber);\n            if (!range.checksum || checksum === range.checksum) {\n                rangesToRestore.push({\n                    startLineNumber: range.startLineNumber,\n                    endLineNumber: range.endLineNumber,\n                    type: undefined,\n                    isCollapsed: (_a = range.isCollapsed) !== null && _a !== void 0 ? _a : true,\n                    source: (_b = range.source) !== null && _b !== void 0 ? _b : 0 /* FoldSource.provider */\n                });\n            }\n        }\n        const newRanges = FoldingRegions.sanitizeAndMerge(this._regions, rangesToRestore, maxLineNumber);\n        this.updatePost(FoldingRegions.fromFoldRanges(newRanges));\n    }\n    _getLinesChecksum(lineNumber1, lineNumber2) {\n        const h = hash(this._textModel.getLineContent(lineNumber1)\n            + this._textModel.getLineContent(lineNumber2));\n        return h % 1000000; // 6 digits is plenty\n    }\n    dispose() {\n        this._decorationProvider.removeDecorations(this._editorDecorationIds);\n    }\n    getAllRegionsAtLine(lineNumber, filter) {\n        const result = [];\n        if (this._regions) {\n            let index = this._regions.findRange(lineNumber);\n            let level = 1;\n            while (index >= 0) {\n                const current = this._regions.toRegion(index);\n                if (!filter || filter(current, level)) {\n                    result.push(current);\n                }\n                level++;\n                index = current.parentIndex;\n            }\n        }\n        return result;\n    }\n    getRegionAtLine(lineNumber) {\n        if (this._regions) {\n            const index = this._regions.findRange(lineNumber);\n            if (index >= 0) {\n                return this._regions.toRegion(index);\n            }\n        }\n        return null;\n    }\n    getRegionsInside(region, filter) {\n        const result = [];\n        const index = region ? region.regionIndex + 1 : 0;\n        const endLineNumber = region ? region.endLineNumber : Number.MAX_VALUE;\n        if (filter && filter.length === 2) {\n            const levelStack = [];\n            for (let i = index, len = this._regions.length; i < len; i++) {\n                const current = this._regions.toRegion(i);\n                if (this._regions.getStartLineNumber(i) < endLineNumber) {\n                    while (levelStack.length > 0 && !current.containedBy(levelStack[levelStack.length - 1])) {\n                        levelStack.pop();\n                    }\n                    levelStack.push(current);\n                    if (filter(current, levelStack.length)) {\n                        result.push(current);\n                    }\n                }\n                else {\n                    break;\n                }\n            }\n        }\n        else {\n            for (let i = index, len = this._regions.length; i < len; i++) {\n                const current = this._regions.toRegion(i);\n                if (this._regions.getStartLineNumber(i) < endLineNumber) {\n                    if (!filter || filter(current)) {\n                        result.push(current);\n                    }\n                }\n                else {\n                    break;\n                }\n            }\n        }\n        return result;\n    }\n}\n/**\n * Collapse or expand the regions at the given locations\n * @param levels The number of levels. Use 1 to only impact the regions at the location, use Number.MAX_VALUE for all levels.\n * @param lineNumbers the location of the regions to collapse or expand, or if not set, all regions in the model.\n */\nexport function toggleCollapseState(foldingModel, levels, lineNumbers) {\n    const toToggle = [];\n    for (const lineNumber of lineNumbers) {\n        const region = foldingModel.getRegionAtLine(lineNumber);\n        if (region) {\n            const doCollapse = !region.isCollapsed;\n            toToggle.push(region);\n            if (levels > 1) {\n                const regionsInside = foldingModel.getRegionsInside(region, (r, level) => r.isCollapsed !== doCollapse && level < levels);\n                toToggle.push(...regionsInside);\n            }\n        }\n    }\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Collapse or expand the regions at the given locations including all children.\n * @param doCollapse Whether to collapse or expand\n * @param levels The number of levels. Use 1 to only impact the regions at the location, use Number.MAX_VALUE for all levels.\n * @param lineNumbers the location of the regions to collapse or expand, or if not set, all regions in the model.\n */\nexport function setCollapseStateLevelsDown(foldingModel, doCollapse, levels = Number.MAX_VALUE, lineNumbers) {\n    const toToggle = [];\n    if (lineNumbers && lineNumbers.length > 0) {\n        for (const lineNumber of lineNumbers) {\n            const region = foldingModel.getRegionAtLine(lineNumber);\n            if (region) {\n                if (region.isCollapsed !== doCollapse) {\n                    toToggle.push(region);\n                }\n                if (levels > 1) {\n                    const regionsInside = foldingModel.getRegionsInside(region, (r, level) => r.isCollapsed !== doCollapse && level < levels);\n                    toToggle.push(...regionsInside);\n                }\n            }\n        }\n    }\n    else {\n        const regionsInside = foldingModel.getRegionsInside(null, (r, level) => r.isCollapsed !== doCollapse && level < levels);\n        toToggle.push(...regionsInside);\n    }\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Collapse or expand the regions at the given locations including all parents.\n * @param doCollapse Whether to collapse or expand\n * @param levels The number of levels. Use 1 to only impact the regions at the location, use Number.MAX_VALUE for all levels.\n * @param lineNumbers the location of the regions to collapse or expand.\n */\nexport function setCollapseStateLevelsUp(foldingModel, doCollapse, levels, lineNumbers) {\n    const toToggle = [];\n    for (const lineNumber of lineNumbers) {\n        const regions = foldingModel.getAllRegionsAtLine(lineNumber, (region, level) => region.isCollapsed !== doCollapse && level <= levels);\n        toToggle.push(...regions);\n    }\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Collapse or expand a region at the given locations. If the inner most region is already collapsed/expanded, uses the first parent instead.\n * @param doCollapse Whether to collapse or expand\n * @param lineNumbers the location of the regions to collapse or expand.\n */\nexport function setCollapseStateUp(foldingModel, doCollapse, lineNumbers) {\n    const toToggle = [];\n    for (const lineNumber of lineNumbers) {\n        const regions = foldingModel.getAllRegionsAtLine(lineNumber, (region) => region.isCollapsed !== doCollapse);\n        if (regions.length > 0) {\n            toToggle.push(regions[0]);\n        }\n    }\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Folds or unfolds all regions that have a given level, except if they contain one of the blocked lines.\n * @param foldLevel level. Level == 1 is the top level\n * @param doCollapse Whether to collapse or expand\n*/\nexport function setCollapseStateAtLevel(foldingModel, foldLevel, doCollapse, blockedLineNumbers) {\n    const filter = (region, level) => level === foldLevel && region.isCollapsed !== doCollapse && !blockedLineNumbers.some(line => region.containsLine(line));\n    const toToggle = foldingModel.getRegionsInside(null, filter);\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Folds or unfolds all regions, except if they contain or are contained by a region of one of the blocked lines.\n * @param doCollapse Whether to collapse or expand\n * @param blockedLineNumbers the location of regions to not collapse or expand\n */\nexport function setCollapseStateForRest(foldingModel, doCollapse, blockedLineNumbers) {\n    const filteredRegions = [];\n    for (const lineNumber of blockedLineNumbers) {\n        const regions = foldingModel.getAllRegionsAtLine(lineNumber, undefined);\n        if (regions.length > 0) {\n            filteredRegions.push(regions[0]);\n        }\n    }\n    const filter = (region) => filteredRegions.every((filteredRegion) => !filteredRegion.containedBy(region) && !region.containedBy(filteredRegion)) && region.isCollapsed !== doCollapse;\n    const toToggle = foldingModel.getRegionsInside(null, filter);\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Folds all regions for which the lines start with a given regex\n * @param foldingModel the folding model\n */\nexport function setCollapseStateForMatchingLines(foldingModel, regExp, doCollapse) {\n    const editorModel = foldingModel.textModel;\n    const regions = foldingModel.regions;\n    const toToggle = [];\n    for (let i = regions.length - 1; i >= 0; i--) {\n        if (doCollapse !== regions.isCollapsed(i)) {\n            const startLineNumber = regions.getStartLineNumber(i);\n            if (regExp.test(editorModel.getLineContent(startLineNumber))) {\n                toToggle.push(regions.toRegion(i));\n            }\n        }\n    }\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Folds all regions of the given type\n * @param foldingModel the folding model\n */\nexport function setCollapseStateForType(foldingModel, type, doCollapse) {\n    const regions = foldingModel.regions;\n    const toToggle = [];\n    for (let i = regions.length - 1; i >= 0; i--) {\n        if (doCollapse !== regions.isCollapsed(i) && type === regions.getType(i)) {\n            toToggle.push(regions.toRegion(i));\n        }\n    }\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Get line to go to for parent fold of current line\n * @param lineNumber the current line number\n * @param foldingModel the folding model\n *\n * @return Parent fold start line\n */\nexport function getParentFoldLine(lineNumber, foldingModel) {\n    let startLineNumber = null;\n    const foldingRegion = foldingModel.getRegionAtLine(lineNumber);\n    if (foldingRegion !== null) {\n        startLineNumber = foldingRegion.startLineNumber;\n        // If current line is not the start of the current fold, go to top line of current fold. If not, go to parent fold\n        if (lineNumber === startLineNumber) {\n            const parentFoldingIdx = foldingRegion.parentIndex;\n            if (parentFoldingIdx !== -1) {\n                startLineNumber = foldingModel.regions.getStartLineNumber(parentFoldingIdx);\n            }\n            else {\n                startLineNumber = null;\n            }\n        }\n    }\n    return startLineNumber;\n}\n/**\n * Get line to go to for previous fold at the same level of current line\n * @param lineNumber the current line number\n * @param foldingModel the folding model\n *\n * @return Previous fold start line\n */\nexport function getPreviousFoldLine(lineNumber, foldingModel) {\n    let foldingRegion = foldingModel.getRegionAtLine(lineNumber);\n    // If on the folding range start line, go to previous sibling.\n    if (foldingRegion !== null && foldingRegion.startLineNumber === lineNumber) {\n        // If current line is not the start of the current fold, go to top line of current fold. If not, go to previous fold.\n        if (lineNumber !== foldingRegion.startLineNumber) {\n            return foldingRegion.startLineNumber;\n        }\n        else {\n            // Find min line number to stay within parent.\n            const expectedParentIndex = foldingRegion.parentIndex;\n            let minLineNumber = 0;\n            if (expectedParentIndex !== -1) {\n                minLineNumber = foldingModel.regions.getStartLineNumber(foldingRegion.parentIndex);\n            }\n            // Find fold at same level.\n            while (foldingRegion !== null) {\n                if (foldingRegion.regionIndex > 0) {\n                    foldingRegion = foldingModel.regions.toRegion(foldingRegion.regionIndex - 1);\n                    // Keep at same level.\n                    if (foldingRegion.startLineNumber <= minLineNumber) {\n                        return null;\n                    }\n                    else if (foldingRegion.parentIndex === expectedParentIndex) {\n                        return foldingRegion.startLineNumber;\n                    }\n                }\n                else {\n                    return null;\n                }\n            }\n        }\n    }\n    else {\n        // Go to last fold that's before the current line.\n        if (foldingModel.regions.length > 0) {\n            foldingRegion = foldingModel.regions.toRegion(foldingModel.regions.length - 1);\n            while (foldingRegion !== null) {\n                // Found fold before current line.\n                if (foldingRegion.startLineNumber < lineNumber) {\n                    return foldingRegion.startLineNumber;\n                }\n                if (foldingRegion.regionIndex > 0) {\n                    foldingRegion = foldingModel.regions.toRegion(foldingRegion.regionIndex - 1);\n                }\n                else {\n                    foldingRegion = null;\n                }\n            }\n        }\n    }\n    return null;\n}\n/**\n * Get line to go to next fold at the same level of current line\n * @param lineNumber the current line number\n * @param foldingModel the folding model\n *\n * @return Next fold start line\n */\nexport function getNextFoldLine(lineNumber, foldingModel) {\n    let foldingRegion = foldingModel.getRegionAtLine(lineNumber);\n    // If on the folding range start line, go to next sibling.\n    if (foldingRegion !== null && foldingRegion.startLineNumber === lineNumber) {\n        // Find max line number to stay within parent.\n        const expectedParentIndex = foldingRegion.parentIndex;\n        let maxLineNumber = 0;\n        if (expectedParentIndex !== -1) {\n            maxLineNumber = foldingModel.regions.getEndLineNumber(foldingRegion.parentIndex);\n        }\n        else if (foldingModel.regions.length === 0) {\n            return null;\n        }\n        else {\n            maxLineNumber = foldingModel.regions.getEndLineNumber(foldingModel.regions.length - 1);\n        }\n        // Find fold at same level.\n        while (foldingRegion !== null) {\n            if (foldingRegion.regionIndex < foldingModel.regions.length) {\n                foldingRegion = foldingModel.regions.toRegion(foldingRegion.regionIndex + 1);\n                // Keep at same level.\n                if (foldingRegion.startLineNumber >= maxLineNumber) {\n                    return null;\n                }\n                else if (foldingRegion.parentIndex === expectedParentIndex) {\n                    return foldingRegion.startLineNumber;\n                }\n            }\n            else {\n                return null;\n            }\n        }\n    }\n    else {\n        // Go to first fold that's after the current line.\n        if (foldingModel.regions.length > 0) {\n            foldingRegion = foldingModel.regions.toRegion(0);\n            while (foldingRegion !== null) {\n                // Found fold after current line.\n                if (foldingRegion.startLineNumber > lineNumber) {\n                    return foldingRegion.startLineNumber;\n                }\n                if (foldingRegion.regionIndex < foldingModel.regions.length) {\n                    foldingRegion = foldingModel.regions.toRegion(foldingRegion.regionIndex + 1);\n                }\n                else {\n                    foldingRegion = null;\n                }\n            }\n        }\n    }\n    return null;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { findFirstInSorted } from '../../../../base/common/arrays.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Range } from '../../../common/core/range.js';\nimport { countEOL } from '../../../common/core/eolCounter.js';\nexport class HiddenRangeModel {\n    get onDidChange() { return this._updateEventEmitter.event; }\n    get hiddenRanges() { return this._hiddenRanges; }\n    constructor(model) {\n        this._updateEventEmitter = new Emitter();\n        this._hasLineChanges = false;\n        this._foldingModel = model;\n        this._foldingModelListener = model.onDidChange(_ => this.updateHiddenRanges());\n        this._hiddenRanges = [];\n        if (model.regions.length) {\n            this.updateHiddenRanges();\n        }\n    }\n    notifyChangeModelContent(e) {\n        if (this._hiddenRanges.length && !this._hasLineChanges) {\n            this._hasLineChanges = e.changes.some(change => {\n                return change.range.endLineNumber !== change.range.startLineNumber || countEOL(change.text)[0] !== 0;\n            });\n        }\n    }\n    updateHiddenRanges() {\n        let updateHiddenAreas = false;\n        const newHiddenAreas = [];\n        let i = 0; // index into hidden\n        let k = 0;\n        let lastCollapsedStart = Number.MAX_VALUE;\n        let lastCollapsedEnd = -1;\n        const ranges = this._foldingModel.regions;\n        for (; i < ranges.length; i++) {\n            if (!ranges.isCollapsed(i)) {\n                continue;\n            }\n            const startLineNumber = ranges.getStartLineNumber(i) + 1; // the first line is not hidden\n            const endLineNumber = ranges.getEndLineNumber(i);\n            if (lastCollapsedStart <= startLineNumber && endLineNumber <= lastCollapsedEnd) {\n                // ignore ranges contained in collapsed regions\n                continue;\n            }\n            if (!updateHiddenAreas && k < this._hiddenRanges.length && this._hiddenRanges[k].startLineNumber === startLineNumber && this._hiddenRanges[k].endLineNumber === endLineNumber) {\n                // reuse the old ranges\n                newHiddenAreas.push(this._hiddenRanges[k]);\n                k++;\n            }\n            else {\n                updateHiddenAreas = true;\n                newHiddenAreas.push(new Range(startLineNumber, 1, endLineNumber, 1));\n            }\n            lastCollapsedStart = startLineNumber;\n            lastCollapsedEnd = endLineNumber;\n        }\n        if (this._hasLineChanges || updateHiddenAreas || k < this._hiddenRanges.length) {\n            this.applyHiddenRanges(newHiddenAreas);\n        }\n    }\n    applyHiddenRanges(newHiddenAreas) {\n        this._hiddenRanges = newHiddenAreas;\n        this._hasLineChanges = false;\n        this._updateEventEmitter.fire(newHiddenAreas);\n    }\n    hasRanges() {\n        return this._hiddenRanges.length > 0;\n    }\n    isHidden(line) {\n        return findRange(this._hiddenRanges, line) !== null;\n    }\n    adjustSelections(selections) {\n        let hasChanges = false;\n        const editorModel = this._foldingModel.textModel;\n        let lastRange = null;\n        const adjustLine = (line) => {\n            if (!lastRange || !isInside(line, lastRange)) {\n                lastRange = findRange(this._hiddenRanges, line);\n            }\n            if (lastRange) {\n                return lastRange.startLineNumber - 1;\n            }\n            return null;\n        };\n        for (let i = 0, len = selections.length; i < len; i++) {\n            let selection = selections[i];\n            const adjustedStartLine = adjustLine(selection.startLineNumber);\n            if (adjustedStartLine) {\n                selection = selection.setStartPosition(adjustedStartLine, editorModel.getLineMaxColumn(adjustedStartLine));\n                hasChanges = true;\n            }\n            const adjustedEndLine = adjustLine(selection.endLineNumber);\n            if (adjustedEndLine) {\n                selection = selection.setEndPosition(adjustedEndLine, editorModel.getLineMaxColumn(adjustedEndLine));\n                hasChanges = true;\n            }\n            selections[i] = selection;\n        }\n        return hasChanges;\n    }\n    dispose() {\n        if (this.hiddenRanges.length > 0) {\n            this._hiddenRanges = [];\n            this._updateEventEmitter.fire(this._hiddenRanges);\n        }\n        if (this._foldingModelListener) {\n            this._foldingModelListener.dispose();\n            this._foldingModelListener = null;\n        }\n    }\n}\nfunction isInside(line, range) {\n    return line >= range.startLineNumber && line <= range.endLineNumber;\n}\nfunction findRange(ranges, line) {\n    const i = findFirstInSorted(ranges, r => line < r.startLineNumber) - 1;\n    if (i >= 0 && ranges[i].endLineNumber >= line) {\n        return ranges[i];\n    }\n    return null;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { MinimapPosition } from '../../../common/model.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { localize } from '../../../../nls.js';\nimport { editorSelectionBackground, iconForeground, registerColor, transparent } from '../../../../platform/theme/common/colorRegistry.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nimport { themeColorFromId } from '../../../../platform/theme/common/themeService.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nconst foldBackground = registerColor('editor.foldBackground', { light: transparent(editorSelectionBackground, 0.3), dark: transparent(editorSelectionBackground, 0.3), hcDark: null, hcLight: null }, localize('foldBackgroundBackground', \"Background color behind folded ranges. The color must not be opaque so as not to hide underlying decorations.\"), true);\nregisterColor('editorGutter.foldingControlForeground', { dark: iconForeground, light: iconForeground, hcDark: iconForeground, hcLight: iconForeground }, localize('editorGutter.foldingControlForeground', 'Color of the folding control in the editor gutter.'));\nexport const foldingExpandedIcon = registerIcon('folding-expanded', Codicon.chevronDown, localize('foldingExpandedIcon', 'Icon for expanded ranges in the editor glyph margin.'));\nexport const foldingCollapsedIcon = registerIcon('folding-collapsed', Codicon.chevronRight, localize('foldingCollapsedIcon', 'Icon for collapsed ranges in the editor glyph margin.'));\nexport const foldingManualCollapsedIcon = registerIcon('folding-manual-collapsed', foldingCollapsedIcon, localize('foldingManualCollapedIcon', 'Icon for manually collapsed ranges in the editor glyph margin.'));\nexport const foldingManualExpandedIcon = registerIcon('folding-manual-expanded', foldingExpandedIcon, localize('foldingManualExpandedIcon', 'Icon for manually expanded ranges in the editor glyph margin.'));\nconst foldedBackgroundMinimap = { color: themeColorFromId(foldBackground), position: MinimapPosition.Inline };\nexport class FoldingDecorationProvider {\n    constructor(editor) {\n        this.editor = editor;\n        this.showFoldingControls = 'mouseover';\n        this.showFoldingHighlights = true;\n    }\n    getDecorationOption(isCollapsed, isHidden, isManual) {\n        if (isHidden) { // is inside another collapsed region\n            return FoldingDecorationProvider.HIDDEN_RANGE_DECORATION;\n        }\n        if (this.showFoldingControls === 'never') {\n            if (isCollapsed) {\n                return this.showFoldingHighlights ? FoldingDecorationProvider.NO_CONTROLS_COLLAPSED_HIGHLIGHTED_RANGE_DECORATION : FoldingDecorationProvider.NO_CONTROLS_COLLAPSED_RANGE_DECORATION;\n            }\n            return FoldingDecorationProvider.NO_CONTROLS_EXPANDED_RANGE_DECORATION;\n        }\n        if (isCollapsed) {\n            return isManual ?\n                (this.showFoldingHighlights ? FoldingDecorationProvider.MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION : FoldingDecorationProvider.MANUALLY_COLLAPSED_VISUAL_DECORATION)\n                : (this.showFoldingHighlights ? FoldingDecorationProvider.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION : FoldingDecorationProvider.COLLAPSED_VISUAL_DECORATION);\n        }\n        else if (this.showFoldingControls === 'mouseover') {\n            return isManual ? FoldingDecorationProvider.MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION : FoldingDecorationProvider.EXPANDED_AUTO_HIDE_VISUAL_DECORATION;\n        }\n        else {\n            return isManual ? FoldingDecorationProvider.MANUALLY_EXPANDED_VISUAL_DECORATION : FoldingDecorationProvider.EXPANDED_VISUAL_DECORATION;\n        }\n    }\n    changeDecorations(callback) {\n        return this.editor.changeDecorations(callback);\n    }\n    removeDecorations(decorationIds) {\n        this.editor.removeDecorations(decorationIds);\n    }\n}\nFoldingDecorationProvider.COLLAPSED_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-collapsed-visual-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    afterContentClassName: 'inline-folded',\n    isWholeLine: true,\n    firstLineDecorationClassName: ThemeIcon.asClassName(foldingCollapsedIcon),\n});\nFoldingDecorationProvider.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-collapsed-highlighted-visual-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    afterContentClassName: 'inline-folded',\n    className: 'folded-background',\n    minimap: foldedBackgroundMinimap,\n    isWholeLine: true,\n    firstLineDecorationClassName: ThemeIcon.asClassName(foldingCollapsedIcon)\n});\nFoldingDecorationProvider.MANUALLY_COLLAPSED_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-manually-collapsed-visual-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    afterContentClassName: 'inline-folded',\n    isWholeLine: true,\n    firstLineDecorationClassName: ThemeIcon.asClassName(foldingManualCollapsedIcon)\n});\nFoldingDecorationProvider.MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-manually-collapsed-highlighted-visual-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    afterContentClassName: 'inline-folded',\n    className: 'folded-background',\n    minimap: foldedBackgroundMinimap,\n    isWholeLine: true,\n    firstLineDecorationClassName: ThemeIcon.asClassName(foldingManualCollapsedIcon)\n});\nFoldingDecorationProvider.NO_CONTROLS_COLLAPSED_RANGE_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-no-controls-range-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    afterContentClassName: 'inline-folded',\n    isWholeLine: true\n});\nFoldingDecorationProvider.NO_CONTROLS_COLLAPSED_HIGHLIGHTED_RANGE_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-no-controls-range-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    afterContentClassName: 'inline-folded',\n    className: 'folded-background',\n    minimap: foldedBackgroundMinimap,\n    isWholeLine: true\n});\nFoldingDecorationProvider.EXPANDED_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-expanded-visual-decoration',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    isWholeLine: true,\n    firstLineDecorationClassName: 'alwaysShowFoldIcons ' + ThemeIcon.asClassName(foldingExpandedIcon)\n});\nFoldingDecorationProvider.EXPANDED_AUTO_HIDE_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-expanded-auto-hide-visual-decoration',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    isWholeLine: true,\n    firstLineDecorationClassName: ThemeIcon.asClassName(foldingExpandedIcon)\n});\nFoldingDecorationProvider.MANUALLY_EXPANDED_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-manually-expanded-visual-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    isWholeLine: true,\n    firstLineDecorationClassName: 'alwaysShowFoldIcons ' + ThemeIcon.asClassName(foldingManualExpandedIcon)\n});\nFoldingDecorationProvider.MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-manually-expanded-auto-hide-visual-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    isWholeLine: true,\n    firstLineDecorationClassName: ThemeIcon.asClassName(foldingManualExpandedIcon)\n});\nFoldingDecorationProvider.NO_CONTROLS_EXPANDED_RANGE_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-no-controls-range-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    isWholeLine: true\n});\nFoldingDecorationProvider.HIDDEN_RANGE_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-hidden-range-decoration',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { createCancelablePromise, Delayer, RunOnceScheduler } from '../../../../base/common/async.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { illegalArgument, onUnexpectedError } from '../../../../base/common/errors.js';\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { escapeRegExpCharacters } from '../../../../base/common/strings.js';\nimport * as types from '../../../../base/common/types.js';\nimport './folding.css';\nimport { StableEditorScrollState } from '../../../browser/stableEditorScroll.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution, registerInstantiatedEditorAction } from '../../../browser/editorExtensions.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { FoldingRangeKind } from '../../../common/languages.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { FoldingModel, getNextFoldLine, getParentFoldLine as getParentFoldLine, getPreviousFoldLine, setCollapseStateAtLevel, setCollapseStateForMatchingLines, setCollapseStateForRest, setCollapseStateForType, setCollapseStateLevelsDown, setCollapseStateLevelsUp, setCollapseStateUp, toggleCollapseState } from './foldingModel.js';\nimport { HiddenRangeModel } from './hiddenRangeModel.js';\nimport { IndentRangeProvider } from './indentRangeProvider.js';\nimport * as nls from '../../../../nls.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { FoldingDecorationProvider } from './foldingDecorations.js';\nimport { FoldingRegions } from './foldingRanges.js';\nimport { SyntaxRangeProvider } from './syntaxRangeProvider.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nconst CONTEXT_FOLDING_ENABLED = new RawContextKey('foldingEnabled', false);\nexport let FoldingController = class FoldingController extends Disposable {\n    static get(editor) {\n        return editor.getContribution(FoldingController.ID);\n    }\n    static getFoldingRangeProviders(languageFeaturesService, model) {\n        var _a, _b;\n        const foldingRangeProviders = languageFeaturesService.foldingRangeProvider.ordered(model);\n        return (_b = ((_a = FoldingController._foldingRangeSelector) === null || _a === void 0 ? void 0 : _a.call(FoldingController, foldingRangeProviders, model))) !== null && _b !== void 0 ? _b : foldingRangeProviders;\n    }\n    constructor(editor, contextKeyService, languageConfigurationService, notificationService, languageFeatureDebounceService, languageFeaturesService) {\n        super();\n        this.contextKeyService = contextKeyService;\n        this.languageConfigurationService = languageConfigurationService;\n        this.languageFeaturesService = languageFeaturesService;\n        this.localToDispose = this._register(new DisposableStore());\n        this.editor = editor;\n        this._foldingLimitReporter = new RangesLimitReporter(editor);\n        const options = this.editor.getOptions();\n        this._isEnabled = options.get(41 /* EditorOption.folding */);\n        this._useFoldingProviders = options.get(42 /* EditorOption.foldingStrategy */) !== 'indentation';\n        this._unfoldOnClickAfterEndOfLine = options.get(46 /* EditorOption.unfoldOnClickAfterEndOfLine */);\n        this._restoringViewState = false;\n        this._currentModelHasFoldedImports = false;\n        this._foldingImportsByDefault = options.get(44 /* EditorOption.foldingImportsByDefault */);\n        this.updateDebounceInfo = languageFeatureDebounceService.for(languageFeaturesService.foldingRangeProvider, 'Folding', { min: 200 });\n        this.foldingModel = null;\n        this.hiddenRangeModel = null;\n        this.rangeProvider = null;\n        this.foldingRegionPromise = null;\n        this.foldingModelPromise = null;\n        this.updateScheduler = null;\n        this.cursorChangedScheduler = null;\n        this.mouseDownInfo = null;\n        this.foldingDecorationProvider = new FoldingDecorationProvider(editor);\n        this.foldingDecorationProvider.showFoldingControls = options.get(106 /* EditorOption.showFoldingControls */);\n        this.foldingDecorationProvider.showFoldingHighlights = options.get(43 /* EditorOption.foldingHighlight */);\n        this.foldingEnabled = CONTEXT_FOLDING_ENABLED.bindTo(this.contextKeyService);\n        this.foldingEnabled.set(this._isEnabled);\n        this._register(this.editor.onDidChangeModel(() => this.onModelChanged()));\n        this._register(this.editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(41 /* EditorOption.folding */)) {\n                this._isEnabled = this.editor.getOptions().get(41 /* EditorOption.folding */);\n                this.foldingEnabled.set(this._isEnabled);\n                this.onModelChanged();\n            }\n            if (e.hasChanged(45 /* EditorOption.foldingMaximumRegions */)) {\n                this.onModelChanged();\n            }\n            if (e.hasChanged(106 /* EditorOption.showFoldingControls */) || e.hasChanged(43 /* EditorOption.foldingHighlight */)) {\n                const options = this.editor.getOptions();\n                this.foldingDecorationProvider.showFoldingControls = options.get(106 /* EditorOption.showFoldingControls */);\n                this.foldingDecorationProvider.showFoldingHighlights = options.get(43 /* EditorOption.foldingHighlight */);\n                this.triggerFoldingModelChanged();\n            }\n            if (e.hasChanged(42 /* EditorOption.foldingStrategy */)) {\n                this._useFoldingProviders = this.editor.getOptions().get(42 /* EditorOption.foldingStrategy */) !== 'indentation';\n                this.onFoldingStrategyChanged();\n            }\n            if (e.hasChanged(46 /* EditorOption.unfoldOnClickAfterEndOfLine */)) {\n                this._unfoldOnClickAfterEndOfLine = this.editor.getOptions().get(46 /* EditorOption.unfoldOnClickAfterEndOfLine */);\n            }\n            if (e.hasChanged(44 /* EditorOption.foldingImportsByDefault */)) {\n                this._foldingImportsByDefault = this.editor.getOptions().get(44 /* EditorOption.foldingImportsByDefault */);\n            }\n        }));\n        this.onModelChanged();\n    }\n    /**\n     * Store view state.\n     */\n    saveViewState() {\n        const model = this.editor.getModel();\n        if (!model || !this._isEnabled || model.isTooLargeForTokenization()) {\n            return {};\n        }\n        if (this.foldingModel) { // disposed ?\n            const collapsedRegions = this.foldingModel.getMemento();\n            const provider = this.rangeProvider ? this.rangeProvider.id : undefined;\n            return { collapsedRegions, lineCount: model.getLineCount(), provider, foldedImports: this._currentModelHasFoldedImports };\n        }\n        return undefined;\n    }\n    /**\n     * Restore view state.\n     */\n    restoreViewState(state) {\n        const model = this.editor.getModel();\n        if (!model || !this._isEnabled || model.isTooLargeForTokenization() || !this.hiddenRangeModel) {\n            return;\n        }\n        if (!state) {\n            return;\n        }\n        this._currentModelHasFoldedImports = !!state.foldedImports;\n        if (state.collapsedRegions && state.collapsedRegions.length > 0 && this.foldingModel) {\n            this._restoringViewState = true;\n            try {\n                this.foldingModel.applyMemento(state.collapsedRegions);\n            }\n            finally {\n                this._restoringViewState = false;\n            }\n        }\n    }\n    onModelChanged() {\n        this.localToDispose.clear();\n        const model = this.editor.getModel();\n        if (!this._isEnabled || !model || model.isTooLargeForTokenization()) {\n            // huge files get no view model, so they cannot support hidden areas\n            return;\n        }\n        this._currentModelHasFoldedImports = false;\n        this.foldingModel = new FoldingModel(model, this.foldingDecorationProvider);\n        this.localToDispose.add(this.foldingModel);\n        this.hiddenRangeModel = new HiddenRangeModel(this.foldingModel);\n        this.localToDispose.add(this.hiddenRangeModel);\n        this.localToDispose.add(this.hiddenRangeModel.onDidChange(hr => this.onHiddenRangesChanges(hr)));\n        this.updateScheduler = new Delayer(this.updateDebounceInfo.get(model));\n        this.cursorChangedScheduler = new RunOnceScheduler(() => this.revealCursor(), 200);\n        this.localToDispose.add(this.cursorChangedScheduler);\n        this.localToDispose.add(this.languageFeaturesService.foldingRangeProvider.onDidChange(() => this.onFoldingStrategyChanged()));\n        this.localToDispose.add(this.editor.onDidChangeModelLanguageConfiguration(() => this.onFoldingStrategyChanged())); // covers model language changes as well\n        this.localToDispose.add(this.editor.onDidChangeModelContent(e => this.onDidChangeModelContent(e)));\n        this.localToDispose.add(this.editor.onDidChangeCursorPosition(() => this.onCursorPositionChanged()));\n        this.localToDispose.add(this.editor.onMouseDown(e => this.onEditorMouseDown(e)));\n        this.localToDispose.add(this.editor.onMouseUp(e => this.onEditorMouseUp(e)));\n        this.localToDispose.add({\n            dispose: () => {\n                var _a, _b;\n                if (this.foldingRegionPromise) {\n                    this.foldingRegionPromise.cancel();\n                    this.foldingRegionPromise = null;\n                }\n                (_a = this.updateScheduler) === null || _a === void 0 ? void 0 : _a.cancel();\n                this.updateScheduler = null;\n                this.foldingModel = null;\n                this.foldingModelPromise = null;\n                this.hiddenRangeModel = null;\n                this.cursorChangedScheduler = null;\n                (_b = this.rangeProvider) === null || _b === void 0 ? void 0 : _b.dispose();\n                this.rangeProvider = null;\n            }\n        });\n        this.triggerFoldingModelChanged();\n    }\n    onFoldingStrategyChanged() {\n        var _a;\n        (_a = this.rangeProvider) === null || _a === void 0 ? void 0 : _a.dispose();\n        this.rangeProvider = null;\n        this.triggerFoldingModelChanged();\n    }\n    getRangeProvider(editorModel) {\n        if (this.rangeProvider) {\n            return this.rangeProvider;\n        }\n        const indentRangeProvider = new IndentRangeProvider(editorModel, this.languageConfigurationService, this._foldingLimitReporter);\n        this.rangeProvider = indentRangeProvider; // fallback\n        if (this._useFoldingProviders && this.foldingModel) {\n            const selectedProviders = FoldingController.getFoldingRangeProviders(this.languageFeaturesService, editorModel);\n            if (selectedProviders.length > 0) {\n                this.rangeProvider = new SyntaxRangeProvider(editorModel, selectedProviders, () => this.triggerFoldingModelChanged(), this._foldingLimitReporter, indentRangeProvider);\n            }\n        }\n        return this.rangeProvider;\n    }\n    getFoldingModel() {\n        return this.foldingModelPromise;\n    }\n    onDidChangeModelContent(e) {\n        var _a;\n        (_a = this.hiddenRangeModel) === null || _a === void 0 ? void 0 : _a.notifyChangeModelContent(e);\n        this.triggerFoldingModelChanged();\n    }\n    triggerFoldingModelChanged() {\n        if (this.updateScheduler) {\n            if (this.foldingRegionPromise) {\n                this.foldingRegionPromise.cancel();\n                this.foldingRegionPromise = null;\n            }\n            this.foldingModelPromise = this.updateScheduler.trigger(() => {\n                const foldingModel = this.foldingModel;\n                if (!foldingModel) { // null if editor has been disposed, or folding turned off\n                    return null;\n                }\n                const sw = new StopWatch(true);\n                const provider = this.getRangeProvider(foldingModel.textModel);\n                const foldingRegionPromise = this.foldingRegionPromise = createCancelablePromise(token => provider.compute(token));\n                return foldingRegionPromise.then(foldingRanges => {\n                    if (foldingRanges && foldingRegionPromise === this.foldingRegionPromise) { // new request or cancelled in the meantime?\n                        let scrollState;\n                        if (this._foldingImportsByDefault && !this._currentModelHasFoldedImports) {\n                            const hasChanges = foldingRanges.setCollapsedAllOfType(FoldingRangeKind.Imports.value, true);\n                            if (hasChanges) {\n                                scrollState = StableEditorScrollState.capture(this.editor);\n                                this._currentModelHasFoldedImports = hasChanges;\n                            }\n                        }\n                        // some cursors might have moved into hidden regions, make sure they are in expanded regions\n                        const selections = this.editor.getSelections();\n                        const selectionLineNumbers = selections ? selections.map(s => s.startLineNumber) : [];\n                        foldingModel.update(foldingRanges, selectionLineNumbers);\n                        scrollState === null || scrollState === void 0 ? void 0 : scrollState.restore(this.editor);\n                        // update debounce info\n                        const newValue = this.updateDebounceInfo.update(foldingModel.textModel, sw.elapsed());\n                        if (this.updateScheduler) {\n                            this.updateScheduler.defaultDelay = newValue;\n                        }\n                    }\n                    return foldingModel;\n                });\n            }).then(undefined, (err) => {\n                onUnexpectedError(err);\n                return null;\n            });\n        }\n    }\n    onHiddenRangesChanges(hiddenRanges) {\n        if (this.hiddenRangeModel && hiddenRanges.length && !this._restoringViewState) {\n            const selections = this.editor.getSelections();\n            if (selections) {\n                if (this.hiddenRangeModel.adjustSelections(selections)) {\n                    this.editor.setSelections(selections);\n                }\n            }\n        }\n        this.editor.setHiddenAreas(hiddenRanges, this);\n    }\n    onCursorPositionChanged() {\n        if (this.hiddenRangeModel && this.hiddenRangeModel.hasRanges()) {\n            this.cursorChangedScheduler.schedule();\n        }\n    }\n    revealCursor() {\n        const foldingModel = this.getFoldingModel();\n        if (!foldingModel) {\n            return;\n        }\n        foldingModel.then(foldingModel => {\n            if (foldingModel) {\n                const selections = this.editor.getSelections();\n                if (selections && selections.length > 0) {\n                    const toToggle = [];\n                    for (const selection of selections) {\n                        const lineNumber = selection.selectionStartLineNumber;\n                        if (this.hiddenRangeModel && this.hiddenRangeModel.isHidden(lineNumber)) {\n                            toToggle.push(...foldingModel.getAllRegionsAtLine(lineNumber, r => r.isCollapsed && lineNumber > r.startLineNumber));\n                        }\n                    }\n                    if (toToggle.length) {\n                        foldingModel.toggleCollapseState(toToggle);\n                        this.reveal(selections[0].getPosition());\n                    }\n                }\n            }\n        }).then(undefined, onUnexpectedError);\n    }\n    onEditorMouseDown(e) {\n        this.mouseDownInfo = null;\n        if (!this.hiddenRangeModel || !e.target || !e.target.range) {\n            return;\n        }\n        if (!e.event.leftButton && !e.event.middleButton) {\n            return;\n        }\n        const range = e.target.range;\n        let iconClicked = false;\n        switch (e.target.type) {\n            case 4 /* MouseTargetType.GUTTER_LINE_DECORATIONS */: {\n                const data = e.target.detail;\n                const offsetLeftInGutter = e.target.element.offsetLeft;\n                const gutterOffsetX = data.offsetX - offsetLeftInGutter;\n                // const gutterOffsetX = data.offsetX - data.glyphMarginWidth - data.lineNumbersWidth - data.glyphMarginLeft;\n                // TODO@joao TODO@alex TODO@martin this is such that we don't collide with dirty diff\n                if (gutterOffsetX < 5) { // the whitespace between the border and the real folding icon border is 5px\n                    return;\n                }\n                iconClicked = true;\n                break;\n            }\n            case 7 /* MouseTargetType.CONTENT_EMPTY */: {\n                if (this._unfoldOnClickAfterEndOfLine && this.hiddenRangeModel.hasRanges()) {\n                    const data = e.target.detail;\n                    if (!data.isAfterLines) {\n                        break;\n                    }\n                }\n                return;\n            }\n            case 6 /* MouseTargetType.CONTENT_TEXT */: {\n                if (this.hiddenRangeModel.hasRanges()) {\n                    const model = this.editor.getModel();\n                    if (model && range.startColumn === model.getLineMaxColumn(range.startLineNumber)) {\n                        break;\n                    }\n                }\n                return;\n            }\n            default:\n                return;\n        }\n        this.mouseDownInfo = { lineNumber: range.startLineNumber, iconClicked };\n    }\n    onEditorMouseUp(e) {\n        const foldingModel = this.foldingModel;\n        if (!foldingModel || !this.mouseDownInfo || !e.target) {\n            return;\n        }\n        const lineNumber = this.mouseDownInfo.lineNumber;\n        const iconClicked = this.mouseDownInfo.iconClicked;\n        const range = e.target.range;\n        if (!range || range.startLineNumber !== lineNumber) {\n            return;\n        }\n        if (iconClicked) {\n            if (e.target.type !== 4 /* MouseTargetType.GUTTER_LINE_DECORATIONS */) {\n                return;\n            }\n        }\n        else {\n            const model = this.editor.getModel();\n            if (!model || range.startColumn !== model.getLineMaxColumn(lineNumber)) {\n                return;\n            }\n        }\n        const region = foldingModel.getRegionAtLine(lineNumber);\n        if (region && region.startLineNumber === lineNumber) {\n            const isCollapsed = region.isCollapsed;\n            if (iconClicked || isCollapsed) {\n                const surrounding = e.event.altKey;\n                let toToggle = [];\n                if (surrounding) {\n                    const filter = (otherRegion) => !otherRegion.containedBy(region) && !region.containedBy(otherRegion);\n                    const toMaybeToggle = foldingModel.getRegionsInside(null, filter);\n                    for (const r of toMaybeToggle) {\n                        if (r.isCollapsed) {\n                            toToggle.push(r);\n                        }\n                    }\n                    // if any surrounding regions are folded, unfold those. Otherwise, fold all surrounding\n                    if (toToggle.length === 0) {\n                        toToggle = toMaybeToggle;\n                    }\n                }\n                else {\n                    const recursive = e.event.middleButton || e.event.shiftKey;\n                    if (recursive) {\n                        for (const r of foldingModel.getRegionsInside(region)) {\n                            if (r.isCollapsed === isCollapsed) {\n                                toToggle.push(r);\n                            }\n                        }\n                    }\n                    // when recursive, first only collapse all children. If all are already folded or there are no children, also fold parent.\n                    if (isCollapsed || !recursive || toToggle.length === 0) {\n                        toToggle.push(region);\n                    }\n                }\n                foldingModel.toggleCollapseState(toToggle);\n                this.reveal({ lineNumber, column: 1 });\n            }\n        }\n    }\n    reveal(position) {\n        this.editor.revealPositionInCenterIfOutsideViewport(position, 0 /* ScrollType.Smooth */);\n    }\n};\nFoldingController.ID = 'editor.contrib.folding';\nFoldingController = __decorate([\n    __param(1, IContextKeyService),\n    __param(2, ILanguageConfigurationService),\n    __param(3, INotificationService),\n    __param(4, ILanguageFeatureDebounceService),\n    __param(5, ILanguageFeaturesService)\n], FoldingController);\nexport class RangesLimitReporter {\n    constructor(editor) {\n        this.editor = editor;\n        this._onDidChange = new Emitter();\n        this._computed = 0;\n        this._limited = false;\n    }\n    get limit() {\n        return this.editor.getOptions().get(45 /* EditorOption.foldingMaximumRegions */);\n    }\n    update(computed, limited) {\n        if (computed !== this._computed || limited !== this._limited) {\n            this._computed = computed;\n            this._limited = limited;\n            this._onDidChange.fire();\n        }\n    }\n}\nclass FoldingAction extends EditorAction {\n    runEditorCommand(accessor, editor, args) {\n        const languageConfigurationService = accessor.get(ILanguageConfigurationService);\n        const foldingController = FoldingController.get(editor);\n        if (!foldingController) {\n            return;\n        }\n        const foldingModelPromise = foldingController.getFoldingModel();\n        if (foldingModelPromise) {\n            this.reportTelemetry(accessor, editor);\n            return foldingModelPromise.then(foldingModel => {\n                if (foldingModel) {\n                    this.invoke(foldingController, foldingModel, editor, args, languageConfigurationService);\n                    const selection = editor.getSelection();\n                    if (selection) {\n                        foldingController.reveal(selection.getStartPosition());\n                    }\n                }\n            });\n        }\n    }\n    getSelectedLines(editor) {\n        const selections = editor.getSelections();\n        return selections ? selections.map(s => s.startLineNumber) : [];\n    }\n    getLineNumbers(args, editor) {\n        if (args && args.selectionLines) {\n            return args.selectionLines.map(l => l + 1); // to 0-bases line numbers\n        }\n        return this.getSelectedLines(editor);\n    }\n    run(_accessor, _editor) {\n    }\n}\nfunction foldingArgumentsConstraint(args) {\n    if (!types.isUndefined(args)) {\n        if (!types.isObject(args)) {\n            return false;\n        }\n        const foldingArgs = args;\n        if (!types.isUndefined(foldingArgs.levels) && !types.isNumber(foldingArgs.levels)) {\n            return false;\n        }\n        if (!types.isUndefined(foldingArgs.direction) && !types.isString(foldingArgs.direction)) {\n            return false;\n        }\n        if (!types.isUndefined(foldingArgs.selectionLines) && (!Array.isArray(foldingArgs.selectionLines) || !foldingArgs.selectionLines.every(types.isNumber))) {\n            return false;\n        }\n    }\n    return true;\n}\nclass UnfoldAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.unfold',\n            label: nls.localize('unfoldAction.label', \"Unfold\"),\n            alias: 'Unfold',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 94 /* KeyCode.BracketRight */,\n                mac: {\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 94 /* KeyCode.BracketRight */\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            description: {\n                description: 'Unfold the content in the editor',\n                args: [\n                    {\n                        name: 'Unfold editor argument',\n                        description: `Property-value pairs that can be passed through this argument:\n\t\t\t\t\t\t* 'levels': Number of levels to unfold. If not set, defaults to 1.\n\t\t\t\t\t\t* 'direction': If 'up', unfold given number of levels up otherwise unfolds down.\n\t\t\t\t\t\t* 'selectionLines': Array of the start lines (0-based) of the editor selections to apply the unfold action to. If not set, the active selection(s) will be used.\n\t\t\t\t\t\t`,\n                        constraint: foldingArgumentsConstraint,\n                        schema: {\n                            'type': 'object',\n                            'properties': {\n                                'levels': {\n                                    'type': 'number',\n                                    'default': 1\n                                },\n                                'direction': {\n                                    'type': 'string',\n                                    'enum': ['up', 'down'],\n                                    'default': 'down'\n                                },\n                                'selectionLines': {\n                                    'type': 'array',\n                                    'items': {\n                                        'type': 'number'\n                                    }\n                                }\n                            }\n                        }\n                    }\n                ]\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor, args) {\n        const levels = args && args.levels || 1;\n        const lineNumbers = this.getLineNumbers(args, editor);\n        if (args && args.direction === 'up') {\n            setCollapseStateLevelsUp(foldingModel, false, levels, lineNumbers);\n        }\n        else {\n            setCollapseStateLevelsDown(foldingModel, false, levels, lineNumbers);\n        }\n    }\n}\nclass UnFoldRecursivelyAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.unfoldRecursively',\n            label: nls.localize('unFoldRecursivelyAction.label', \"Unfold Recursively\"),\n            alias: 'Unfold Recursively',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 94 /* KeyCode.BracketRight */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor, _args) {\n        setCollapseStateLevelsDown(foldingModel, false, Number.MAX_VALUE, this.getSelectedLines(editor));\n    }\n}\nclass FoldAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.fold',\n            label: nls.localize('foldAction.label', \"Fold\"),\n            alias: 'Fold',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 92 /* KeyCode.BracketLeft */,\n                mac: {\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 92 /* KeyCode.BracketLeft */\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            description: {\n                description: 'Fold the content in the editor',\n                args: [\n                    {\n                        name: 'Fold editor argument',\n                        description: `Property-value pairs that can be passed through this argument:\n\t\t\t\t\t\t\t* 'levels': Number of levels to fold.\n\t\t\t\t\t\t\t* 'direction': If 'up', folds given number of levels up otherwise folds down.\n\t\t\t\t\t\t\t* 'selectionLines': Array of the start lines (0-based) of the editor selections to apply the fold action to. If not set, the active selection(s) will be used.\n\t\t\t\t\t\t\tIf no levels or direction is set, folds the region at the locations or if already collapsed, the first uncollapsed parent instead.\n\t\t\t\t\t\t`,\n                        constraint: foldingArgumentsConstraint,\n                        schema: {\n                            'type': 'object',\n                            'properties': {\n                                'levels': {\n                                    'type': 'number',\n                                },\n                                'direction': {\n                                    'type': 'string',\n                                    'enum': ['up', 'down'],\n                                },\n                                'selectionLines': {\n                                    'type': 'array',\n                                    'items': {\n                                        'type': 'number'\n                                    }\n                                }\n                            }\n                        }\n                    }\n                ]\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor, args) {\n        const lineNumbers = this.getLineNumbers(args, editor);\n        const levels = args && args.levels;\n        const direction = args && args.direction;\n        if (typeof levels !== 'number' && typeof direction !== 'string') {\n            // fold the region at the location or if already collapsed, the first uncollapsed parent instead.\n            setCollapseStateUp(foldingModel, true, lineNumbers);\n        }\n        else {\n            if (direction === 'up') {\n                setCollapseStateLevelsUp(foldingModel, true, levels || 1, lineNumbers);\n            }\n            else {\n                setCollapseStateLevelsDown(foldingModel, true, levels || 1, lineNumbers);\n            }\n        }\n    }\n}\nclass ToggleFoldAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.toggleFold',\n            label: nls.localize('toggleFoldAction.label', \"Toggle Fold\"),\n            alias: 'Toggle Fold',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 42 /* KeyCode.KeyL */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        toggleCollapseState(foldingModel, 1, selectedLines);\n    }\n}\nclass FoldRecursivelyAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.foldRecursively',\n            label: nls.localize('foldRecursivelyAction.label', \"Fold Recursively\"),\n            alias: 'Fold Recursively',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 92 /* KeyCode.BracketLeft */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        setCollapseStateLevelsDown(foldingModel, true, Number.MAX_VALUE, selectedLines);\n    }\n}\nclass FoldAllBlockCommentsAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.foldAllBlockComments',\n            label: nls.localize('foldAllBlockComments.label', \"Fold All Block Comments\"),\n            alias: 'Fold All Block Comments',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 90 /* KeyCode.Slash */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor, args, languageConfigurationService) {\n        if (foldingModel.regions.hasTypes()) {\n            setCollapseStateForType(foldingModel, FoldingRangeKind.Comment.value, true);\n        }\n        else {\n            const editorModel = editor.getModel();\n            if (!editorModel) {\n                return;\n            }\n            const comments = languageConfigurationService.getLanguageConfiguration(editorModel.getLanguageId()).comments;\n            if (comments && comments.blockCommentStartToken) {\n                const regExp = new RegExp('^\\\\s*' + escapeRegExpCharacters(comments.blockCommentStartToken));\n                setCollapseStateForMatchingLines(foldingModel, regExp, true);\n            }\n        }\n    }\n}\nclass FoldAllRegionsAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.foldAllMarkerRegions',\n            label: nls.localize('foldAllMarkerRegions.label', \"Fold All Regions\"),\n            alias: 'Fold All Regions',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 29 /* KeyCode.Digit8 */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor, args, languageConfigurationService) {\n        if (foldingModel.regions.hasTypes()) {\n            setCollapseStateForType(foldingModel, FoldingRangeKind.Region.value, true);\n        }\n        else {\n            const editorModel = editor.getModel();\n            if (!editorModel) {\n                return;\n            }\n            const foldingRules = languageConfigurationService.getLanguageConfiguration(editorModel.getLanguageId()).foldingRules;\n            if (foldingRules && foldingRules.markers && foldingRules.markers.start) {\n                const regExp = new RegExp(foldingRules.markers.start);\n                setCollapseStateForMatchingLines(foldingModel, regExp, true);\n            }\n        }\n    }\n}\nclass UnfoldAllRegionsAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.unfoldAllMarkerRegions',\n            label: nls.localize('unfoldAllMarkerRegions.label', \"Unfold All Regions\"),\n            alias: 'Unfold All Regions',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 30 /* KeyCode.Digit9 */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor, args, languageConfigurationService) {\n        if (foldingModel.regions.hasTypes()) {\n            setCollapseStateForType(foldingModel, FoldingRangeKind.Region.value, false);\n        }\n        else {\n            const editorModel = editor.getModel();\n            if (!editorModel) {\n                return;\n            }\n            const foldingRules = languageConfigurationService.getLanguageConfiguration(editorModel.getLanguageId()).foldingRules;\n            if (foldingRules && foldingRules.markers && foldingRules.markers.start) {\n                const regExp = new RegExp(foldingRules.markers.start);\n                setCollapseStateForMatchingLines(foldingModel, regExp, false);\n            }\n        }\n    }\n}\nclass FoldAllRegionsExceptAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.foldAllExcept',\n            label: nls.localize('foldAllExcept.label', \"Fold All Regions Except Selected\"),\n            alias: 'Fold All Regions Except Selected',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 88 /* KeyCode.Minus */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        setCollapseStateForRest(foldingModel, true, selectedLines);\n    }\n}\nclass UnfoldAllRegionsExceptAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.unfoldAllExcept',\n            label: nls.localize('unfoldAllExcept.label', \"Unfold All Regions Except Selected\"),\n            alias: 'Unfold All Regions Except Selected',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 86 /* KeyCode.Equal */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        setCollapseStateForRest(foldingModel, false, selectedLines);\n    }\n}\nclass FoldAllAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.foldAll',\n            label: nls.localize('foldAllAction.label', \"Fold All\"),\n            alias: 'Fold All',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 21 /* KeyCode.Digit0 */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, _editor) {\n        setCollapseStateLevelsDown(foldingModel, true);\n    }\n}\nclass UnfoldAllAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.unfoldAll',\n            label: nls.localize('unfoldAllAction.label', \"Unfold All\"),\n            alias: 'Unfold All',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 40 /* KeyCode.KeyJ */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, _editor) {\n        setCollapseStateLevelsDown(foldingModel, false);\n    }\n}\nclass FoldLevelAction extends FoldingAction {\n    getFoldingLevel() {\n        return parseInt(this.id.substr(FoldLevelAction.ID_PREFIX.length));\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        setCollapseStateAtLevel(foldingModel, this.getFoldingLevel(), true, this.getSelectedLines(editor));\n    }\n}\nFoldLevelAction.ID_PREFIX = 'editor.foldLevel';\nFoldLevelAction.ID = (level) => FoldLevelAction.ID_PREFIX + level;\n/** Action to go to the parent fold of current line */\nclass GotoParentFoldAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.gotoParentFold',\n            label: nls.localize('gotoParentFold.label', \"Go to Parent Fold\"),\n            alias: 'Go to Parent Fold',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        if (selectedLines.length > 0) {\n            const startLineNumber = getParentFoldLine(selectedLines[0], foldingModel);\n            if (startLineNumber !== null) {\n                editor.setSelection({\n                    startLineNumber: startLineNumber,\n                    startColumn: 1,\n                    endLineNumber: startLineNumber,\n                    endColumn: 1\n                });\n            }\n        }\n    }\n}\n/** Action to go to the previous fold of current line */\nclass GotoPreviousFoldAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.gotoPreviousFold',\n            label: nls.localize('gotoPreviousFold.label', \"Go to Previous Folding Range\"),\n            alias: 'Go to Previous Folding Range',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        if (selectedLines.length > 0) {\n            const startLineNumber = getPreviousFoldLine(selectedLines[0], foldingModel);\n            if (startLineNumber !== null) {\n                editor.setSelection({\n                    startLineNumber: startLineNumber,\n                    startColumn: 1,\n                    endLineNumber: startLineNumber,\n                    endColumn: 1\n                });\n            }\n        }\n    }\n}\n/** Action to go to the next fold of current line */\nclass GotoNextFoldAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.gotoNextFold',\n            label: nls.localize('gotoNextFold.label', \"Go to Next Folding Range\"),\n            alias: 'Go to Next Folding Range',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        if (selectedLines.length > 0) {\n            const startLineNumber = getNextFoldLine(selectedLines[0], foldingModel);\n            if (startLineNumber !== null) {\n                editor.setSelection({\n                    startLineNumber: startLineNumber,\n                    startColumn: 1,\n                    endLineNumber: startLineNumber,\n                    endColumn: 1\n                });\n            }\n        }\n    }\n}\nclass FoldRangeFromSelectionAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.createFoldingRangeFromSelection',\n            label: nls.localize('createManualFoldRange.label', \"Create Folding Range from Selection\"),\n            alias: 'Create Folding Range from Selection',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 87 /* KeyCode.Comma */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        var _a;\n        const collapseRanges = [];\n        const selections = editor.getSelections();\n        if (selections) {\n            for (const selection of selections) {\n                let endLineNumber = selection.endLineNumber;\n                if (selection.endColumn === 1) {\n                    --endLineNumber;\n                }\n                if (endLineNumber > selection.startLineNumber) {\n                    collapseRanges.push({\n                        startLineNumber: selection.startLineNumber,\n                        endLineNumber: endLineNumber,\n                        type: undefined,\n                        isCollapsed: true,\n                        source: 1 /* FoldSource.userDefined */\n                    });\n                    editor.setSelection({\n                        startLineNumber: selection.startLineNumber,\n                        startColumn: 1,\n                        endLineNumber: selection.startLineNumber,\n                        endColumn: 1\n                    });\n                }\n            }\n            if (collapseRanges.length > 0) {\n                collapseRanges.sort((a, b) => {\n                    return a.startLineNumber - b.startLineNumber;\n                });\n                const newRanges = FoldingRegions.sanitizeAndMerge(foldingModel.regions, collapseRanges, (_a = editor.getModel()) === null || _a === void 0 ? void 0 : _a.getLineCount());\n                foldingModel.updatePost(FoldingRegions.fromFoldRanges(newRanges));\n            }\n        }\n    }\n}\nclass RemoveFoldRangeFromSelectionAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.removeManualFoldingRanges',\n            label: nls.localize('removeManualFoldingRanges.label', \"Remove Manual Folding Ranges\"),\n            alias: 'Remove Manual Folding Ranges',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 89 /* KeyCode.Period */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(foldingController, foldingModel, editor) {\n        const selections = editor.getSelections();\n        if (selections) {\n            const ranges = [];\n            for (const selection of selections) {\n                const { startLineNumber, endLineNumber } = selection;\n                ranges.push(endLineNumber >= startLineNumber ? { startLineNumber, endLineNumber } : { endLineNumber, startLineNumber });\n            }\n            foldingModel.removeManualRanges(ranges);\n            foldingController.triggerFoldingModelChanged();\n        }\n    }\n}\nregisterEditorContribution(FoldingController.ID, FoldingController, 0 /* EditorContributionInstantiation.Eager */); // eager because it uses `saveViewState`/`restoreViewState`\nregisterEditorAction(UnfoldAction);\nregisterEditorAction(UnFoldRecursivelyAction);\nregisterEditorAction(FoldAction);\nregisterEditorAction(FoldRecursivelyAction);\nregisterEditorAction(FoldAllAction);\nregisterEditorAction(UnfoldAllAction);\nregisterEditorAction(FoldAllBlockCommentsAction);\nregisterEditorAction(FoldAllRegionsAction);\nregisterEditorAction(UnfoldAllRegionsAction);\nregisterEditorAction(FoldAllRegionsExceptAction);\nregisterEditorAction(UnfoldAllRegionsExceptAction);\nregisterEditorAction(ToggleFoldAction);\nregisterEditorAction(GotoParentFoldAction);\nregisterEditorAction(GotoPreviousFoldAction);\nregisterEditorAction(GotoNextFoldAction);\nregisterEditorAction(FoldRangeFromSelectionAction);\nregisterEditorAction(RemoveFoldRangeFromSelectionAction);\nfor (let i = 1; i <= 7; i++) {\n    registerInstantiatedEditorAction(new FoldLevelAction({\n        id: FoldLevelAction.ID(i),\n        label: nls.localize('foldLevelAction.label', \"Fold Level {0}\", i),\n        alias: `Fold Level ${i}`,\n        precondition: CONTEXT_FOLDING_ENABLED,\n        kbOpts: {\n            kbExpr: EditorContextKeys.editorTextFocus,\n            primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | (21 /* KeyCode.Digit0 */ + i)),\n            weight: 100 /* KeybindingWeight.EditorContrib */\n        }\n    }));\n}\nCommandsRegistry.registerCommand('_executeFoldingRangeProvider', function (accessor, ...args) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const [resource] = args;\n        if (!(resource instanceof URI)) {\n            throw illegalArgument();\n        }\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const model = accessor.get(IModelService).getModel(resource);\n        if (!model) {\n            throw illegalArgument();\n        }\n        const configurationService = accessor.get(IConfigurationService);\n        if (!configurationService.getValue('editor.folding', { resource })) {\n            return [];\n        }\n        const languageConfigurationService = accessor.get(ILanguageConfigurationService);\n        const strategy = configurationService.getValue('editor.foldingStrategy', { resource });\n        const foldingLimitReporter = {\n            get limit() {\n                return configurationService.getValue('editor.foldingMaximumRegions', { resource });\n            },\n            update: (computed, limited) => { }\n        };\n        const indentRangeProvider = new IndentRangeProvider(model, languageConfigurationService, foldingLimitReporter);\n        let rangeProvider = indentRangeProvider;\n        if (strategy !== 'indentation') {\n            const providers = FoldingController.getFoldingRangeProviders(languageFeaturesService, model);\n            if (providers.length) {\n                rangeProvider = new SyntaxRangeProvider(model, providers, () => { }, foldingLimitReporter, indentRangeProvider);\n            }\n        }\n        const ranges = yield rangeProvider.compute(CancellationToken.None);\n        const result = [];\n        try {\n            if (ranges) {\n                for (let i = 0; i < ranges.length; i++) {\n                    const type = ranges.getType(i);\n                    result.push({ start: ranges.getStartLineNumber(i), end: ranges.getEndLineNumber(i), kind: type ? FoldingRangeKind.fromValue(type) : undefined });\n                }\n            }\n            return result;\n        }\n        finally {\n            rangeProvider.dispose();\n        }\n    });\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport const foldSourceAbbr = {\n    [0 /* FoldSource.provider */]: ' ',\n    [1 /* FoldSource.userDefined */]: 'u',\n    [2 /* FoldSource.recovered */]: 'r',\n};\nexport const MAX_FOLDING_REGIONS = 0xFFFF;\nexport const MAX_LINE_NUMBER = 0xFFFFFF;\nconst MASK_INDENT = 0xFF000000;\nclass BitField {\n    constructor(size) {\n        const numWords = Math.ceil(size / 32);\n        this._states = new Uint32Array(numWords);\n    }\n    get(index) {\n        const arrayIndex = (index / 32) | 0;\n        const bit = index % 32;\n        return (this._states[arrayIndex] & (1 << bit)) !== 0;\n    }\n    set(index, newState) {\n        const arrayIndex = (index / 32) | 0;\n        const bit = index % 32;\n        const value = this._states[arrayIndex];\n        if (newState) {\n            this._states[arrayIndex] = value | (1 << bit);\n        }\n        else {\n            this._states[arrayIndex] = value & ~(1 << bit);\n        }\n    }\n}\nexport class FoldingRegions {\n    constructor(startIndexes, endIndexes, types) {\n        if (startIndexes.length !== endIndexes.length || startIndexes.length > MAX_FOLDING_REGIONS) {\n            throw new Error('invalid startIndexes or endIndexes size');\n        }\n        this._startIndexes = startIndexes;\n        this._endIndexes = endIndexes;\n        this._collapseStates = new BitField(startIndexes.length);\n        this._userDefinedStates = new BitField(startIndexes.length);\n        this._recoveredStates = new BitField(startIndexes.length);\n        this._types = types;\n        this._parentsComputed = false;\n    }\n    ensureParentIndices() {\n        if (!this._parentsComputed) {\n            this._parentsComputed = true;\n            const parentIndexes = [];\n            const isInsideLast = (startLineNumber, endLineNumber) => {\n                const index = parentIndexes[parentIndexes.length - 1];\n                return this.getStartLineNumber(index) <= startLineNumber && this.getEndLineNumber(index) >= endLineNumber;\n            };\n            for (let i = 0, len = this._startIndexes.length; i < len; i++) {\n                const startLineNumber = this._startIndexes[i];\n                const endLineNumber = this._endIndexes[i];\n                if (startLineNumber > MAX_LINE_NUMBER || endLineNumber > MAX_LINE_NUMBER) {\n                    throw new Error('startLineNumber or endLineNumber must not exceed ' + MAX_LINE_NUMBER);\n                }\n                while (parentIndexes.length > 0 && !isInsideLast(startLineNumber, endLineNumber)) {\n                    parentIndexes.pop();\n                }\n                const parentIndex = parentIndexes.length > 0 ? parentIndexes[parentIndexes.length - 1] : -1;\n                parentIndexes.push(i);\n                this._startIndexes[i] = startLineNumber + ((parentIndex & 0xFF) << 24);\n                this._endIndexes[i] = endLineNumber + ((parentIndex & 0xFF00) << 16);\n            }\n        }\n    }\n    get length() {\n        return this._startIndexes.length;\n    }\n    getStartLineNumber(index) {\n        return this._startIndexes[index] & MAX_LINE_NUMBER;\n    }\n    getEndLineNumber(index) {\n        return this._endIndexes[index] & MAX_LINE_NUMBER;\n    }\n    getType(index) {\n        return this._types ? this._types[index] : undefined;\n    }\n    hasTypes() {\n        return !!this._types;\n    }\n    isCollapsed(index) {\n        return this._collapseStates.get(index);\n    }\n    setCollapsed(index, newState) {\n        this._collapseStates.set(index, newState);\n    }\n    isUserDefined(index) {\n        return this._userDefinedStates.get(index);\n    }\n    setUserDefined(index, newState) {\n        return this._userDefinedStates.set(index, newState);\n    }\n    isRecovered(index) {\n        return this._recoveredStates.get(index);\n    }\n    setRecovered(index, newState) {\n        return this._recoveredStates.set(index, newState);\n    }\n    getSource(index) {\n        if (this.isUserDefined(index)) {\n            return 1 /* FoldSource.userDefined */;\n        }\n        else if (this.isRecovered(index)) {\n            return 2 /* FoldSource.recovered */;\n        }\n        return 0 /* FoldSource.provider */;\n    }\n    setSource(index, source) {\n        if (source === 1 /* FoldSource.userDefined */) {\n            this.setUserDefined(index, true);\n            this.setRecovered(index, false);\n        }\n        else if (source === 2 /* FoldSource.recovered */) {\n            this.setUserDefined(index, false);\n            this.setRecovered(index, true);\n        }\n        else {\n            this.setUserDefined(index, false);\n            this.setRecovered(index, false);\n        }\n    }\n    setCollapsedAllOfType(type, newState) {\n        let hasChanged = false;\n        if (this._types) {\n            for (let i = 0; i < this._types.length; i++) {\n                if (this._types[i] === type) {\n                    this.setCollapsed(i, newState);\n                    hasChanged = true;\n                }\n            }\n        }\n        return hasChanged;\n    }\n    toRegion(index) {\n        return new FoldingRegion(this, index);\n    }\n    getParentIndex(index) {\n        this.ensureParentIndices();\n        const parent = ((this._startIndexes[index] & MASK_INDENT) >>> 24) + ((this._endIndexes[index] & MASK_INDENT) >>> 16);\n        if (parent === MAX_FOLDING_REGIONS) {\n            return -1;\n        }\n        return parent;\n    }\n    contains(index, line) {\n        return this.getStartLineNumber(index) <= line && this.getEndLineNumber(index) >= line;\n    }\n    findIndex(line) {\n        let low = 0, high = this._startIndexes.length;\n        if (high === 0) {\n            return -1; // no children\n        }\n        while (low < high) {\n            const mid = Math.floor((low + high) / 2);\n            if (line < this.getStartLineNumber(mid)) {\n                high = mid;\n            }\n            else {\n                low = mid + 1;\n            }\n        }\n        return low - 1;\n    }\n    findRange(line) {\n        let index = this.findIndex(line);\n        if (index >= 0) {\n            const endLineNumber = this.getEndLineNumber(index);\n            if (endLineNumber >= line) {\n                return index;\n            }\n            index = this.getParentIndex(index);\n            while (index !== -1) {\n                if (this.contains(index, line)) {\n                    return index;\n                }\n                index = this.getParentIndex(index);\n            }\n        }\n        return -1;\n    }\n    toString() {\n        const res = [];\n        for (let i = 0; i < this.length; i++) {\n            res[i] = `[${foldSourceAbbr[this.getSource(i)]}${this.isCollapsed(i) ? '+' : '-'}] ${this.getStartLineNumber(i)}/${this.getEndLineNumber(i)}`;\n        }\n        return res.join(', ');\n    }\n    toFoldRange(index) {\n        return {\n            startLineNumber: this._startIndexes[index] & MAX_LINE_NUMBER,\n            endLineNumber: this._endIndexes[index] & MAX_LINE_NUMBER,\n            type: this._types ? this._types[index] : undefined,\n            isCollapsed: this.isCollapsed(index),\n            source: this.getSource(index)\n        };\n    }\n    static fromFoldRanges(ranges) {\n        const rangesLength = ranges.length;\n        const startIndexes = new Uint32Array(rangesLength);\n        const endIndexes = new Uint32Array(rangesLength);\n        let types = [];\n        let gotTypes = false;\n        for (let i = 0; i < rangesLength; i++) {\n            const range = ranges[i];\n            startIndexes[i] = range.startLineNumber;\n            endIndexes[i] = range.endLineNumber;\n            types.push(range.type);\n            if (range.type) {\n                gotTypes = true;\n            }\n        }\n        if (!gotTypes) {\n            types = undefined;\n        }\n        const regions = new FoldingRegions(startIndexes, endIndexes, types);\n        for (let i = 0; i < rangesLength; i++) {\n            if (ranges[i].isCollapsed) {\n                regions.setCollapsed(i, true);\n            }\n            regions.setSource(i, ranges[i].source);\n        }\n        return regions;\n    }\n    /**\n     * Two inputs, each a FoldingRegions or a FoldRange[], are merged.\n     * Each input must be pre-sorted on startLineNumber.\n     * The first list is assumed to always include all regions currently defined by range providers.\n     * The second list only contains the previously collapsed and all manual ranges.\n     * If the line position matches, the range of the new range is taken, and the range is no longer manual\n     * When an entry in one list overlaps an entry in the other, the second list's entry \"wins\" and\n     * overlapping entries in the first list are discarded.\n     * Invalid entries are discarded. An entry is invalid if:\n     * \t\tthe start and end line numbers aren't a valid range of line numbers,\n     * \t\tit is out of sequence or has the same start line as a preceding entry,\n     * \t\tit overlaps a preceding entry and is not fully contained by that entry.\n     */\n    static sanitizeAndMerge(rangesA, rangesB, maxLineNumber) {\n        maxLineNumber = maxLineNumber !== null && maxLineNumber !== void 0 ? maxLineNumber : Number.MAX_VALUE;\n        const getIndexedFunction = (r, limit) => {\n            return Array.isArray(r)\n                ? ((i) => { return (i < limit) ? r[i] : undefined; })\n                : ((i) => { return (i < limit) ? r.toFoldRange(i) : undefined; });\n        };\n        const getA = getIndexedFunction(rangesA, rangesA.length);\n        const getB = getIndexedFunction(rangesB, rangesB.length);\n        let indexA = 0;\n        let indexB = 0;\n        let nextA = getA(0);\n        let nextB = getB(0);\n        const stackedRanges = [];\n        let topStackedRange;\n        let prevLineNumber = 0;\n        const resultRanges = [];\n        while (nextA || nextB) {\n            let useRange = undefined;\n            if (nextB && (!nextA || nextA.startLineNumber >= nextB.startLineNumber)) {\n                if (nextA && nextA.startLineNumber === nextB.startLineNumber) {\n                    if (nextB.source === 1 /* FoldSource.userDefined */) {\n                        // a user defined range (possibly unfolded)\n                        useRange = nextB;\n                    }\n                    else {\n                        // a previously folded range or a (possibly unfolded) recovered range\n                        useRange = nextA;\n                        useRange.isCollapsed = nextB.isCollapsed && nextA.endLineNumber === nextB.endLineNumber;\n                        useRange.source = 0 /* FoldSource.provider */;\n                    }\n                    nextA = getA(++indexA); // not necessary, just for speed\n                }\n                else {\n                    useRange = nextB;\n                    if (nextB.isCollapsed && nextB.source === 0 /* FoldSource.provider */) {\n                        // a previously collapsed range\n                        useRange.source = 2 /* FoldSource.recovered */;\n                    }\n                }\n                nextB = getB(++indexB);\n            }\n            else {\n                // nextA is next. The user folded B set takes precedence and we sometimes need to look\n                // ahead in it to check for an upcoming conflict.\n                let scanIndex = indexB;\n                let prescanB = nextB;\n                while (true) {\n                    if (!prescanB || prescanB.startLineNumber > nextA.endLineNumber) {\n                        useRange = nextA;\n                        break; // no conflict, use this nextA\n                    }\n                    if (prescanB.source === 1 /* FoldSource.userDefined */ && prescanB.endLineNumber > nextA.endLineNumber) {\n                        // we found a user folded range, it wins\n                        break; // without setting nextResult, so this nextA gets skipped\n                    }\n                    prescanB = getB(++scanIndex);\n                }\n                nextA = getA(++indexA);\n            }\n            if (useRange) {\n                while (topStackedRange\n                    && topStackedRange.endLineNumber < useRange.startLineNumber) {\n                    topStackedRange = stackedRanges.pop();\n                }\n                if (useRange.endLineNumber > useRange.startLineNumber\n                    && useRange.startLineNumber > prevLineNumber\n                    && useRange.endLineNumber <= maxLineNumber\n                    && (!topStackedRange\n                        || topStackedRange.endLineNumber >= useRange.endLineNumber)) {\n                    resultRanges.push(useRange);\n                    prevLineNumber = useRange.startLineNumber;\n                    if (topStackedRange) {\n                        stackedRanges.push(topStackedRange);\n                    }\n                    topStackedRange = useRange;\n                }\n            }\n        }\n        return resultRanges;\n    }\n}\nexport class FoldingRegion {\n    constructor(ranges, index) {\n        this.ranges = ranges;\n        this.index = index;\n    }\n    get startLineNumber() {\n        return this.ranges.getStartLineNumber(this.index);\n    }\n    get endLineNumber() {\n        return this.ranges.getEndLineNumber(this.index);\n    }\n    get regionIndex() {\n        return this.index;\n    }\n    get parentIndex() {\n        return this.ranges.getParentIndex(this.index);\n    }\n    get isCollapsed() {\n        return this.ranges.isCollapsed(this.index);\n    }\n    containedBy(range) {\n        return range.startLineNumber <= this.startLineNumber && range.endLineNumber >= this.endLineNumber;\n    }\n    containsLine(lineNumber) {\n        return this.startLineNumber <= lineNumber && lineNumber <= this.endLineNumber;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { computeIndentLevel } from '../../../common/model/utils.js';\nimport { FoldingRegions, MAX_LINE_NUMBER } from './foldingRanges.js';\nconst MAX_FOLDING_REGIONS_FOR_INDENT_DEFAULT = 5000;\nconst ID_INDENT_PROVIDER = 'indent';\nexport class IndentRangeProvider {\n    constructor(editorModel, languageConfigurationService, foldingRangesLimit) {\n        this.editorModel = editorModel;\n        this.languageConfigurationService = languageConfigurationService;\n        this.foldingRangesLimit = foldingRangesLimit;\n        this.id = ID_INDENT_PROVIDER;\n    }\n    dispose() { }\n    compute(cancelationToken) {\n        const foldingRules = this.languageConfigurationService.getLanguageConfiguration(this.editorModel.getLanguageId()).foldingRules;\n        const offSide = foldingRules && !!foldingRules.offSide;\n        const markers = foldingRules && foldingRules.markers;\n        return Promise.resolve(computeRanges(this.editorModel, offSide, markers, this.foldingRangesLimit));\n    }\n}\n// public only for testing\nexport class RangesCollector {\n    constructor(foldingRangesLimit) {\n        this._startIndexes = [];\n        this._endIndexes = [];\n        this._indentOccurrences = [];\n        this._length = 0;\n        this._foldingRangesLimit = foldingRangesLimit;\n    }\n    insertFirst(startLineNumber, endLineNumber, indent) {\n        if (startLineNumber > MAX_LINE_NUMBER || endLineNumber > MAX_LINE_NUMBER) {\n            return;\n        }\n        const index = this._length;\n        this._startIndexes[index] = startLineNumber;\n        this._endIndexes[index] = endLineNumber;\n        this._length++;\n        if (indent < 1000) {\n            this._indentOccurrences[indent] = (this._indentOccurrences[indent] || 0) + 1;\n        }\n    }\n    toIndentRanges(model) {\n        const limit = this._foldingRangesLimit.limit;\n        if (this._length <= limit) {\n            this._foldingRangesLimit.update(this._length, false);\n            // reverse and create arrays of the exact length\n            const startIndexes = new Uint32Array(this._length);\n            const endIndexes = new Uint32Array(this._length);\n            for (let i = this._length - 1, k = 0; i >= 0; i--, k++) {\n                startIndexes[k] = this._startIndexes[i];\n                endIndexes[k] = this._endIndexes[i];\n            }\n            return new FoldingRegions(startIndexes, endIndexes);\n        }\n        else {\n            this._foldingRangesLimit.update(this._length, limit);\n            let entries = 0;\n            let maxIndent = this._indentOccurrences.length;\n            for (let i = 0; i < this._indentOccurrences.length; i++) {\n                const n = this._indentOccurrences[i];\n                if (n) {\n                    if (n + entries > limit) {\n                        maxIndent = i;\n                        break;\n                    }\n                    entries += n;\n                }\n            }\n            const tabSize = model.getOptions().tabSize;\n            // reverse and create arrays of the exact length\n            const startIndexes = new Uint32Array(limit);\n            const endIndexes = new Uint32Array(limit);\n            for (let i = this._length - 1, k = 0; i >= 0; i--) {\n                const startIndex = this._startIndexes[i];\n                const lineContent = model.getLineContent(startIndex);\n                const indent = computeIndentLevel(lineContent, tabSize);\n                if (indent < maxIndent || (indent === maxIndent && entries++ < limit)) {\n                    startIndexes[k] = startIndex;\n                    endIndexes[k] = this._endIndexes[i];\n                    k++;\n                }\n            }\n            return new FoldingRegions(startIndexes, endIndexes);\n        }\n    }\n}\nconst foldingRangesLimitDefault = {\n    limit: MAX_FOLDING_REGIONS_FOR_INDENT_DEFAULT,\n    update: () => { }\n};\nexport function computeRanges(model, offSide, markers, foldingRangesLimit = foldingRangesLimitDefault) {\n    const tabSize = model.getOptions().tabSize;\n    const result = new RangesCollector(foldingRangesLimit);\n    let pattern = undefined;\n    if (markers) {\n        pattern = new RegExp(`(${markers.start.source})|(?:${markers.end.source})`);\n    }\n    const previousRegions = [];\n    const line = model.getLineCount() + 1;\n    previousRegions.push({ indent: -1, endAbove: line, line }); // sentinel, to make sure there's at least one entry\n    for (let line = model.getLineCount(); line > 0; line--) {\n        const lineContent = model.getLineContent(line);\n        const indent = computeIndentLevel(lineContent, tabSize);\n        let previous = previousRegions[previousRegions.length - 1];\n        if (indent === -1) {\n            if (offSide) {\n                // for offSide languages, empty lines are associated to the previous block\n                // note: the next block is already written to the results, so this only\n                // impacts the end position of the block before\n                previous.endAbove = line;\n            }\n            continue; // only whitespace\n        }\n        let m;\n        if (pattern && (m = lineContent.match(pattern))) {\n            // folding pattern match\n            if (m[1]) { // start pattern match\n                // discard all regions until the folding pattern\n                let i = previousRegions.length - 1;\n                while (i > 0 && previousRegions[i].indent !== -2) {\n                    i--;\n                }\n                if (i > 0) {\n                    previousRegions.length = i + 1;\n                    previous = previousRegions[i];\n                    // new folding range from pattern, includes the end line\n                    result.insertFirst(line, previous.line, indent);\n                    previous.line = line;\n                    previous.indent = indent;\n                    previous.endAbove = line;\n                    continue;\n                }\n                else {\n                    // no end marker found, treat line as a regular line\n                }\n            }\n            else { // end pattern match\n                previousRegions.push({ indent: -2, endAbove: line, line });\n                continue;\n            }\n        }\n        if (previous.indent > indent) {\n            // discard all regions with larger indent\n            do {\n                previousRegions.pop();\n                previous = previousRegions[previousRegions.length - 1];\n            } while (previous.indent > indent);\n            // new folding range\n            const endLineNumber = previous.endAbove - 1;\n            if (endLineNumber - line >= 1) { // needs at east size 1\n                result.insertFirst(line, endLineNumber, indent);\n            }\n        }\n        if (previous.indent === indent) {\n            previous.endAbove = line;\n        }\n        else { // previous.indent < indent\n            // new region with a bigger indent\n            previousRegions.push({ indent, endAbove: line, line });\n        }\n    }\n    return result.toIndentRanges(model);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { FoldingRegions, MAX_LINE_NUMBER } from './foldingRanges.js';\nconst foldingContext = {};\nconst ID_SYNTAX_PROVIDER = 'syntax';\nexport class SyntaxRangeProvider {\n    constructor(editorModel, providers, handleFoldingRangesChange, foldingRangesLimit, fallbackRangeProvider // used when all providers return null\n    ) {\n        this.editorModel = editorModel;\n        this.providers = providers;\n        this.handleFoldingRangesChange = handleFoldingRangesChange;\n        this.foldingRangesLimit = foldingRangesLimit;\n        this.fallbackRangeProvider = fallbackRangeProvider;\n        this.id = ID_SYNTAX_PROVIDER;\n        this.disposables = new DisposableStore();\n        if (fallbackRangeProvider) {\n            this.disposables.add(fallbackRangeProvider);\n        }\n        for (const provider of providers) {\n            if (typeof provider.onDidChange === 'function') {\n                this.disposables.add(provider.onDidChange(handleFoldingRangesChange));\n            }\n        }\n    }\n    compute(cancellationToken) {\n        return collectSyntaxRanges(this.providers, this.editorModel, cancellationToken).then(ranges => {\n            var _a, _b;\n            if (ranges) {\n                const res = sanitizeRanges(ranges, this.foldingRangesLimit);\n                return res;\n            }\n            return (_b = (_a = this.fallbackRangeProvider) === null || _a === void 0 ? void 0 : _a.compute(cancellationToken)) !== null && _b !== void 0 ? _b : null;\n        });\n    }\n    dispose() {\n        this.disposables.dispose();\n    }\n}\nfunction collectSyntaxRanges(providers, model, cancellationToken) {\n    let rangeData = null;\n    const promises = providers.map((provider, i) => {\n        return Promise.resolve(provider.provideFoldingRanges(model, foldingContext, cancellationToken)).then(ranges => {\n            if (cancellationToken.isCancellationRequested) {\n                return;\n            }\n            if (Array.isArray(ranges)) {\n                if (!Array.isArray(rangeData)) {\n                    rangeData = [];\n                }\n                const nLines = model.getLineCount();\n                for (const r of ranges) {\n                    if (r.start > 0 && r.end > r.start && r.end <= nLines) {\n                        rangeData.push({ start: r.start, end: r.end, rank: i, kind: r.kind });\n                    }\n                }\n            }\n        }, onUnexpectedExternalError);\n    });\n    return Promise.all(promises).then(_ => {\n        return rangeData;\n    });\n}\nclass RangesCollector {\n    constructor(foldingRangesLimit) {\n        this._startIndexes = [];\n        this._endIndexes = [];\n        this._nestingLevels = [];\n        this._nestingLevelCounts = [];\n        this._types = [];\n        this._length = 0;\n        this._foldingRangesLimit = foldingRangesLimit;\n    }\n    add(startLineNumber, endLineNumber, type, nestingLevel) {\n        if (startLineNumber > MAX_LINE_NUMBER || endLineNumber > MAX_LINE_NUMBER) {\n            return;\n        }\n        const index = this._length;\n        this._startIndexes[index] = startLineNumber;\n        this._endIndexes[index] = endLineNumber;\n        this._nestingLevels[index] = nestingLevel;\n        this._types[index] = type;\n        this._length++;\n        if (nestingLevel < 30) {\n            this._nestingLevelCounts[nestingLevel] = (this._nestingLevelCounts[nestingLevel] || 0) + 1;\n        }\n    }\n    toIndentRanges() {\n        const limit = this._foldingRangesLimit.limit;\n        if (this._length <= limit) {\n            this._foldingRangesLimit.update(this._length, false);\n            const startIndexes = new Uint32Array(this._length);\n            const endIndexes = new Uint32Array(this._length);\n            for (let i = 0; i < this._length; i++) {\n                startIndexes[i] = this._startIndexes[i];\n                endIndexes[i] = this._endIndexes[i];\n            }\n            return new FoldingRegions(startIndexes, endIndexes, this._types);\n        }\n        else {\n            this._foldingRangesLimit.update(this._length, limit);\n            let entries = 0;\n            let maxLevel = this._nestingLevelCounts.length;\n            for (let i = 0; i < this._nestingLevelCounts.length; i++) {\n                const n = this._nestingLevelCounts[i];\n                if (n) {\n                    if (n + entries > limit) {\n                        maxLevel = i;\n                        break;\n                    }\n                    entries += n;\n                }\n            }\n            const startIndexes = new Uint32Array(limit);\n            const endIndexes = new Uint32Array(limit);\n            const types = [];\n            for (let i = 0, k = 0; i < this._length; i++) {\n                const level = this._nestingLevels[i];\n                if (level < maxLevel || (level === maxLevel && entries++ < limit)) {\n                    startIndexes[k] = this._startIndexes[i];\n                    endIndexes[k] = this._endIndexes[i];\n                    types[k] = this._types[i];\n                    k++;\n                }\n            }\n            return new FoldingRegions(startIndexes, endIndexes, types);\n        }\n    }\n}\nexport function sanitizeRanges(rangeData, foldingRangesLimit) {\n    const sorted = rangeData.sort((d1, d2) => {\n        let diff = d1.start - d2.start;\n        if (diff === 0) {\n            diff = d1.rank - d2.rank;\n        }\n        return diff;\n    });\n    const collector = new RangesCollector(foldingRangesLimit);\n    let top = undefined;\n    const previous = [];\n    for (const entry of sorted) {\n        if (!top) {\n            top = entry;\n            collector.add(entry.start, entry.end, entry.kind && entry.kind.value, previous.length);\n        }\n        else {\n            if (entry.start > top.start) {\n                if (entry.end <= top.end) {\n                    previous.push(top);\n                    top = entry;\n                    collector.add(entry.start, entry.end, entry.kind && entry.kind.value, previous.length);\n                }\n                else {\n                    if (entry.start > top.end) {\n                        do {\n                            top = previous.pop();\n                        } while (top && entry.start > top.end);\n                        if (top) {\n                            previous.push(top);\n                        }\n                        top = entry;\n                    }\n                    collector.add(entry.start, entry.end, entry.kind && entry.kind.value, previous.length);\n                }\n            }\n        }\n    }\n    return collector.toIndentRanges();\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditorAction, registerEditorAction } from '../../../browser/editorExtensions.js';\nimport { EditorZoom } from '../../../common/config/editorZoom.js';\nimport * as nls from '../../../../nls.js';\nclass EditorFontZoomIn extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.fontZoomIn',\n            label: nls.localize('EditorFontZoomIn.label', \"Editor Font Zoom In\"),\n            alias: 'Editor Font Zoom In',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        EditorZoom.setZoomLevel(EditorZoom.getZoomLevel() + 1);\n    }\n}\nclass EditorFontZoomOut extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.fontZoomOut',\n            label: nls.localize('EditorFontZoomOut.label', \"Editor Font Zoom Out\"),\n            alias: 'Editor Font Zoom Out',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        EditorZoom.setZoomLevel(EditorZoom.getZoomLevel() - 1);\n    }\n}\nclass EditorFontZoomReset extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.fontZoomReset',\n            label: nls.localize('EditorFontZoomReset.label', \"Editor Font Zoom Reset\"),\n            alias: 'Editor Font Zoom Reset',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        EditorZoom.setZoomLevel(0);\n    }\n}\nregisterEditorAction(EditorFontZoomIn);\nregisterEditorAction(EditorFontZoomOut);\nregisterEditorAction(EditorFontZoomReset);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { asArray, isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { Iterable } from '../../../../base/common/iterator.js';\nimport { LinkedList } from '../../../../base/common/linkedList.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { EditorStateCancellationTokenSource, TextModelCancellationTokenSource } from '../../editorState/browser/editorState.js';\nimport { isCodeEditor } from '../../../browser/editorBrowser.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { IEditorWorkerService } from '../../../common/services/editorWorker.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { FormattingEdit } from './formattingEdit.js';\nimport * as nls from '../../../../nls.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { ExtensionIdentifierSet } from '../../../../platform/extensions/common/extensions.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nexport function alertFormattingEdits(edits) {\n    edits = edits.filter(edit => edit.range);\n    if (!edits.length) {\n        return;\n    }\n    let { range } = edits[0];\n    for (let i = 1; i < edits.length; i++) {\n        range = Range.plusRange(range, edits[i].range);\n    }\n    const { startLineNumber, endLineNumber } = range;\n    if (startLineNumber === endLineNumber) {\n        if (edits.length === 1) {\n            alert(nls.localize('hint11', \"Made 1 formatting edit on line {0}\", startLineNumber));\n        }\n        else {\n            alert(nls.localize('hintn1', \"Made {0} formatting edits on line {1}\", edits.length, startLineNumber));\n        }\n    }\n    else {\n        if (edits.length === 1) {\n            alert(nls.localize('hint1n', \"Made 1 formatting edit between lines {0} and {1}\", startLineNumber, endLineNumber));\n        }\n        else {\n            alert(nls.localize('hintnn', \"Made {0} formatting edits between lines {1} and {2}\", edits.length, startLineNumber, endLineNumber));\n        }\n    }\n}\nexport function getRealAndSyntheticDocumentFormattersOrdered(documentFormattingEditProvider, documentRangeFormattingEditProvider, model) {\n    const result = [];\n    const seen = new ExtensionIdentifierSet();\n    // (1) add all document formatter\n    const docFormatter = documentFormattingEditProvider.ordered(model);\n    for (const formatter of docFormatter) {\n        result.push(formatter);\n        if (formatter.extensionId) {\n            seen.add(formatter.extensionId);\n        }\n    }\n    // (2) add all range formatter as document formatter (unless the same extension already did that)\n    const rangeFormatter = documentRangeFormattingEditProvider.ordered(model);\n    for (const formatter of rangeFormatter) {\n        if (formatter.extensionId) {\n            if (seen.has(formatter.extensionId)) {\n                continue;\n            }\n            seen.add(formatter.extensionId);\n        }\n        result.push({\n            displayName: formatter.displayName,\n            extensionId: formatter.extensionId,\n            provideDocumentFormattingEdits(model, options, token) {\n                return formatter.provideDocumentRangeFormattingEdits(model, model.getFullModelRange(), options, token);\n            }\n        });\n    }\n    return result;\n}\nexport class FormattingConflicts {\n    static setFormatterSelector(selector) {\n        const remove = FormattingConflicts._selectors.unshift(selector);\n        return { dispose: remove };\n    }\n    static select(formatter, document, mode) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (formatter.length === 0) {\n                return undefined;\n            }\n            const selector = Iterable.first(FormattingConflicts._selectors);\n            if (selector) {\n                return yield selector(formatter, document, mode);\n            }\n            return undefined;\n        });\n    }\n}\nFormattingConflicts._selectors = new LinkedList();\nexport function formatDocumentRangesWithSelectedProvider(accessor, editorOrModel, rangeOrRanges, mode, progress, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const instaService = accessor.get(IInstantiationService);\n        const { documentRangeFormattingEditProvider: documentRangeFormattingEditProviderRegistry } = accessor.get(ILanguageFeaturesService);\n        const model = isCodeEditor(editorOrModel) ? editorOrModel.getModel() : editorOrModel;\n        const provider = documentRangeFormattingEditProviderRegistry.ordered(model);\n        const selected = yield FormattingConflicts.select(provider, model, mode);\n        if (selected) {\n            progress.report(selected);\n            yield instaService.invokeFunction(formatDocumentRangesWithProvider, selected, editorOrModel, rangeOrRanges, token);\n        }\n    });\n}\nexport function formatDocumentRangesWithProvider(accessor, provider, editorOrModel, rangeOrRanges, token) {\n    var _a, _b;\n    return __awaiter(this, void 0, void 0, function* () {\n        const workerService = accessor.get(IEditorWorkerService);\n        const logService = accessor.get(ILogService);\n        let model;\n        let cts;\n        if (isCodeEditor(editorOrModel)) {\n            model = editorOrModel.getModel();\n            cts = new EditorStateCancellationTokenSource(editorOrModel, 1 /* CodeEditorStateFlag.Value */ | 4 /* CodeEditorStateFlag.Position */, undefined, token);\n        }\n        else {\n            model = editorOrModel;\n            cts = new TextModelCancellationTokenSource(editorOrModel, token);\n        }\n        // make sure that ranges don't overlap nor touch each other\n        const ranges = [];\n        let len = 0;\n        for (const range of asArray(rangeOrRanges).sort(Range.compareRangesUsingStarts)) {\n            if (len > 0 && Range.areIntersectingOrTouching(ranges[len - 1], range)) {\n                ranges[len - 1] = Range.fromPositions(ranges[len - 1].getStartPosition(), range.getEndPosition());\n            }\n            else {\n                len = ranges.push(range);\n            }\n        }\n        const computeEdits = (range) => __awaiter(this, void 0, void 0, function* () {\n            var _c, _d;\n            logService.trace(`[format][provideDocumentRangeFormattingEdits] (request)`, (_c = provider.extensionId) === null || _c === void 0 ? void 0 : _c.value, range);\n            const result = (yield provider.provideDocumentRangeFormattingEdits(model, range, model.getFormattingOptions(), cts.token)) || [];\n            logService.trace(`[format][provideDocumentRangeFormattingEdits] (response)`, (_d = provider.extensionId) === null || _d === void 0 ? void 0 : _d.value, result);\n            return result;\n        });\n        const hasIntersectingEdit = (a, b) => {\n            if (!a.length || !b.length) {\n                return false;\n            }\n            // quick exit if the list of ranges are completely unrelated [O(n)]\n            const mergedA = a.reduce((acc, val) => { return Range.plusRange(acc, val.range); }, a[0].range);\n            if (!b.some(x => { return Range.intersectRanges(mergedA, x.range); })) {\n                return false;\n            }\n            // fallback to a complete check [O(n^2)]\n            for (const edit of a) {\n                for (const otherEdit of b) {\n                    if (Range.intersectRanges(edit.range, otherEdit.range)) {\n                        return true;\n                    }\n                }\n            }\n            return false;\n        };\n        const allEdits = [];\n        const rawEditsList = [];\n        try {\n            if (typeof provider.provideDocumentRangesFormattingEdits === 'function') {\n                logService.trace(`[format][provideDocumentRangeFormattingEdits] (request)`, (_a = provider.extensionId) === null || _a === void 0 ? void 0 : _a.value, ranges);\n                const result = (yield provider.provideDocumentRangesFormattingEdits(model, ranges, model.getFormattingOptions(), cts.token)) || [];\n                logService.trace(`[format][provideDocumentRangeFormattingEdits] (response)`, (_b = provider.extensionId) === null || _b === void 0 ? void 0 : _b.value, result);\n                rawEditsList.push(result);\n            }\n            else {\n                for (const range of ranges) {\n                    if (cts.token.isCancellationRequested) {\n                        return true;\n                    }\n                    rawEditsList.push(yield computeEdits(range));\n                }\n                for (let i = 0; i < ranges.length; ++i) {\n                    for (let j = i + 1; j < ranges.length; ++j) {\n                        if (cts.token.isCancellationRequested) {\n                            return true;\n                        }\n                        if (hasIntersectingEdit(rawEditsList[i], rawEditsList[j])) {\n                            // Merge ranges i and j into a single range, recompute the associated edits\n                            const mergedRange = Range.plusRange(ranges[i], ranges[j]);\n                            const edits = yield computeEdits(mergedRange);\n                            ranges.splice(j, 1);\n                            ranges.splice(i, 1);\n                            ranges.push(mergedRange);\n                            rawEditsList.splice(j, 1);\n                            rawEditsList.splice(i, 1);\n                            rawEditsList.push(edits);\n                            // Restart scanning\n                            i = 0;\n                            j = 0;\n                        }\n                    }\n                }\n            }\n            for (const rawEdits of rawEditsList) {\n                if (cts.token.isCancellationRequested) {\n                    return true;\n                }\n                const minimalEdits = yield workerService.computeMoreMinimalEdits(model.uri, rawEdits);\n                if (minimalEdits) {\n                    allEdits.push(...minimalEdits);\n                }\n            }\n        }\n        finally {\n            cts.dispose();\n        }\n        if (allEdits.length === 0) {\n            return false;\n        }\n        if (isCodeEditor(editorOrModel)) {\n            // use editor to apply edits\n            FormattingEdit.execute(editorOrModel, allEdits, true);\n            alertFormattingEdits(allEdits);\n            editorOrModel.revealPositionInCenterIfOutsideViewport(editorOrModel.getPosition(), 1 /* ScrollType.Immediate */);\n        }\n        else {\n            // use model to apply edits\n            const [{ range }] = allEdits;\n            const initialSelection = new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn);\n            model.pushEditOperations([initialSelection], allEdits.map(edit => {\n                return {\n                    text: edit.text,\n                    range: Range.lift(edit.range),\n                    forceMoveMarkers: true\n                };\n            }), undoEdits => {\n                for (const { range } of undoEdits) {\n                    if (Range.areIntersectingOrTouching(range, initialSelection)) {\n                        return [new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn)];\n                    }\n                }\n                return null;\n            });\n        }\n        return true;\n    });\n}\nexport function formatDocumentWithSelectedProvider(accessor, editorOrModel, mode, progress, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const instaService = accessor.get(IInstantiationService);\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const model = isCodeEditor(editorOrModel) ? editorOrModel.getModel() : editorOrModel;\n        const provider = getRealAndSyntheticDocumentFormattersOrdered(languageFeaturesService.documentFormattingEditProvider, languageFeaturesService.documentRangeFormattingEditProvider, model);\n        const selected = yield FormattingConflicts.select(provider, model, mode);\n        if (selected) {\n            progress.report(selected);\n            yield instaService.invokeFunction(formatDocumentWithProvider, selected, editorOrModel, mode, token);\n        }\n    });\n}\nexport function formatDocumentWithProvider(accessor, provider, editorOrModel, mode, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const workerService = accessor.get(IEditorWorkerService);\n        let model;\n        let cts;\n        if (isCodeEditor(editorOrModel)) {\n            model = editorOrModel.getModel();\n            cts = new EditorStateCancellationTokenSource(editorOrModel, 1 /* CodeEditorStateFlag.Value */ | 4 /* CodeEditorStateFlag.Position */, undefined, token);\n        }\n        else {\n            model = editorOrModel;\n            cts = new TextModelCancellationTokenSource(editorOrModel, token);\n        }\n        let edits;\n        try {\n            const rawEdits = yield provider.provideDocumentFormattingEdits(model, model.getFormattingOptions(), cts.token);\n            edits = yield workerService.computeMoreMinimalEdits(model.uri, rawEdits);\n            if (cts.token.isCancellationRequested) {\n                return true;\n            }\n        }\n        finally {\n            cts.dispose();\n        }\n        if (!edits || edits.length === 0) {\n            return false;\n        }\n        if (isCodeEditor(editorOrModel)) {\n            // use editor to apply edits\n            FormattingEdit.execute(editorOrModel, edits, mode !== 2 /* FormattingMode.Silent */);\n            if (mode !== 2 /* FormattingMode.Silent */) {\n                alertFormattingEdits(edits);\n                editorOrModel.revealPositionInCenterIfOutsideViewport(editorOrModel.getPosition(), 1 /* ScrollType.Immediate */);\n            }\n        }\n        else {\n            // use model to apply edits\n            const [{ range }] = edits;\n            const initialSelection = new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn);\n            model.pushEditOperations([initialSelection], edits.map(edit => {\n                return {\n                    text: edit.text,\n                    range: Range.lift(edit.range),\n                    forceMoveMarkers: true\n                };\n            }), undoEdits => {\n                for (const { range } of undoEdits) {\n                    if (Range.areIntersectingOrTouching(range, initialSelection)) {\n                        return [new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn)];\n                    }\n                }\n                return null;\n            });\n        }\n        return true;\n    });\n}\nexport function getDocumentRangeFormattingEditsUntilResult(workerService, languageFeaturesService, model, range, options, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const providers = languageFeaturesService.documentRangeFormattingEditProvider.ordered(model);\n        for (const provider of providers) {\n            const rawEdits = yield Promise.resolve(provider.provideDocumentRangeFormattingEdits(model, range, options, token)).catch(onUnexpectedExternalError);\n            if (isNonEmptyArray(rawEdits)) {\n                return yield workerService.computeMoreMinimalEdits(model.uri, rawEdits);\n            }\n        }\n        return undefined;\n    });\n}\nexport function getDocumentFormattingEditsUntilResult(workerService, languageFeaturesService, model, options, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const providers = getRealAndSyntheticDocumentFormattersOrdered(languageFeaturesService.documentFormattingEditProvider, languageFeaturesService.documentRangeFormattingEditProvider, model);\n        for (const provider of providers) {\n            const rawEdits = yield Promise.resolve(provider.provideDocumentFormattingEdits(model, options, token)).catch(onUnexpectedExternalError);\n            if (isNonEmptyArray(rawEdits)) {\n                return yield workerService.computeMoreMinimalEdits(model.uri, rawEdits);\n            }\n        }\n        return undefined;\n    });\n}\nexport function getOnTypeFormattingEdits(workerService, languageFeaturesService, model, position, ch, options, token) {\n    const providers = languageFeaturesService.onTypeFormattingEditProvider.ordered(model);\n    if (providers.length === 0) {\n        return Promise.resolve(undefined);\n    }\n    if (providers[0].autoFormatTriggerCharacters.indexOf(ch) < 0) {\n        return Promise.resolve(undefined);\n    }\n    return Promise.resolve(providers[0].provideOnTypeFormattingEdits(model, position, ch, options, token)).catch(onUnexpectedExternalError).then(edits => {\n        return workerService.computeMoreMinimalEdits(model.uri, edits);\n    });\n}\nCommandsRegistry.registerCommand('_executeFormatRangeProvider', function (accessor, ...args) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const [resource, range, options] = args;\n        assertType(URI.isUri(resource));\n        assertType(Range.isIRange(range));\n        const resolverService = accessor.get(ITextModelService);\n        const workerService = accessor.get(IEditorWorkerService);\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const reference = yield resolverService.createModelReference(resource);\n        try {\n            return getDocumentRangeFormattingEditsUntilResult(workerService, languageFeaturesService, reference.object.textEditorModel, Range.lift(range), options, CancellationToken.None);\n        }\n        finally {\n            reference.dispose();\n        }\n    });\n});\nCommandsRegistry.registerCommand('_executeFormatDocumentProvider', function (accessor, ...args) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const [resource, options] = args;\n        assertType(URI.isUri(resource));\n        const resolverService = accessor.get(ITextModelService);\n        const workerService = accessor.get(IEditorWorkerService);\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const reference = yield resolverService.createModelReference(resource);\n        try {\n            return getDocumentFormattingEditsUntilResult(workerService, languageFeaturesService, reference.object.textEditorModel, options, CancellationToken.None);\n        }\n        finally {\n            reference.dispose();\n        }\n    });\n});\nCommandsRegistry.registerCommand('_executeFormatOnTypeProvider', function (accessor, ...args) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const [resource, position, ch, options] = args;\n        assertType(URI.isUri(resource));\n        assertType(Position.isIPosition(position));\n        assertType(typeof ch === 'string');\n        const resolverService = accessor.get(ITextModelService);\n        const workerService = accessor.get(IEditorWorkerService);\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const reference = yield resolverService.createModelReference(resource);\n        try {\n            return getOnTypeFormattingEdits(workerService, languageFeaturesService, reference.object.textEditorModel, Position.lift(position), ch, options, CancellationToken.None);\n        }\n        finally {\n            reference.dispose();\n        }\n    });\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { CancellationToken, CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { CharacterSet } from '../../../common/core/characterClassifier.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { IEditorWorkerService } from '../../../common/services/editorWorker.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { alertFormattingEdits, formatDocumentRangesWithSelectedProvider, formatDocumentWithSelectedProvider, getOnTypeFormattingEdits } from './format.js';\nimport { FormattingEdit } from './formattingEdit.js';\nimport * as nls from '../../../../nls.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IEditorProgressService, Progress } from '../../../../platform/progress/common/progress.js';\nlet FormatOnType = class FormatOnType {\n    constructor(_editor, _languageFeaturesService, _workerService) {\n        this._editor = _editor;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._workerService = _workerService;\n        this._disposables = new DisposableStore();\n        this._sessionDisposables = new DisposableStore();\n        this._disposables.add(_languageFeaturesService.onTypeFormattingEditProvider.onDidChange(this._update, this));\n        this._disposables.add(_editor.onDidChangeModel(() => this._update()));\n        this._disposables.add(_editor.onDidChangeModelLanguage(() => this._update()));\n        this._disposables.add(_editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(54 /* EditorOption.formatOnType */)) {\n                this._update();\n            }\n        }));\n        this._update();\n    }\n    dispose() {\n        this._disposables.dispose();\n        this._sessionDisposables.dispose();\n    }\n    _update() {\n        // clean up\n        this._sessionDisposables.clear();\n        // we are disabled\n        if (!this._editor.getOption(54 /* EditorOption.formatOnType */)) {\n            return;\n        }\n        // no model\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        // no support\n        const [support] = this._languageFeaturesService.onTypeFormattingEditProvider.ordered(model);\n        if (!support || !support.autoFormatTriggerCharacters) {\n            return;\n        }\n        // register typing listeners that will trigger the format\n        const triggerChars = new CharacterSet();\n        for (const ch of support.autoFormatTriggerCharacters) {\n            triggerChars.add(ch.charCodeAt(0));\n        }\n        this._sessionDisposables.add(this._editor.onDidType((text) => {\n            const lastCharCode = text.charCodeAt(text.length - 1);\n            if (triggerChars.has(lastCharCode)) {\n                this._trigger(String.fromCharCode(lastCharCode));\n            }\n        }));\n    }\n    _trigger(ch) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        if (this._editor.getSelections().length > 1 || !this._editor.getSelection().isEmpty()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        const position = this._editor.getPosition();\n        const cts = new CancellationTokenSource();\n        // install a listener that checks if edits happens before the\n        // position on which we format right now. If so, we won't\n        // apply the format edits\n        const unbind = this._editor.onDidChangeModelContent((e) => {\n            if (e.isFlush) {\n                // a model.setValue() was called\n                // cancel only once\n                cts.cancel();\n                unbind.dispose();\n                return;\n            }\n            for (let i = 0, len = e.changes.length; i < len; i++) {\n                const change = e.changes[i];\n                if (change.range.endLineNumber <= position.lineNumber) {\n                    // cancel only once\n                    cts.cancel();\n                    unbind.dispose();\n                    return;\n                }\n            }\n        });\n        getOnTypeFormattingEdits(this._workerService, this._languageFeaturesService, model, position, ch, model.getFormattingOptions(), cts.token).then(edits => {\n            if (cts.token.isCancellationRequested) {\n                return;\n            }\n            if (isNonEmptyArray(edits)) {\n                FormattingEdit.execute(this._editor, edits, true);\n                alertFormattingEdits(edits);\n            }\n        }).finally(() => {\n            unbind.dispose();\n        });\n    }\n};\nFormatOnType.ID = 'editor.contrib.autoFormat';\nFormatOnType = __decorate([\n    __param(1, ILanguageFeaturesService),\n    __param(2, IEditorWorkerService)\n], FormatOnType);\nlet FormatOnPaste = class FormatOnPaste {\n    constructor(editor, _languageFeaturesService, _instantiationService) {\n        this.editor = editor;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._instantiationService = _instantiationService;\n        this._callOnDispose = new DisposableStore();\n        this._callOnModel = new DisposableStore();\n        this._callOnDispose.add(editor.onDidChangeConfiguration(() => this._update()));\n        this._callOnDispose.add(editor.onDidChangeModel(() => this._update()));\n        this._callOnDispose.add(editor.onDidChangeModelLanguage(() => this._update()));\n        this._callOnDispose.add(_languageFeaturesService.documentRangeFormattingEditProvider.onDidChange(this._update, this));\n    }\n    dispose() {\n        this._callOnDispose.dispose();\n        this._callOnModel.dispose();\n    }\n    _update() {\n        // clean up\n        this._callOnModel.clear();\n        // we are disabled\n        if (!this.editor.getOption(53 /* EditorOption.formatOnPaste */)) {\n            return;\n        }\n        // no model\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        // no formatter\n        if (!this._languageFeaturesService.documentRangeFormattingEditProvider.has(this.editor.getModel())) {\n            return;\n        }\n        this._callOnModel.add(this.editor.onDidPaste(({ range }) => this._trigger(range)));\n    }\n    _trigger(range) {\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        if (this.editor.getSelections().length > 1) {\n            return;\n        }\n        this._instantiationService.invokeFunction(formatDocumentRangesWithSelectedProvider, this.editor, range, 2 /* FormattingMode.Silent */, Progress.None, CancellationToken.None).catch(onUnexpectedError);\n    }\n};\nFormatOnPaste.ID = 'editor.contrib.formatOnPaste';\nFormatOnPaste = __decorate([\n    __param(1, ILanguageFeaturesService),\n    __param(2, IInstantiationService)\n], FormatOnPaste);\nclass FormatDocumentAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.formatDocument',\n            label: nls.localize('formatDocument.label', \"Format Document\"),\n            alias: 'Format Document',\n            precondition: ContextKeyExpr.and(EditorContextKeys.notInCompositeEditor, EditorContextKeys.writable, EditorContextKeys.hasDocumentFormattingProvider),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 36 /* KeyCode.KeyF */,\n                linux: { primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 39 /* KeyCode.KeyI */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            contextMenuOpts: {\n                group: '1_modification',\n                order: 1.3\n            }\n        });\n    }\n    run(accessor, editor) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (editor.hasModel()) {\n                const instaService = accessor.get(IInstantiationService);\n                const progressService = accessor.get(IEditorProgressService);\n                yield progressService.showWhile(instaService.invokeFunction(formatDocumentWithSelectedProvider, editor, 1 /* FormattingMode.Explicit */, Progress.None, CancellationToken.None), 250);\n            }\n        });\n    }\n}\nclass FormatSelectionAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.formatSelection',\n            label: nls.localize('formatSelection.label', \"Format Selection\"),\n            alias: 'Format Selection',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasDocumentSelectionFormattingProvider),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 36 /* KeyCode.KeyF */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            contextMenuOpts: {\n                when: EditorContextKeys.hasNonEmptySelection,\n                group: '1_modification',\n                order: 1.31\n            }\n        });\n    }\n    run(accessor, editor) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!editor.hasModel()) {\n                return;\n            }\n            const instaService = accessor.get(IInstantiationService);\n            const model = editor.getModel();\n            const ranges = editor.getSelections().map(range => {\n                return range.isEmpty()\n                    ? new Range(range.startLineNumber, 1, range.startLineNumber, model.getLineMaxColumn(range.startLineNumber))\n                    : range;\n            });\n            const progressService = accessor.get(IEditorProgressService);\n            yield progressService.showWhile(instaService.invokeFunction(formatDocumentRangesWithSelectedProvider, editor, ranges, 1 /* FormattingMode.Explicit */, Progress.None, CancellationToken.None), 250);\n        });\n    }\n}\nregisterEditorContribution(FormatOnType.ID, FormatOnType, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\nregisterEditorContribution(FormatOnPaste.ID, FormatOnPaste, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\nregisterEditorAction(FormatDocumentAction);\nregisterEditorAction(FormatSelectionAction);\n// this is the old format action that does both (format document OR format selection)\n// and we keep it here such that existing keybinding configurations etc will still work\nCommandsRegistry.registerCommand('editor.action.format', (accessor) => __awaiter(void 0, void 0, void 0, function* () {\n    const editor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\n    if (!editor || !editor.hasModel()) {\n        return;\n    }\n    const commandService = accessor.get(ICommandService);\n    if (editor.getSelection().isEmpty()) {\n        yield commandService.executeCommand('editor.action.formatDocument');\n    }\n    else {\n        yield commandService.executeCommand('editor.action.formatSelection');\n    }\n}));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Range } from '../../../common/core/range.js';\nimport { StableEditorScrollState } from '../../../browser/stableEditorScroll.js';\nexport class FormattingEdit {\n    static _handleEolEdits(editor, edits) {\n        let newEol = undefined;\n        const singleEdits = [];\n        for (const edit of edits) {\n            if (typeof edit.eol === 'number') {\n                newEol = edit.eol;\n            }\n            if (edit.range && typeof edit.text === 'string') {\n                singleEdits.push(edit);\n            }\n        }\n        if (typeof newEol === 'number') {\n            if (editor.hasModel()) {\n                editor.getModel().pushEOL(newEol);\n            }\n        }\n        return singleEdits;\n    }\n    static _isFullModelReplaceEdit(editor, edit) {\n        if (!editor.hasModel()) {\n            return false;\n        }\n        const model = editor.getModel();\n        const editRange = model.validateRange(edit.range);\n        const fullModelRange = model.getFullModelRange();\n        return fullModelRange.equalsRange(editRange);\n    }\n    static execute(editor, _edits, addUndoStops) {\n        if (addUndoStops) {\n            editor.pushUndoStop();\n        }\n        const scrollState = StableEditorScrollState.capture(editor);\n        const edits = FormattingEdit._handleEolEdits(editor, _edits);\n        if (edits.length === 1 && FormattingEdit._isFullModelReplaceEdit(editor, edits[0])) {\n            // We use replace semantics and hope that markers stay put...\n            editor.executeEdits('formatEditsCommand', edits.map(edit => EditOperation.replace(Range.lift(edit.range), edit.text)));\n        }\n        else {\n            editor.executeEdits('formatEditsCommand', edits.map(edit => EditOperation.replaceMove(Range.lift(edit.range), edit.text)));\n        }\n        if (addUndoStops) {\n            editor.pushUndoStop();\n        }\n        scrollState.restoreRelativeVerticalPositionOfCursor(editor);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { binarySearch } from '../../../../base/common/arrays.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { LinkedList } from '../../../../base/common/linkedList.js';\nimport { compare } from '../../../../base/common/strings.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { Range } from '../../../common/core/range.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IMarkerService, MarkerSeverity } from '../../../../platform/markers/common/markers.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nexport class MarkerCoordinate {\n    constructor(marker, index, total) {\n        this.marker = marker;\n        this.index = index;\n        this.total = total;\n    }\n}\nexport let MarkerList = class MarkerList {\n    constructor(resourceFilter, _markerService, _configService) {\n        this._markerService = _markerService;\n        this._configService = _configService;\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        this._dispoables = new DisposableStore();\n        this._markers = [];\n        this._nextIdx = -1;\n        if (URI.isUri(resourceFilter)) {\n            this._resourceFilter = uri => uri.toString() === resourceFilter.toString();\n        }\n        else if (resourceFilter) {\n            this._resourceFilter = resourceFilter;\n        }\n        const compareOrder = this._configService.getValue('problems.sortOrder');\n        const compareMarker = (a, b) => {\n            let res = compare(a.resource.toString(), b.resource.toString());\n            if (res === 0) {\n                if (compareOrder === 'position') {\n                    res = Range.compareRangesUsingStarts(a, b) || MarkerSeverity.compare(a.severity, b.severity);\n                }\n                else {\n                    res = MarkerSeverity.compare(a.severity, b.severity) || Range.compareRangesUsingStarts(a, b);\n                }\n            }\n            return res;\n        };\n        const updateMarker = () => {\n            this._markers = this._markerService.read({\n                resource: URI.isUri(resourceFilter) ? resourceFilter : undefined,\n                severities: MarkerSeverity.Error | MarkerSeverity.Warning | MarkerSeverity.Info\n            });\n            if (typeof resourceFilter === 'function') {\n                this._markers = this._markers.filter(m => this._resourceFilter(m.resource));\n            }\n            this._markers.sort(compareMarker);\n        };\n        updateMarker();\n        this._dispoables.add(_markerService.onMarkerChanged(uris => {\n            if (!this._resourceFilter || uris.some(uri => this._resourceFilter(uri))) {\n                updateMarker();\n                this._nextIdx = -1;\n                this._onDidChange.fire();\n            }\n        }));\n    }\n    dispose() {\n        this._dispoables.dispose();\n        this._onDidChange.dispose();\n    }\n    matches(uri) {\n        if (!this._resourceFilter && !uri) {\n            return true;\n        }\n        if (!this._resourceFilter || !uri) {\n            return false;\n        }\n        return this._resourceFilter(uri);\n    }\n    get selected() {\n        const marker = this._markers[this._nextIdx];\n        return marker && new MarkerCoordinate(marker, this._nextIdx + 1, this._markers.length);\n    }\n    _initIdx(model, position, fwd) {\n        let found = false;\n        let idx = this._markers.findIndex(marker => marker.resource.toString() === model.uri.toString());\n        if (idx < 0) {\n            idx = binarySearch(this._markers, { resource: model.uri }, (a, b) => compare(a.resource.toString(), b.resource.toString()));\n            if (idx < 0) {\n                idx = ~idx;\n            }\n        }\n        for (let i = idx; i < this._markers.length; i++) {\n            let range = Range.lift(this._markers[i]);\n            if (range.isEmpty()) {\n                const word = model.getWordAtPosition(range.getStartPosition());\n                if (word) {\n                    range = new Range(range.startLineNumber, word.startColumn, range.startLineNumber, word.endColumn);\n                }\n            }\n            if (position && (range.containsPosition(position) || position.isBeforeOrEqual(range.getStartPosition()))) {\n                this._nextIdx = i;\n                found = true;\n                break;\n            }\n            if (this._markers[i].resource.toString() !== model.uri.toString()) {\n                break;\n            }\n        }\n        if (!found) {\n            // after the last change\n            this._nextIdx = fwd ? 0 : this._markers.length - 1;\n        }\n        if (this._nextIdx < 0) {\n            this._nextIdx = this._markers.length - 1;\n        }\n    }\n    resetIndex() {\n        this._nextIdx = -1;\n    }\n    move(fwd, model, position) {\n        if (this._markers.length === 0) {\n            return false;\n        }\n        const oldIdx = this._nextIdx;\n        if (this._nextIdx === -1) {\n            this._initIdx(model, position, fwd);\n        }\n        else if (fwd) {\n            this._nextIdx = (this._nextIdx + 1) % this._markers.length;\n        }\n        else if (!fwd) {\n            this._nextIdx = (this._nextIdx - 1 + this._markers.length) % this._markers.length;\n        }\n        if (oldIdx !== this._nextIdx) {\n            return true;\n        }\n        return false;\n    }\n    find(uri, position) {\n        let idx = this._markers.findIndex(marker => marker.resource.toString() === uri.toString());\n        if (idx < 0) {\n            return undefined;\n        }\n        for (; idx < this._markers.length; idx++) {\n            if (Range.containsPosition(this._markers[idx], position)) {\n                return new MarkerCoordinate(this._markers[idx], idx + 1, this._markers.length);\n            }\n        }\n        return undefined;\n    }\n};\nMarkerList = __decorate([\n    __param(1, IMarkerService),\n    __param(2, IConfigurationService)\n], MarkerList);\nexport const IMarkerNavigationService = createDecorator('IMarkerNavigationService');\nlet MarkerNavigationService = class MarkerNavigationService {\n    constructor(_markerService, _configService) {\n        this._markerService = _markerService;\n        this._configService = _configService;\n        this._provider = new LinkedList();\n    }\n    getMarkerList(resource) {\n        for (const provider of this._provider) {\n            const result = provider.getMarkerList(resource);\n            if (result) {\n                return result;\n            }\n        }\n        // default\n        return new MarkerList(resource, this._markerService, this._configService);\n    }\n};\nMarkerNavigationService = __decorate([\n    __param(0, IMarkerService),\n    __param(1, IConfigurationService)\n], MarkerNavigationService);\nregisterSingleton(IMarkerNavigationService, MarkerNavigationService, 1 /* InstantiationType.Delayed */);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { ScrollableElement } from '../../../../base/browser/ui/scrollbar/scrollableElement.js';\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { Color } from '../../../../base/common/color.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { DisposableStore, dispose } from '../../../../base/common/lifecycle.js';\nimport { basename } from '../../../../base/common/resources.js';\nimport { splitLines } from '../../../../base/common/strings.js';\nimport './media/gotoErrorWidget.css';\nimport { Range } from '../../../common/core/range.js';\nimport { peekViewTitleForeground, peekViewTitleInfoForeground, PeekViewWidget } from '../../peekView/browser/peekView.js';\nimport * as nls from '../../../../nls.js';\nimport { createAndFillInActionBarActions } from '../../../../platform/actions/browser/menuEntryActionViewItem.js';\nimport { IMenuService, MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ILabelService } from '../../../../platform/label/common/label.js';\nimport { MarkerSeverity } from '../../../../platform/markers/common/markers.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { SeverityIcon } from '../../../../platform/severityIcon/browser/severityIcon.js';\nimport { contrastBorder, editorBackground, editorErrorBorder, editorErrorForeground, editorInfoBorder, editorInfoForeground, editorWarningBorder, editorWarningForeground, oneOf, registerColor, transparent } from '../../../../platform/theme/common/colorRegistry.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nclass MessageWidget {\n    constructor(parent, editor, onRelatedInformation, _openerService, _labelService) {\n        this._openerService = _openerService;\n        this._labelService = _labelService;\n        this._lines = 0;\n        this._longestLineLength = 0;\n        this._relatedDiagnostics = new WeakMap();\n        this._disposables = new DisposableStore();\n        this._editor = editor;\n        const domNode = document.createElement('div');\n        domNode.className = 'descriptioncontainer';\n        this._messageBlock = document.createElement('div');\n        this._messageBlock.classList.add('message');\n        this._messageBlock.setAttribute('aria-live', 'assertive');\n        this._messageBlock.setAttribute('role', 'alert');\n        domNode.appendChild(this._messageBlock);\n        this._relatedBlock = document.createElement('div');\n        domNode.appendChild(this._relatedBlock);\n        this._disposables.add(dom.addStandardDisposableListener(this._relatedBlock, 'click', event => {\n            event.preventDefault();\n            const related = this._relatedDiagnostics.get(event.target);\n            if (related) {\n                onRelatedInformation(related);\n            }\n        }));\n        this._scrollable = new ScrollableElement(domNode, {\n            horizontal: 1 /* ScrollbarVisibility.Auto */,\n            vertical: 1 /* ScrollbarVisibility.Auto */,\n            useShadows: false,\n            horizontalScrollbarSize: 6,\n            verticalScrollbarSize: 6\n        });\n        parent.appendChild(this._scrollable.getDomNode());\n        this._disposables.add(this._scrollable.onScroll(e => {\n            domNode.style.left = `-${e.scrollLeft}px`;\n            domNode.style.top = `-${e.scrollTop}px`;\n        }));\n        this._disposables.add(this._scrollable);\n    }\n    dispose() {\n        dispose(this._disposables);\n    }\n    update(marker) {\n        const { source, message, relatedInformation, code } = marker;\n        let sourceAndCodeLength = ((source === null || source === void 0 ? void 0 : source.length) || 0) + '()'.length;\n        if (code) {\n            if (typeof code === 'string') {\n                sourceAndCodeLength += code.length;\n            }\n            else {\n                sourceAndCodeLength += code.value.length;\n            }\n        }\n        const lines = splitLines(message);\n        this._lines = lines.length;\n        this._longestLineLength = 0;\n        for (const line of lines) {\n            this._longestLineLength = Math.max(line.length + sourceAndCodeLength, this._longestLineLength);\n        }\n        dom.clearNode(this._messageBlock);\n        this._messageBlock.setAttribute('aria-label', this.getAriaLabel(marker));\n        this._editor.applyFontInfo(this._messageBlock);\n        let lastLineElement = this._messageBlock;\n        for (const line of lines) {\n            lastLineElement = document.createElement('div');\n            lastLineElement.innerText = line;\n            if (line === '') {\n                lastLineElement.style.height = this._messageBlock.style.lineHeight;\n            }\n            this._messageBlock.appendChild(lastLineElement);\n        }\n        if (source || code) {\n            const detailsElement = document.createElement('span');\n            detailsElement.classList.add('details');\n            lastLineElement.appendChild(detailsElement);\n            if (source) {\n                const sourceElement = document.createElement('span');\n                sourceElement.innerText = source;\n                sourceElement.classList.add('source');\n                detailsElement.appendChild(sourceElement);\n            }\n            if (code) {\n                if (typeof code === 'string') {\n                    const codeElement = document.createElement('span');\n                    codeElement.innerText = `(${code})`;\n                    codeElement.classList.add('code');\n                    detailsElement.appendChild(codeElement);\n                }\n                else {\n                    this._codeLink = dom.$('a.code-link');\n                    this._codeLink.setAttribute('href', `${code.target.toString()}`);\n                    this._codeLink.onclick = (e) => {\n                        this._openerService.open(code.target, { allowCommands: true });\n                        e.preventDefault();\n                        e.stopPropagation();\n                    };\n                    const codeElement = dom.append(this._codeLink, dom.$('span'));\n                    codeElement.innerText = code.value;\n                    detailsElement.appendChild(this._codeLink);\n                }\n            }\n        }\n        dom.clearNode(this._relatedBlock);\n        this._editor.applyFontInfo(this._relatedBlock);\n        if (isNonEmptyArray(relatedInformation)) {\n            const relatedInformationNode = this._relatedBlock.appendChild(document.createElement('div'));\n            relatedInformationNode.style.paddingTop = `${Math.floor(this._editor.getOption(64 /* EditorOption.lineHeight */) * 0.66)}px`;\n            this._lines += 1;\n            for (const related of relatedInformation) {\n                const container = document.createElement('div');\n                const relatedResource = document.createElement('a');\n                relatedResource.classList.add('filename');\n                relatedResource.innerText = `${this._labelService.getUriBasenameLabel(related.resource)}(${related.startLineNumber}, ${related.startColumn}): `;\n                relatedResource.title = this._labelService.getUriLabel(related.resource);\n                this._relatedDiagnostics.set(relatedResource, related);\n                const relatedMessage = document.createElement('span');\n                relatedMessage.innerText = related.message;\n                container.appendChild(relatedResource);\n                container.appendChild(relatedMessage);\n                this._lines += 1;\n                relatedInformationNode.appendChild(container);\n            }\n        }\n        const fontInfo = this._editor.getOption(48 /* EditorOption.fontInfo */);\n        const scrollWidth = Math.ceil(fontInfo.typicalFullwidthCharacterWidth * this._longestLineLength * 0.75);\n        const scrollHeight = fontInfo.lineHeight * this._lines;\n        this._scrollable.setScrollDimensions({ scrollWidth, scrollHeight });\n    }\n    layout(height, width) {\n        this._scrollable.getDomNode().style.height = `${height}px`;\n        this._scrollable.getDomNode().style.width = `${width}px`;\n        this._scrollable.setScrollDimensions({ width, height });\n    }\n    getHeightInLines() {\n        return Math.min(17, this._lines);\n    }\n    getAriaLabel(marker) {\n        let severityLabel = '';\n        switch (marker.severity) {\n            case MarkerSeverity.Error:\n                severityLabel = nls.localize('Error', \"Error\");\n                break;\n            case MarkerSeverity.Warning:\n                severityLabel = nls.localize('Warning', \"Warning\");\n                break;\n            case MarkerSeverity.Info:\n                severityLabel = nls.localize('Info', \"Info\");\n                break;\n            case MarkerSeverity.Hint:\n                severityLabel = nls.localize('Hint', \"Hint\");\n                break;\n        }\n        let ariaLabel = nls.localize('marker aria', \"{0} at {1}. \", severityLabel, marker.startLineNumber + ':' + marker.startColumn);\n        const model = this._editor.getModel();\n        if (model && (marker.startLineNumber <= model.getLineCount()) && (marker.startLineNumber >= 1)) {\n            const lineContent = model.getLineContent(marker.startLineNumber);\n            ariaLabel = `${lineContent}, ${ariaLabel}`;\n        }\n        return ariaLabel;\n    }\n}\nexport let MarkerNavigationWidget = class MarkerNavigationWidget extends PeekViewWidget {\n    constructor(editor, _themeService, _openerService, _menuService, instantiationService, _contextKeyService, _labelService) {\n        super(editor, { showArrow: true, showFrame: true, isAccessible: true, frameWidth: 1 }, instantiationService);\n        this._themeService = _themeService;\n        this._openerService = _openerService;\n        this._menuService = _menuService;\n        this._contextKeyService = _contextKeyService;\n        this._labelService = _labelService;\n        this._callOnDispose = new DisposableStore();\n        this._onDidSelectRelatedInformation = new Emitter();\n        this.onDidSelectRelatedInformation = this._onDidSelectRelatedInformation.event;\n        this._severity = MarkerSeverity.Warning;\n        this._backgroundColor = Color.white;\n        this._applyTheme(_themeService.getColorTheme());\n        this._callOnDispose.add(_themeService.onDidColorThemeChange(this._applyTheme.bind(this)));\n        this.create();\n    }\n    _applyTheme(theme) {\n        this._backgroundColor = theme.getColor(editorMarkerNavigationBackground);\n        let colorId = editorMarkerNavigationError;\n        let headerBackground = editorMarkerNavigationErrorHeader;\n        if (this._severity === MarkerSeverity.Warning) {\n            colorId = editorMarkerNavigationWarning;\n            headerBackground = editorMarkerNavigationWarningHeader;\n        }\n        else if (this._severity === MarkerSeverity.Info) {\n            colorId = editorMarkerNavigationInfo;\n            headerBackground = editorMarkerNavigationInfoHeader;\n        }\n        const frameColor = theme.getColor(colorId);\n        const headerBg = theme.getColor(headerBackground);\n        this.style({\n            arrowColor: frameColor,\n            frameColor: frameColor,\n            headerBackgroundColor: headerBg,\n            primaryHeadingColor: theme.getColor(peekViewTitleForeground),\n            secondaryHeadingColor: theme.getColor(peekViewTitleInfoForeground)\n        }); // style() will trigger _applyStyles\n    }\n    _applyStyles() {\n        if (this._parentContainer) {\n            this._parentContainer.style.backgroundColor = this._backgroundColor ? this._backgroundColor.toString() : '';\n        }\n        super._applyStyles();\n    }\n    dispose() {\n        this._callOnDispose.dispose();\n        super.dispose();\n    }\n    _fillHead(container) {\n        super._fillHead(container);\n        this._disposables.add(this._actionbarWidget.actionRunner.onWillRun(e => this.editor.focus()));\n        const actions = [];\n        const menu = this._menuService.createMenu(MarkerNavigationWidget.TitleMenu, this._contextKeyService);\n        createAndFillInActionBarActions(menu, undefined, actions);\n        this._actionbarWidget.push(actions, { label: false, icon: true, index: 0 });\n        menu.dispose();\n    }\n    _fillTitleIcon(container) {\n        this._icon = dom.append(container, dom.$(''));\n    }\n    _fillBody(container) {\n        this._parentContainer = container;\n        container.classList.add('marker-widget');\n        this._parentContainer.tabIndex = 0;\n        this._parentContainer.setAttribute('role', 'tooltip');\n        this._container = document.createElement('div');\n        container.appendChild(this._container);\n        this._message = new MessageWidget(this._container, this.editor, related => this._onDidSelectRelatedInformation.fire(related), this._openerService, this._labelService);\n        this._disposables.add(this._message);\n    }\n    show() {\n        throw new Error('call showAtMarker');\n    }\n    showAtMarker(marker, markerIdx, markerCount) {\n        // update:\n        // * title\n        // * message\n        this._container.classList.remove('stale');\n        this._message.update(marker);\n        // update frame color (only applied on 'show')\n        this._severity = marker.severity;\n        this._applyTheme(this._themeService.getColorTheme());\n        // show\n        const range = Range.lift(marker);\n        const editorPosition = this.editor.getPosition();\n        const position = editorPosition && range.containsPosition(editorPosition) ? editorPosition : range.getStartPosition();\n        super.show(position, this.computeRequiredHeight());\n        const model = this.editor.getModel();\n        if (model) {\n            const detail = markerCount > 1\n                ? nls.localize('problems', \"{0} of {1} problems\", markerIdx, markerCount)\n                : nls.localize('change', \"{0} of {1} problem\", markerIdx, markerCount);\n            this.setTitle(basename(model.uri), detail);\n        }\n        this._icon.className = `codicon ${SeverityIcon.className(MarkerSeverity.toSeverity(this._severity))}`;\n        this.editor.revealPositionNearTop(position, 0 /* ScrollType.Smooth */);\n        this.editor.focus();\n    }\n    updateMarker(marker) {\n        this._container.classList.remove('stale');\n        this._message.update(marker);\n    }\n    showStale() {\n        this._container.classList.add('stale');\n        this._relayout();\n    }\n    _doLayoutBody(heightInPixel, widthInPixel) {\n        super._doLayoutBody(heightInPixel, widthInPixel);\n        this._heightInPixel = heightInPixel;\n        this._message.layout(heightInPixel, widthInPixel);\n        this._container.style.height = `${heightInPixel}px`;\n    }\n    _onWidth(widthInPixel) {\n        this._message.layout(this._heightInPixel, widthInPixel);\n    }\n    _relayout() {\n        super._relayout(this.computeRequiredHeight());\n    }\n    computeRequiredHeight() {\n        return 3 + this._message.getHeightInLines();\n    }\n};\nMarkerNavigationWidget.TitleMenu = new MenuId('gotoErrorTitleMenu');\nMarkerNavigationWidget = __decorate([\n    __param(1, IThemeService),\n    __param(2, IOpenerService),\n    __param(3, IMenuService),\n    __param(4, IInstantiationService),\n    __param(5, IContextKeyService),\n    __param(6, ILabelService)\n], MarkerNavigationWidget);\n// theming\nconst errorDefault = oneOf(editorErrorForeground, editorErrorBorder);\nconst warningDefault = oneOf(editorWarningForeground, editorWarningBorder);\nconst infoDefault = oneOf(editorInfoForeground, editorInfoBorder);\nconst editorMarkerNavigationError = registerColor('editorMarkerNavigationError.background', { dark: errorDefault, light: errorDefault, hcDark: contrastBorder, hcLight: contrastBorder }, nls.localize('editorMarkerNavigationError', 'Editor marker navigation widget error color.'));\nconst editorMarkerNavigationErrorHeader = registerColor('editorMarkerNavigationError.headerBackground', { dark: transparent(editorMarkerNavigationError, .1), light: transparent(editorMarkerNavigationError, .1), hcDark: null, hcLight: null }, nls.localize('editorMarkerNavigationErrorHeaderBackground', 'Editor marker navigation widget error heading background.'));\nconst editorMarkerNavigationWarning = registerColor('editorMarkerNavigationWarning.background', { dark: warningDefault, light: warningDefault, hcDark: contrastBorder, hcLight: contrastBorder }, nls.localize('editorMarkerNavigationWarning', 'Editor marker navigation widget warning color.'));\nconst editorMarkerNavigationWarningHeader = registerColor('editorMarkerNavigationWarning.headerBackground', { dark: transparent(editorMarkerNavigationWarning, .1), light: transparent(editorMarkerNavigationWarning, .1), hcDark: '#0C141F', hcLight: transparent(editorMarkerNavigationWarning, .2) }, nls.localize('editorMarkerNavigationWarningBackground', 'Editor marker navigation widget warning heading background.'));\nconst editorMarkerNavigationInfo = registerColor('editorMarkerNavigationInfo.background', { dark: infoDefault, light: infoDefault, hcDark: contrastBorder, hcLight: contrastBorder }, nls.localize('editorMarkerNavigationInfo', 'Editor marker navigation widget info color.'));\nconst editorMarkerNavigationInfoHeader = registerColor('editorMarkerNavigationInfo.headerBackground', { dark: transparent(editorMarkerNavigationInfo, .1), light: transparent(editorMarkerNavigationInfo, .1), hcDark: null, hcLight: null }, nls.localize('editorMarkerNavigationInfoHeaderBackground', 'Editor marker navigation widget info heading background.'));\nconst editorMarkerNavigationBackground = registerColor('editorMarkerNavigation.background', { dark: editorBackground, light: editorBackground, hcDark: editorBackground, hcLight: editorBackground }, nls.localize('editorMarkerNavigationBackground', 'Editor marker navigation widget background.'));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { IMarkerNavigationService } from './markerNavigationService.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nimport { MarkerNavigationWidget } from './gotoErrorWidget.js';\nexport let MarkerController = class MarkerController {\n    static get(editor) {\n        return editor.getContribution(MarkerController.ID);\n    }\n    constructor(editor, _markerNavigationService, _contextKeyService, _editorService, _instantiationService) {\n        this._markerNavigationService = _markerNavigationService;\n        this._contextKeyService = _contextKeyService;\n        this._editorService = _editorService;\n        this._instantiationService = _instantiationService;\n        this._sessionDispoables = new DisposableStore();\n        this._editor = editor;\n        this._widgetVisible = CONTEXT_MARKERS_NAVIGATION_VISIBLE.bindTo(this._contextKeyService);\n    }\n    dispose() {\n        this._cleanUp();\n        this._sessionDispoables.dispose();\n    }\n    _cleanUp() {\n        this._widgetVisible.reset();\n        this._sessionDispoables.clear();\n        this._widget = undefined;\n        this._model = undefined;\n    }\n    _getOrCreateModel(uri) {\n        if (this._model && this._model.matches(uri)) {\n            return this._model;\n        }\n        let reusePosition = false;\n        if (this._model) {\n            reusePosition = true;\n            this._cleanUp();\n        }\n        this._model = this._markerNavigationService.getMarkerList(uri);\n        if (reusePosition) {\n            this._model.move(true, this._editor.getModel(), this._editor.getPosition());\n        }\n        this._widget = this._instantiationService.createInstance(MarkerNavigationWidget, this._editor);\n        this._widget.onDidClose(() => this.close(), this, this._sessionDispoables);\n        this._widgetVisible.set(true);\n        this._sessionDispoables.add(this._model);\n        this._sessionDispoables.add(this._widget);\n        // follow cursor\n        this._sessionDispoables.add(this._editor.onDidChangeCursorPosition(e => {\n            var _a, _b, _c;\n            if (!((_a = this._model) === null || _a === void 0 ? void 0 : _a.selected) || !Range.containsPosition((_b = this._model) === null || _b === void 0 ? void 0 : _b.selected.marker, e.position)) {\n                (_c = this._model) === null || _c === void 0 ? void 0 : _c.resetIndex();\n            }\n        }));\n        // update markers\n        this._sessionDispoables.add(this._model.onDidChange(() => {\n            if (!this._widget || !this._widget.position || !this._model) {\n                return;\n            }\n            const info = this._model.find(this._editor.getModel().uri, this._widget.position);\n            if (info) {\n                this._widget.updateMarker(info.marker);\n            }\n            else {\n                this._widget.showStale();\n            }\n        }));\n        // open related\n        this._sessionDispoables.add(this._widget.onDidSelectRelatedInformation(related => {\n            this._editorService.openCodeEditor({\n                resource: related.resource,\n                options: { pinned: true, revealIfOpened: true, selection: Range.lift(related).collapseToStart() }\n            }, this._editor);\n            this.close(false);\n        }));\n        this._sessionDispoables.add(this._editor.onDidChangeModel(() => this._cleanUp()));\n        return this._model;\n    }\n    close(focusEditor = true) {\n        this._cleanUp();\n        if (focusEditor) {\n            this._editor.focus();\n        }\n    }\n    showAtMarker(marker) {\n        if (this._editor.hasModel()) {\n            const model = this._getOrCreateModel(this._editor.getModel().uri);\n            model.resetIndex();\n            model.move(true, this._editor.getModel(), new Position(marker.startLineNumber, marker.startColumn));\n            if (model.selected) {\n                this._widget.showAtMarker(model.selected.marker, model.selected.index, model.selected.total);\n            }\n        }\n    }\n    nagivate(next, multiFile) {\n        var _a, _b;\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this._editor.hasModel()) {\n                const model = this._getOrCreateModel(multiFile ? undefined : this._editor.getModel().uri);\n                model.move(next, this._editor.getModel(), this._editor.getPosition());\n                if (!model.selected) {\n                    return;\n                }\n                if (model.selected.marker.resource.toString() !== this._editor.getModel().uri.toString()) {\n                    // show in different editor\n                    this._cleanUp();\n                    const otherEditor = yield this._editorService.openCodeEditor({\n                        resource: model.selected.marker.resource,\n                        options: { pinned: false, revealIfOpened: true, selectionRevealType: 2 /* TextEditorSelectionRevealType.NearTop */, selection: model.selected.marker }\n                    }, this._editor);\n                    if (otherEditor) {\n                        (_a = MarkerController.get(otherEditor)) === null || _a === void 0 ? void 0 : _a.close();\n                        (_b = MarkerController.get(otherEditor)) === null || _b === void 0 ? void 0 : _b.nagivate(next, multiFile);\n                    }\n                }\n                else {\n                    // show in this editor\n                    this._widget.showAtMarker(model.selected.marker, model.selected.index, model.selected.total);\n                }\n            }\n        });\n    }\n};\nMarkerController.ID = 'editor.contrib.markerController';\nMarkerController = __decorate([\n    __param(1, IMarkerNavigationService),\n    __param(2, IContextKeyService),\n    __param(3, ICodeEditorService),\n    __param(4, IInstantiationService)\n], MarkerController);\nclass MarkerNavigationAction extends EditorAction {\n    constructor(_next, _multiFile, opts) {\n        super(opts);\n        this._next = _next;\n        this._multiFile = _multiFile;\n    }\n    run(_accessor, editor) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            if (editor.hasModel()) {\n                (_a = MarkerController.get(editor)) === null || _a === void 0 ? void 0 : _a.nagivate(this._next, this._multiFile);\n            }\n        });\n    }\n}\nexport class NextMarkerAction extends MarkerNavigationAction {\n    constructor() {\n        super(true, false, {\n            id: NextMarkerAction.ID,\n            label: NextMarkerAction.LABEL,\n            alias: 'Go to Next Problem (Error, Warning, Info)',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 512 /* KeyMod.Alt */ | 66 /* KeyCode.F8 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MarkerNavigationWidget.TitleMenu,\n                title: NextMarkerAction.LABEL,\n                icon: registerIcon('marker-navigation-next', Codicon.arrowDown, nls.localize('nextMarkerIcon', 'Icon for goto next marker.')),\n                group: 'navigation',\n                order: 1\n            }\n        });\n    }\n}\nNextMarkerAction.ID = 'editor.action.marker.next';\nNextMarkerAction.LABEL = nls.localize('markerAction.next.label', \"Go to Next Problem (Error, Warning, Info)\");\nclass PrevMarkerAction extends MarkerNavigationAction {\n    constructor() {\n        super(false, false, {\n            id: PrevMarkerAction.ID,\n            label: PrevMarkerAction.LABEL,\n            alias: 'Go to Previous Problem (Error, Warning, Info)',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 66 /* KeyCode.F8 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MarkerNavigationWidget.TitleMenu,\n                title: PrevMarkerAction.LABEL,\n                icon: registerIcon('marker-navigation-previous', Codicon.arrowUp, nls.localize('previousMarkerIcon', 'Icon for goto previous marker.')),\n                group: 'navigation',\n                order: 2\n            }\n        });\n    }\n}\nPrevMarkerAction.ID = 'editor.action.marker.prev';\nPrevMarkerAction.LABEL = nls.localize('markerAction.previous.label', \"Go to Previous Problem (Error, Warning, Info)\");\nclass NextMarkerInFilesAction extends MarkerNavigationAction {\n    constructor() {\n        super(true, true, {\n            id: 'editor.action.marker.nextInFiles',\n            label: nls.localize('markerAction.nextInFiles.label', \"Go to Next Problem in Files (Error, Warning, Info)\"),\n            alias: 'Go to Next Problem in Files (Error, Warning, Info)',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 66 /* KeyCode.F8 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarGoMenu,\n                title: nls.localize({ key: 'miGotoNextProblem', comment: ['&& denotes a mnemonic'] }, \"Next &&Problem\"),\n                group: '6_problem_nav',\n                order: 1\n            }\n        });\n    }\n}\nclass PrevMarkerInFilesAction extends MarkerNavigationAction {\n    constructor() {\n        super(false, true, {\n            id: 'editor.action.marker.prevInFiles',\n            label: nls.localize('markerAction.previousInFiles.label', \"Go to Previous Problem in Files (Error, Warning, Info)\"),\n            alias: 'Go to Previous Problem in Files (Error, Warning, Info)',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 1024 /* KeyMod.Shift */ | 66 /* KeyCode.F8 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarGoMenu,\n                title: nls.localize({ key: 'miGotoPreviousProblem', comment: ['&& denotes a mnemonic'] }, \"Previous &&Problem\"),\n                group: '6_problem_nav',\n                order: 2\n            }\n        });\n    }\n}\nregisterEditorContribution(MarkerController.ID, MarkerController, 4 /* EditorContributionInstantiation.Lazy */);\nregisterEditorAction(NextMarkerAction);\nregisterEditorAction(PrevMarkerAction);\nregisterEditorAction(NextMarkerInFilesAction);\nregisterEditorAction(PrevMarkerInFilesAction);\nconst CONTEXT_MARKERS_NAVIGATION_VISIBLE = new RawContextKey('markersNavigationVisible', false);\nconst MarkerCommand = EditorCommand.bindToContribution(MarkerController.get);\nregisterEditorCommand(new MarkerCommand({\n    id: 'closeMarkersNavigation',\n    precondition: CONTEXT_MARKERS_NAVIGATION_VISIBLE,\n    handler: x => x.close(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 50,\n        kbExpr: EditorContextKeys.focus,\n        primary: 9 /* KeyCode.Escape */,\n        secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n    }\n}));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Emitter } from '../../../../base/common/event.js';\nimport { combinedDisposable, DisposableStore, dispose } from '../../../../base/common/lifecycle.js';\nimport { isEqual } from '../../../../base/common/resources.js';\nimport { EditorCommand, registerEditorCommand } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Range } from '../../../common/core/range.js';\nimport { localize } from '../../../../nls.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { KeybindingsRegistry } from '../../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nexport const ctxHasSymbols = new RawContextKey('hasSymbols', false, localize('hasSymbols', \"Whether there are symbol locations that can be navigated via keyboard-only.\"));\nexport const ISymbolNavigationService = createDecorator('ISymbolNavigationService');\nlet SymbolNavigationService = class SymbolNavigationService {\n    constructor(contextKeyService, _editorService, _notificationService, _keybindingService) {\n        this._editorService = _editorService;\n        this._notificationService = _notificationService;\n        this._keybindingService = _keybindingService;\n        this._currentModel = undefined;\n        this._currentIdx = -1;\n        this._ignoreEditorChange = false;\n        this._ctxHasSymbols = ctxHasSymbols.bindTo(contextKeyService);\n    }\n    reset() {\n        var _a, _b;\n        this._ctxHasSymbols.reset();\n        (_a = this._currentState) === null || _a === void 0 ? void 0 : _a.dispose();\n        (_b = this._currentMessage) === null || _b === void 0 ? void 0 : _b.dispose();\n        this._currentModel = undefined;\n        this._currentIdx = -1;\n    }\n    put(anchor) {\n        const refModel = anchor.parent.parent;\n        if (refModel.references.length <= 1) {\n            this.reset();\n            return;\n        }\n        this._currentModel = refModel;\n        this._currentIdx = refModel.references.indexOf(anchor);\n        this._ctxHasSymbols.set(true);\n        this._showMessage();\n        const editorState = new EditorState(this._editorService);\n        const listener = editorState.onDidChange(_ => {\n            if (this._ignoreEditorChange) {\n                return;\n            }\n            const editor = this._editorService.getActiveCodeEditor();\n            if (!editor) {\n                return;\n            }\n            const model = editor.getModel();\n            const position = editor.getPosition();\n            if (!model || !position) {\n                return;\n            }\n            let seenUri = false;\n            let seenPosition = false;\n            for (const reference of refModel.references) {\n                if (isEqual(reference.uri, model.uri)) {\n                    seenUri = true;\n                    seenPosition = seenPosition || Range.containsPosition(reference.range, position);\n                }\n                else if (seenUri) {\n                    break;\n                }\n            }\n            if (!seenUri || !seenPosition) {\n                this.reset();\n            }\n        });\n        this._currentState = combinedDisposable(editorState, listener);\n    }\n    revealNext(source) {\n        if (!this._currentModel) {\n            return Promise.resolve();\n        }\n        // get next result and advance\n        this._currentIdx += 1;\n        this._currentIdx %= this._currentModel.references.length;\n        const reference = this._currentModel.references[this._currentIdx];\n        // status\n        this._showMessage();\n        // open editor, ignore events while that happens\n        this._ignoreEditorChange = true;\n        return this._editorService.openCodeEditor({\n            resource: reference.uri,\n            options: {\n                selection: Range.collapseToStart(reference.range),\n                selectionRevealType: 3 /* TextEditorSelectionRevealType.NearTopIfOutsideViewport */\n            }\n        }, source).finally(() => {\n            this._ignoreEditorChange = false;\n        });\n    }\n    _showMessage() {\n        var _a;\n        (_a = this._currentMessage) === null || _a === void 0 ? void 0 : _a.dispose();\n        const kb = this._keybindingService.lookupKeybinding('editor.gotoNextSymbolFromResult');\n        const message = kb\n            ? localize('location.kb', \"Symbol {0} of {1}, {2} for next\", this._currentIdx + 1, this._currentModel.references.length, kb.getLabel())\n            : localize('location', \"Symbol {0} of {1}\", this._currentIdx + 1, this._currentModel.references.length);\n        this._currentMessage = this._notificationService.status(message);\n    }\n};\nSymbolNavigationService = __decorate([\n    __param(0, IContextKeyService),\n    __param(1, ICodeEditorService),\n    __param(2, INotificationService),\n    __param(3, IKeybindingService)\n], SymbolNavigationService);\nregisterSingleton(ISymbolNavigationService, SymbolNavigationService, 1 /* InstantiationType.Delayed */);\nregisterEditorCommand(new class extends EditorCommand {\n    constructor() {\n        super({\n            id: 'editor.gotoNextSymbolFromResult',\n            precondition: ctxHasSymbols,\n            kbOpts: {\n                weight: 100 /* KeybindingWeight.EditorContrib */,\n                primary: 70 /* KeyCode.F12 */\n            }\n        });\n    }\n    runEditorCommand(accessor, editor) {\n        return accessor.get(ISymbolNavigationService).revealNext(editor);\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'editor.gotoNextSymbolFromResult.cancel',\n    weight: 100 /* KeybindingWeight.EditorContrib */,\n    when: ctxHasSymbols,\n    primary: 9 /* KeyCode.Escape */,\n    handler(accessor) {\n        accessor.get(ISymbolNavigationService).reset();\n    }\n});\n//\nlet EditorState = class EditorState {\n    constructor(editorService) {\n        this._listener = new Map();\n        this._disposables = new DisposableStore();\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        this._disposables.add(editorService.onCodeEditorRemove(this._onDidRemoveEditor, this));\n        this._disposables.add(editorService.onCodeEditorAdd(this._onDidAddEditor, this));\n        editorService.listCodeEditors().forEach(this._onDidAddEditor, this);\n    }\n    dispose() {\n        this._disposables.dispose();\n        this._onDidChange.dispose();\n        dispose(this._listener.values());\n    }\n    _onDidAddEditor(editor) {\n        this._listener.set(editor, combinedDisposable(editor.onDidChangeCursorPosition(_ => this._onDidChange.fire({ editor })), editor.onDidChangeModelContent(_ => this._onDidChange.fire({ editor }))));\n    }\n    _onDidRemoveEditor(editor) {\n        var _a;\n        (_a = this._listener.get(editor)) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._listener.delete(editor);\n    }\n};\nEditorState = __decorate([\n    __param(0, ICodeEditorService)\n], EditorState);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar _a, _b, _c, _d, _e, _f, _g, _h;\nimport { isStandalone } from '../../../../base/browser/browser.js';\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { createCancelablePromise, raceCancellation } from '../../../../base/common/async.js';\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { isWeb } from '../../../../base/common/platform.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { EditorStateCancellationTokenSource } from '../../editorState/browser/editorState.js';\nimport { isCodeEditor } from '../../../browser/editorBrowser.js';\nimport { EditorAction2 } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/embeddedCodeEditorWidget.js';\nimport * as corePosition from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { isLocationLink } from '../../../common/languages.js';\nimport { ReferencesController } from './peek/referencesController.js';\nimport { ReferencesModel } from './referencesModel.js';\nimport { ISymbolNavigationService } from './symbolNavigation.js';\nimport { MessageController } from '../../message/browser/messageController.js';\nimport { PeekContext } from '../../peekView/browser/peekView.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId, MenuRegistry, registerAction2 } from '../../../../platform/actions/common/actions.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { IEditorProgressService } from '../../../../platform/progress/common/progress.js';\nimport { getDeclarationsAtPosition, getDefinitionsAtPosition, getImplementationsAtPosition, getReferencesAtPosition, getTypeDefinitionsAtPosition } from './goToSymbol.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { Iterable } from '../../../../base/common/iterator.js';\nMenuRegistry.appendMenuItem(MenuId.EditorContext, {\n    submenu: MenuId.EditorContextPeek,\n    title: nls.localize('peek.submenu', \"Peek\"),\n    group: 'navigation',\n    order: 100\n});\nexport class SymbolNavigationAnchor {\n    static is(thing) {\n        if (!thing || typeof thing !== 'object') {\n            return false;\n        }\n        if (thing instanceof SymbolNavigationAnchor) {\n            return true;\n        }\n        if (corePosition.Position.isIPosition(thing.position) && thing.model) {\n            return true;\n        }\n        return false;\n    }\n    constructor(model, position) {\n        this.model = model;\n        this.position = position;\n    }\n}\nexport class SymbolNavigationAction extends EditorAction2 {\n    static all() {\n        return SymbolNavigationAction._allSymbolNavigationCommands.values();\n    }\n    static _patchConfig(opts) {\n        const result = Object.assign(Object.assign({}, opts), { f1: true });\n        // patch context menu when clause\n        if (result.menu) {\n            for (const item of Iterable.wrap(result.menu)) {\n                if (item.id === MenuId.EditorContext || item.id === MenuId.EditorContextPeek) {\n                    item.when = ContextKeyExpr.and(opts.precondition, item.when);\n                }\n            }\n        }\n        return result;\n    }\n    constructor(configuration, opts) {\n        super(SymbolNavigationAction._patchConfig(opts));\n        this.configuration = configuration;\n        SymbolNavigationAction._allSymbolNavigationCommands.set(opts.id, this);\n    }\n    runEditorCommand(accessor, editor, arg, range) {\n        if (!editor.hasModel()) {\n            return Promise.resolve(undefined);\n        }\n        const notificationService = accessor.get(INotificationService);\n        const editorService = accessor.get(ICodeEditorService);\n        const progressService = accessor.get(IEditorProgressService);\n        const symbolNavService = accessor.get(ISymbolNavigationService);\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const instaService = accessor.get(IInstantiationService);\n        const model = editor.getModel();\n        const position = editor.getPosition();\n        const anchor = SymbolNavigationAnchor.is(arg) ? arg : new SymbolNavigationAnchor(model, position);\n        const cts = new EditorStateCancellationTokenSource(editor, 1 /* CodeEditorStateFlag.Value */ | 4 /* CodeEditorStateFlag.Position */);\n        const promise = raceCancellation(this._getLocationModel(languageFeaturesService, anchor.model, anchor.position, cts.token), cts.token).then((references) => __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            if (!references || cts.token.isCancellationRequested) {\n                return;\n            }\n            alert(references.ariaMessage);\n            let altAction;\n            if (references.referenceAt(model.uri, position)) {\n                const altActionId = this._getAlternativeCommand(editor);\n                if (!SymbolNavigationAction._activeAlternativeCommands.has(altActionId) && SymbolNavigationAction._allSymbolNavigationCommands.has(altActionId)) {\n                    altAction = SymbolNavigationAction._allSymbolNavigationCommands.get(altActionId);\n                }\n            }\n            const referenceCount = references.references.length;\n            if (referenceCount === 0) {\n                // no result -> show message\n                if (!this.configuration.muteMessage) {\n                    const info = model.getWordAtPosition(position);\n                    (_a = MessageController.get(editor)) === null || _a === void 0 ? void 0 : _a.showMessage(this._getNoResultFoundMessage(info), position);\n                }\n            }\n            else if (referenceCount === 1 && altAction) {\n                // already at the only result, run alternative\n                SymbolNavigationAction._activeAlternativeCommands.add(this.desc.id);\n                instaService.invokeFunction((accessor) => altAction.runEditorCommand(accessor, editor, arg, range).finally(() => {\n                    SymbolNavigationAction._activeAlternativeCommands.delete(this.desc.id);\n                }));\n            }\n            else {\n                // normal results handling\n                return this._onResult(editorService, symbolNavService, editor, references, range);\n            }\n        }), (err) => {\n            // report an error\n            notificationService.error(err);\n        }).finally(() => {\n            cts.dispose();\n        });\n        progressService.showWhile(promise, 250);\n        return promise;\n    }\n    _onResult(editorService, symbolNavService, editor, model, range) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const gotoLocation = this._getGoToPreference(editor);\n            if (!(editor instanceof EmbeddedCodeEditorWidget) && (this.configuration.openInPeek || (gotoLocation === 'peek' && model.references.length > 1))) {\n                this._openInPeek(editor, model, range);\n            }\n            else {\n                const next = model.firstReference();\n                const peek = model.references.length > 1 && gotoLocation === 'gotoAndPeek';\n                const targetEditor = yield this._openReference(editor, editorService, next, this.configuration.openToSide, !peek);\n                if (peek && targetEditor) {\n                    this._openInPeek(targetEditor, model, range);\n                }\n                else {\n                    model.dispose();\n                }\n                // keep remaining locations around when using\n                // 'goto'-mode\n                if (gotoLocation === 'goto') {\n                    symbolNavService.put(next);\n                }\n            }\n        });\n    }\n    _openReference(editor, editorService, reference, sideBySide, highlight) {\n        return __awaiter(this, void 0, void 0, function* () {\n            // range is the target-selection-range when we have one\n            // and the fallback is the 'full' range\n            let range = undefined;\n            if (isLocationLink(reference)) {\n                range = reference.targetSelectionRange;\n            }\n            if (!range) {\n                range = reference.range;\n            }\n            if (!range) {\n                return undefined;\n            }\n            const targetEditor = yield editorService.openCodeEditor({\n                resource: reference.uri,\n                options: {\n                    selection: Range.collapseToStart(range),\n                    selectionRevealType: 3 /* TextEditorSelectionRevealType.NearTopIfOutsideViewport */,\n                    selectionSource: \"code.jump\" /* TextEditorSelectionSource.JUMP */\n                }\n            }, editor, sideBySide);\n            if (!targetEditor) {\n                return undefined;\n            }\n            if (highlight) {\n                const modelNow = targetEditor.getModel();\n                const decorations = targetEditor.createDecorationsCollection([{ range, options: { description: 'symbol-navigate-action-highlight', className: 'symbolHighlight' } }]);\n                setTimeout(() => {\n                    if (targetEditor.getModel() === modelNow) {\n                        decorations.clear();\n                    }\n                }, 350);\n            }\n            return targetEditor;\n        });\n    }\n    _openInPeek(target, model, range) {\n        const controller = ReferencesController.get(target);\n        if (controller && target.hasModel()) {\n            controller.toggleWidget(range !== null && range !== void 0 ? range : target.getSelection(), createCancelablePromise(_ => Promise.resolve(model)), this.configuration.openInPeek);\n        }\n        else {\n            model.dispose();\n        }\n    }\n}\nSymbolNavigationAction._allSymbolNavigationCommands = new Map();\nSymbolNavigationAction._activeAlternativeCommands = new Set();\n//#region --- DEFINITION\nexport class DefinitionAction extends SymbolNavigationAction {\n    _getLocationModel(languageFeaturesService, model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getDefinitionsAtPosition(languageFeaturesService.definitionProvider, model, position, token), nls.localize('def.title', 'Definitions'));\n        });\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('noResultWord', \"No definition found for '{0}'\", info.word)\n            : nls.localize('generic.noResults', \"No definition found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(56 /* EditorOption.gotoLocation */).alternativeDefinitionCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(56 /* EditorOption.gotoLocation */).multipleDefinitions;\n    }\n}\nconst goToDefinitionKb = isWeb && !isStandalone()\n    ? 2048 /* KeyMod.CtrlCmd */ | 70 /* KeyCode.F12 */\n    : 70 /* KeyCode.F12 */;\nregisterAction2((_a = class GoToDefinitionAction extends DefinitionAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: GoToDefinitionAction.id,\n                title: {\n                    value: nls.localize('actions.goToDecl.label', \"Go to Definition\"),\n                    original: 'Go to Definition',\n                    mnemonicTitle: nls.localize({ key: 'miGotoDefinition', comment: ['&& denotes a mnemonic'] }, \"Go to &&Definition\")\n                },\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                keybinding: {\n                    when: EditorContextKeys.editorTextFocus,\n                    primary: goToDefinitionKb,\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                },\n                menu: [{\n                        id: MenuId.EditorContext,\n                        group: 'navigation',\n                        order: 1.1\n                    }, {\n                        id: MenuId.MenubarGoMenu,\n                        precondition: null,\n                        group: '4_symbol_nav',\n                        order: 2,\n                    }]\n            });\n            CommandsRegistry.registerCommandAlias('editor.action.goToDeclaration', GoToDefinitionAction.id);\n        }\n    },\n    _a.id = 'editor.action.revealDefinition',\n    _a));\nregisterAction2((_b = class OpenDefinitionToSideAction extends DefinitionAction {\n        constructor() {\n            super({\n                openToSide: true,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: OpenDefinitionToSideAction.id,\n                title: {\n                    value: nls.localize('actions.goToDeclToSide.label', \"Open Definition to the Side\"),\n                    original: 'Open Definition to the Side'\n                },\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                keybinding: {\n                    when: EditorContextKeys.editorTextFocus,\n                    primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, goToDefinitionKb),\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                }\n            });\n            CommandsRegistry.registerCommandAlias('editor.action.openDeclarationToTheSide', OpenDefinitionToSideAction.id);\n        }\n    },\n    _b.id = 'editor.action.revealDefinitionAside',\n    _b));\nregisterAction2((_c = class PeekDefinitionAction extends DefinitionAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: true,\n                muteMessage: false\n            }, {\n                id: PeekDefinitionAction.id,\n                title: {\n                    value: nls.localize('actions.previewDecl.label', \"Peek Definition\"),\n                    original: 'Peek Definition'\n                },\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                keybinding: {\n                    when: EditorContextKeys.editorTextFocus,\n                    primary: 512 /* KeyMod.Alt */ | 70 /* KeyCode.F12 */,\n                    linux: { primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 68 /* KeyCode.F10 */ },\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                },\n                menu: {\n                    id: MenuId.EditorContextPeek,\n                    group: 'peek',\n                    order: 2\n                }\n            });\n            CommandsRegistry.registerCommandAlias('editor.action.previewDeclaration', PeekDefinitionAction.id);\n        }\n    },\n    _c.id = 'editor.action.peekDefinition',\n    _c));\n//#endregion\n//#region --- DECLARATION\nclass DeclarationAction extends SymbolNavigationAction {\n    _getLocationModel(languageFeaturesService, model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getDeclarationsAtPosition(languageFeaturesService.declarationProvider, model, position, token), nls.localize('decl.title', 'Declarations'));\n        });\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('decl.noResultWord', \"No declaration found for '{0}'\", info.word)\n            : nls.localize('decl.generic.noResults', \"No declaration found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(56 /* EditorOption.gotoLocation */).alternativeDeclarationCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(56 /* EditorOption.gotoLocation */).multipleDeclarations;\n    }\n}\nregisterAction2((_d = class GoToDeclarationAction extends DeclarationAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: GoToDeclarationAction.id,\n                title: {\n                    value: nls.localize('actions.goToDeclaration.label', \"Go to Declaration\"),\n                    original: 'Go to Declaration',\n                    mnemonicTitle: nls.localize({ key: 'miGotoDeclaration', comment: ['&& denotes a mnemonic'] }, \"Go to &&Declaration\")\n                },\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDeclarationProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                menu: [{\n                        id: MenuId.EditorContext,\n                        group: 'navigation',\n                        order: 1.3\n                    }, {\n                        id: MenuId.MenubarGoMenu,\n                        precondition: null,\n                        group: '4_symbol_nav',\n                        order: 3,\n                    }],\n            });\n        }\n        _getNoResultFoundMessage(info) {\n            return info && info.word\n                ? nls.localize('decl.noResultWord', \"No declaration found for '{0}'\", info.word)\n                : nls.localize('decl.generic.noResults', \"No declaration found\");\n        }\n    },\n    _d.id = 'editor.action.revealDeclaration',\n    _d));\nregisterAction2(class PeekDeclarationAction extends DeclarationAction {\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: true,\n            muteMessage: false\n        }, {\n            id: 'editor.action.peekDeclaration',\n            title: {\n                value: nls.localize('actions.peekDecl.label', \"Peek Declaration\"),\n                original: 'Peek Declaration'\n            },\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasDeclarationProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n            menu: {\n                id: MenuId.EditorContextPeek,\n                group: 'peek',\n                order: 3\n            }\n        });\n    }\n});\n//#endregion\n//#region --- TYPE DEFINITION\nclass TypeDefinitionAction extends SymbolNavigationAction {\n    _getLocationModel(languageFeaturesService, model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getTypeDefinitionsAtPosition(languageFeaturesService.typeDefinitionProvider, model, position, token), nls.localize('typedef.title', 'Type Definitions'));\n        });\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('goToTypeDefinition.noResultWord', \"No type definition found for '{0}'\", info.word)\n            : nls.localize('goToTypeDefinition.generic.noResults', \"No type definition found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(56 /* EditorOption.gotoLocation */).alternativeTypeDefinitionCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(56 /* EditorOption.gotoLocation */).multipleTypeDefinitions;\n    }\n}\nregisterAction2((_e = class GoToTypeDefinitionAction extends TypeDefinitionAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: GoToTypeDefinitionAction.ID,\n                title: {\n                    value: nls.localize('actions.goToTypeDefinition.label', \"Go to Type Definition\"),\n                    original: 'Go to Type Definition',\n                    mnemonicTitle: nls.localize({ key: 'miGotoTypeDefinition', comment: ['&& denotes a mnemonic'] }, \"Go to &&Type Definition\")\n                },\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasTypeDefinitionProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                keybinding: {\n                    when: EditorContextKeys.editorTextFocus,\n                    primary: 0,\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                },\n                menu: [{\n                        id: MenuId.EditorContext,\n                        group: 'navigation',\n                        order: 1.4\n                    }, {\n                        id: MenuId.MenubarGoMenu,\n                        precondition: null,\n                        group: '4_symbol_nav',\n                        order: 3,\n                    }]\n            });\n        }\n    },\n    _e.ID = 'editor.action.goToTypeDefinition',\n    _e));\nregisterAction2((_f = class PeekTypeDefinitionAction extends TypeDefinitionAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: true,\n                muteMessage: false\n            }, {\n                id: PeekTypeDefinitionAction.ID,\n                title: {\n                    value: nls.localize('actions.peekTypeDefinition.label', \"Peek Type Definition\"),\n                    original: 'Peek Type Definition'\n                },\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasTypeDefinitionProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                menu: {\n                    id: MenuId.EditorContextPeek,\n                    group: 'peek',\n                    order: 4\n                }\n            });\n        }\n    },\n    _f.ID = 'editor.action.peekTypeDefinition',\n    _f));\n//#endregion\n//#region --- IMPLEMENTATION\nclass ImplementationAction extends SymbolNavigationAction {\n    _getLocationModel(languageFeaturesService, model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getImplementationsAtPosition(languageFeaturesService.implementationProvider, model, position, token), nls.localize('impl.title', 'Implementations'));\n        });\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('goToImplementation.noResultWord', \"No implementation found for '{0}'\", info.word)\n            : nls.localize('goToImplementation.generic.noResults', \"No implementation found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(56 /* EditorOption.gotoLocation */).alternativeImplementationCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(56 /* EditorOption.gotoLocation */).multipleImplementations;\n    }\n}\nregisterAction2((_g = class GoToImplementationAction extends ImplementationAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: GoToImplementationAction.ID,\n                title: {\n                    value: nls.localize('actions.goToImplementation.label', \"Go to Implementations\"),\n                    original: 'Go to Implementations',\n                    mnemonicTitle: nls.localize({ key: 'miGotoImplementation', comment: ['&& denotes a mnemonic'] }, \"Go to &&Implementations\")\n                },\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasImplementationProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                keybinding: {\n                    when: EditorContextKeys.editorTextFocus,\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 70 /* KeyCode.F12 */,\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                },\n                menu: [{\n                        id: MenuId.EditorContext,\n                        group: 'navigation',\n                        order: 1.45\n                    }, {\n                        id: MenuId.MenubarGoMenu,\n                        precondition: null,\n                        group: '4_symbol_nav',\n                        order: 4,\n                    }]\n            });\n        }\n    },\n    _g.ID = 'editor.action.goToImplementation',\n    _g));\nregisterAction2((_h = class PeekImplementationAction extends ImplementationAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: true,\n                muteMessage: false\n            }, {\n                id: PeekImplementationAction.ID,\n                title: {\n                    value: nls.localize('actions.peekImplementation.label', \"Peek Implementations\"),\n                    original: 'Peek Implementations'\n                },\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasImplementationProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                keybinding: {\n                    when: EditorContextKeys.editorTextFocus,\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 70 /* KeyCode.F12 */,\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                },\n                menu: {\n                    id: MenuId.EditorContextPeek,\n                    group: 'peek',\n                    order: 5\n                }\n            });\n        }\n    },\n    _h.ID = 'editor.action.peekImplementation',\n    _h));\n//#endregion\n//#region --- REFERENCES\nclass ReferencesAction extends SymbolNavigationAction {\n    _getNoResultFoundMessage(info) {\n        return info\n            ? nls.localize('references.no', \"No references found for '{0}'\", info.word)\n            : nls.localize('references.noGeneric', \"No references found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(56 /* EditorOption.gotoLocation */).alternativeReferenceCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(56 /* EditorOption.gotoLocation */).multipleReferences;\n    }\n}\nregisterAction2(class GoToReferencesAction extends ReferencesAction {\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: false,\n            muteMessage: false\n        }, {\n            id: 'editor.action.goToReferences',\n            title: {\n                value: nls.localize('goToReferences.label', \"Go to References\"),\n                original: 'Go to References',\n                mnemonicTitle: nls.localize({ key: 'miGotoReference', comment: ['&& denotes a mnemonic'] }, \"Go to &&References\")\n            },\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasReferenceProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n            keybinding: {\n                when: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 70 /* KeyCode.F12 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menu: [{\n                    id: MenuId.EditorContext,\n                    group: 'navigation',\n                    order: 1.45\n                }, {\n                    id: MenuId.MenubarGoMenu,\n                    precondition: null,\n                    group: '4_symbol_nav',\n                    order: 5,\n                }]\n        });\n    }\n    _getLocationModel(languageFeaturesService, model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getReferencesAtPosition(languageFeaturesService.referenceProvider, model, position, true, token), nls.localize('ref.title', 'References'));\n        });\n    }\n});\nregisterAction2(class PeekReferencesAction extends ReferencesAction {\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: true,\n            muteMessage: false\n        }, {\n            id: 'editor.action.referenceSearch.trigger',\n            title: {\n                value: nls.localize('references.action.label', \"Peek References\"),\n                original: 'Peek References'\n            },\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasReferenceProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n            menu: {\n                id: MenuId.EditorContextPeek,\n                group: 'peek',\n                order: 6\n            }\n        });\n    }\n    _getLocationModel(languageFeaturesService, model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getReferencesAtPosition(languageFeaturesService.referenceProvider, model, position, false, token), nls.localize('ref.title', 'References'));\n        });\n    }\n});\n//#endregion\n//#region --- GENERIC goto symbols command\nclass GenericGoToLocationAction extends SymbolNavigationAction {\n    constructor(config, _references, _gotoMultipleBehaviour) {\n        super(config, {\n            id: 'editor.action.goToLocation',\n            title: {\n                value: nls.localize('label.generic', \"Go to Any Symbol\"),\n                original: 'Go to Any Symbol'\n            },\n            precondition: ContextKeyExpr.and(PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n        });\n        this._references = _references;\n        this._gotoMultipleBehaviour = _gotoMultipleBehaviour;\n    }\n    _getLocationModel(languageFeaturesService, _model, _position, _token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(this._references, nls.localize('generic.title', 'Locations'));\n        });\n    }\n    _getNoResultFoundMessage(info) {\n        return info && nls.localize('generic.noResult', \"No results for '{0}'\", info.word) || '';\n    }\n    _getGoToPreference(editor) {\n        var _a;\n        return (_a = this._gotoMultipleBehaviour) !== null && _a !== void 0 ? _a : editor.getOption(56 /* EditorOption.gotoLocation */).multipleReferences;\n    }\n    _getAlternativeCommand() { return ''; }\n}\nCommandsRegistry.registerCommand({\n    id: 'editor.action.goToLocations',\n    description: {\n        description: 'Go to locations from a position in a file',\n        args: [\n            { name: 'uri', description: 'The text document in which to start', constraint: URI },\n            { name: 'position', description: 'The position at which to start', constraint: corePosition.Position.isIPosition },\n            { name: 'locations', description: 'An array of locations.', constraint: Array },\n            { name: 'multiple', description: 'Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto' },\n            { name: 'noResultsMessage', description: 'Human readable message that shows when locations is empty.' },\n        ]\n    },\n    handler: (accessor, resource, position, references, multiple, noResultsMessage, openInPeek) => __awaiter(void 0, void 0, void 0, function* () {\n        assertType(URI.isUri(resource));\n        assertType(corePosition.Position.isIPosition(position));\n        assertType(Array.isArray(references));\n        assertType(typeof multiple === 'undefined' || typeof multiple === 'string');\n        assertType(typeof openInPeek === 'undefined' || typeof openInPeek === 'boolean');\n        const editorService = accessor.get(ICodeEditorService);\n        const editor = yield editorService.openCodeEditor({ resource }, editorService.getFocusedCodeEditor());\n        if (isCodeEditor(editor)) {\n            editor.setPosition(position);\n            editor.revealPositionInCenterIfOutsideViewport(position, 0 /* ScrollType.Smooth */);\n            return editor.invokeWithinContext(accessor => {\n                const command = new class extends GenericGoToLocationAction {\n                    _getNoResultFoundMessage(info) {\n                        return noResultsMessage || super._getNoResultFoundMessage(info);\n                    }\n                }({\n                    muteMessage: !Boolean(noResultsMessage),\n                    openInPeek: Boolean(openInPeek),\n                    openToSide: false\n                }, references, multiple);\n                accessor.get(IInstantiationService).invokeFunction(command.run.bind(command), editor);\n            });\n        }\n    })\n});\nCommandsRegistry.registerCommand({\n    id: 'editor.action.peekLocations',\n    description: {\n        description: 'Peek locations from a position in a file',\n        args: [\n            { name: 'uri', description: 'The text document in which to start', constraint: URI },\n            { name: 'position', description: 'The position at which to start', constraint: corePosition.Position.isIPosition },\n            { name: 'locations', description: 'An array of locations.', constraint: Array },\n            { name: 'multiple', description: 'Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto' },\n        ]\n    },\n    handler: (accessor, resource, position, references, multiple) => __awaiter(void 0, void 0, void 0, function* () {\n        accessor.get(ICommandService).executeCommand('editor.action.goToLocations', resource, position, references, multiple, undefined, true);\n    })\n});\n//#endregion\n//#region --- REFERENCE search special commands\nCommandsRegistry.registerCommand({\n    id: 'editor.action.findReferences',\n    handler: (accessor, resource, position) => {\n        assertType(URI.isUri(resource));\n        assertType(corePosition.Position.isIPosition(position));\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const codeEditorService = accessor.get(ICodeEditorService);\n        return codeEditorService.openCodeEditor({ resource }, codeEditorService.getFocusedCodeEditor()).then(control => {\n            if (!isCodeEditor(control) || !control.hasModel()) {\n                return undefined;\n            }\n            const controller = ReferencesController.get(control);\n            if (!controller) {\n                return undefined;\n            }\n            const references = createCancelablePromise(token => getReferencesAtPosition(languageFeaturesService.referenceProvider, control.getModel(), corePosition.Position.lift(position), false, token).then(references => new ReferencesModel(references, nls.localize('ref.title', 'References'))));\n            const range = new Range(position.lineNumber, position.column, position.lineNumber, position.column);\n            return Promise.resolve(controller.toggleWidget(range, references, false));\n        });\n    }\n});\n// use NEW command\nCommandsRegistry.registerCommandAlias('editor.action.showReferences', 'editor.action.peekLocations');\n//#endregion\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { coalesce } from '../../../../base/common/arrays.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { registerModelAndPositionCommand } from '../../../browser/editorExtensions.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ReferencesModel } from './referencesModel.js';\nfunction getLocationLinks(model, position, registry, provide) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const provider = registry.ordered(model);\n        // get results\n        const promises = provider.map((provider) => {\n            return Promise.resolve(provide(provider, model, position)).then(undefined, err => {\n                onUnexpectedExternalError(err);\n                return undefined;\n            });\n        });\n        const values = yield Promise.all(promises);\n        return coalesce(values.flat());\n    });\n}\nexport function getDefinitionsAtPosition(registry, model, position, token) {\n    return getLocationLinks(model, position, registry, (provider, model, position) => {\n        return provider.provideDefinition(model, position, token);\n    });\n}\nexport function getDeclarationsAtPosition(registry, model, position, token) {\n    return getLocationLinks(model, position, registry, (provider, model, position) => {\n        return provider.provideDeclaration(model, position, token);\n    });\n}\nexport function getImplementationsAtPosition(registry, model, position, token) {\n    return getLocationLinks(model, position, registry, (provider, model, position) => {\n        return provider.provideImplementation(model, position, token);\n    });\n}\nexport function getTypeDefinitionsAtPosition(registry, model, position, token) {\n    return getLocationLinks(model, position, registry, (provider, model, position) => {\n        return provider.provideTypeDefinition(model, position, token);\n    });\n}\nexport function getReferencesAtPosition(registry, model, position, compact, token) {\n    return getLocationLinks(model, position, registry, (provider, model, position) => __awaiter(this, void 0, void 0, function* () {\n        const result = yield provider.provideReferences(model, position, { includeDeclaration: true }, token);\n        if (!compact || !result || result.length !== 2) {\n            return result;\n        }\n        const resultWithoutDeclaration = yield provider.provideReferences(model, position, { includeDeclaration: false }, token);\n        if (resultWithoutDeclaration && resultWithoutDeclaration.length === 1) {\n            return resultWithoutDeclaration;\n        }\n        return result;\n    }));\n}\n// -- API commands ----\nfunction _sortedAndDeduped(callback) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const rawLinks = yield callback();\n        const model = new ReferencesModel(rawLinks, '');\n        const modelLinks = model.references.map(ref => ref.link);\n        model.dispose();\n        return modelLinks;\n    });\n}\nregisterModelAndPositionCommand('_executeDefinitionProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getDefinitionsAtPosition(languageFeaturesService.definitionProvider, model, position, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeTypeDefinitionProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getTypeDefinitionsAtPosition(languageFeaturesService.typeDefinitionProvider, model, position, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeDeclarationProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getDeclarationsAtPosition(languageFeaturesService.declarationProvider, model, position, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeReferenceProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getReferencesAtPosition(languageFeaturesService.referenceProvider, model, position, false, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeImplementationProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getImplementationsAtPosition(languageFeaturesService.implementationProvider, model, position, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Emitter } from '../../../../../base/common/event.js';\nimport { Disposable } from '../../../../../base/common/lifecycle.js';\nimport * as platform from '../../../../../base/common/platform.js';\nfunction hasModifier(e, modifier) {\n    return !!e[modifier];\n}\n/**\n * An event that encapsulates the various trigger modifiers logic needed for go to definition.\n */\nexport class ClickLinkMouseEvent {\n    constructor(source, opts) {\n        this.target = source.target;\n        this.isLeftClick = source.event.leftButton;\n        this.isMiddleClick = source.event.middleButton;\n        this.isRightClick = source.event.rightButton;\n        this.hasTriggerModifier = hasModifier(source.event, opts.triggerModifier);\n        this.hasSideBySideModifier = hasModifier(source.event, opts.triggerSideBySideModifier);\n        this.isNoneOrSingleMouseDown = (source.event.detail <= 1);\n    }\n}\n/**\n * An event that encapsulates the various trigger modifiers logic needed for go to definition.\n */\nexport class ClickLinkKeyboardEvent {\n    constructor(source, opts) {\n        this.keyCodeIsTriggerKey = (source.keyCode === opts.triggerKey);\n        this.keyCodeIsSideBySideKey = (source.keyCode === opts.triggerSideBySideKey);\n        this.hasTriggerModifier = hasModifier(source, opts.triggerModifier);\n    }\n}\nexport class ClickLinkOptions {\n    constructor(triggerKey, triggerModifier, triggerSideBySideKey, triggerSideBySideModifier) {\n        this.triggerKey = triggerKey;\n        this.triggerModifier = triggerModifier;\n        this.triggerSideBySideKey = triggerSideBySideKey;\n        this.triggerSideBySideModifier = triggerSideBySideModifier;\n    }\n    equals(other) {\n        return (this.triggerKey === other.triggerKey\n            && this.triggerModifier === other.triggerModifier\n            && this.triggerSideBySideKey === other.triggerSideBySideKey\n            && this.triggerSideBySideModifier === other.triggerSideBySideModifier);\n    }\n}\nfunction createOptions(multiCursorModifier) {\n    if (multiCursorModifier === 'altKey') {\n        if (platform.isMacintosh) {\n            return new ClickLinkOptions(57 /* KeyCode.Meta */, 'metaKey', 6 /* KeyCode.Alt */, 'altKey');\n        }\n        return new ClickLinkOptions(5 /* KeyCode.Ctrl */, 'ctrlKey', 6 /* KeyCode.Alt */, 'altKey');\n    }\n    if (platform.isMacintosh) {\n        return new ClickLinkOptions(6 /* KeyCode.Alt */, 'altKey', 57 /* KeyCode.Meta */, 'metaKey');\n    }\n    return new ClickLinkOptions(6 /* KeyCode.Alt */, 'altKey', 5 /* KeyCode.Ctrl */, 'ctrlKey');\n}\nexport class ClickLinkGesture extends Disposable {\n    constructor(editor, alwaysFireOnMouseUp) {\n        super();\n        this._onMouseMoveOrRelevantKeyDown = this._register(new Emitter());\n        this.onMouseMoveOrRelevantKeyDown = this._onMouseMoveOrRelevantKeyDown.event;\n        this._onExecute = this._register(new Emitter());\n        this.onExecute = this._onExecute.event;\n        this._onCancel = this._register(new Emitter());\n        this.onCancel = this._onCancel.event;\n        this._editor = editor;\n        this._alwaysFireExecuteOnMouseUp = alwaysFireOnMouseUp;\n        this._opts = createOptions(this._editor.getOption(75 /* EditorOption.multiCursorModifier */));\n        this._lastMouseMoveEvent = null;\n        this._hasTriggerKeyOnMouseDown = false;\n        this._lineNumberOnMouseDown = 0;\n        this._register(this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(75 /* EditorOption.multiCursorModifier */)) {\n                const newOpts = createOptions(this._editor.getOption(75 /* EditorOption.multiCursorModifier */));\n                if (this._opts.equals(newOpts)) {\n                    return;\n                }\n                this._opts = newOpts;\n                this._lastMouseMoveEvent = null;\n                this._hasTriggerKeyOnMouseDown = false;\n                this._lineNumberOnMouseDown = 0;\n                this._onCancel.fire();\n            }\n        }));\n        this._register(this._editor.onMouseMove((e) => this._onEditorMouseMove(new ClickLinkMouseEvent(e, this._opts))));\n        this._register(this._editor.onMouseDown((e) => this._onEditorMouseDown(new ClickLinkMouseEvent(e, this._opts))));\n        this._register(this._editor.onMouseUp((e) => this._onEditorMouseUp(new ClickLinkMouseEvent(e, this._opts))));\n        this._register(this._editor.onKeyDown((e) => this._onEditorKeyDown(new ClickLinkKeyboardEvent(e, this._opts))));\n        this._register(this._editor.onKeyUp((e) => this._onEditorKeyUp(new ClickLinkKeyboardEvent(e, this._opts))));\n        this._register(this._editor.onMouseDrag(() => this._resetHandler()));\n        this._register(this._editor.onDidChangeCursorSelection((e) => this._onDidChangeCursorSelection(e)));\n        this._register(this._editor.onDidChangeModel((e) => this._resetHandler()));\n        this._register(this._editor.onDidChangeModelContent(() => this._resetHandler()));\n        this._register(this._editor.onDidScrollChange((e) => {\n            if (e.scrollTopChanged || e.scrollLeftChanged) {\n                this._resetHandler();\n            }\n        }));\n    }\n    _onDidChangeCursorSelection(e) {\n        if (e.selection && e.selection.startColumn !== e.selection.endColumn) {\n            this._resetHandler(); // immediately stop this feature if the user starts to select (https://github.com/microsoft/vscode/issues/7827)\n        }\n    }\n    _onEditorMouseMove(mouseEvent) {\n        this._lastMouseMoveEvent = mouseEvent;\n        this._onMouseMoveOrRelevantKeyDown.fire([mouseEvent, null]);\n    }\n    _onEditorMouseDown(mouseEvent) {\n        // We need to record if we had the trigger key on mouse down because someone might select something in the editor\n        // holding the mouse down and then while mouse is down start to press Ctrl/Cmd to start a copy operation and then\n        // release the mouse button without wanting to do the navigation.\n        // With this flag we prevent goto definition if the mouse was down before the trigger key was pressed.\n        this._hasTriggerKeyOnMouseDown = mouseEvent.hasTriggerModifier;\n        this._lineNumberOnMouseDown = mouseEvent.target.position ? mouseEvent.target.position.lineNumber : 0;\n    }\n    _onEditorMouseUp(mouseEvent) {\n        const currentLineNumber = mouseEvent.target.position ? mouseEvent.target.position.lineNumber : 0;\n        if (this._hasTriggerKeyOnMouseDown && this._lineNumberOnMouseDown && this._lineNumberOnMouseDown === currentLineNumber || this._alwaysFireExecuteOnMouseUp) {\n            this._onExecute.fire(mouseEvent);\n        }\n    }\n    _onEditorKeyDown(e) {\n        if (this._lastMouseMoveEvent\n            && (e.keyCodeIsTriggerKey // User just pressed Ctrl/Cmd (normal goto definition)\n                || (e.keyCodeIsSideBySideKey && e.hasTriggerModifier) // User pressed Ctrl/Cmd+Alt (goto definition to the side)\n            )) {\n            this._onMouseMoveOrRelevantKeyDown.fire([this._lastMouseMoveEvent, e]);\n        }\n        else if (e.hasTriggerModifier) {\n            this._onCancel.fire(); // remove decorations if user holds another key with ctrl/cmd to prevent accident goto declaration\n        }\n    }\n    _onEditorKeyUp(e) {\n        if (e.keyCodeIsTriggerKey) {\n            this._onCancel.fire();\n        }\n    }\n    _resetHandler() {\n        this._lastMouseMoveEvent = null;\n        this._hasTriggerKeyOnMouseDown = false;\n        this._onCancel.fire();\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { createCancelablePromise } from '../../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../../base/common/errors.js';\nimport { MarkdownString } from '../../../../../base/common/htmlContent.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { withNullAsUndefined } from '../../../../../base/common/types.js';\nimport './goToDefinitionAtPosition.css';\nimport { EditorState } from '../../../editorState/browser/editorState.js';\nimport { registerEditorContribution } from '../../../../browser/editorExtensions.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { ILanguageService } from '../../../../common/languages/language.js';\nimport { ITextModelService } from '../../../../common/services/resolverService.js';\nimport { ClickLinkGesture } from './clickLinkGesture.js';\nimport { PeekContext } from '../../../peekView/browser/peekView.js';\nimport * as nls from '../../../../../nls.js';\nimport { IContextKeyService } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { DefinitionAction } from '../goToCommands.js';\nimport { getDefinitionsAtPosition } from '../goToSymbol.js';\nimport { ILanguageFeaturesService } from '../../../../common/services/languageFeatures.js';\nimport { ModelDecorationInjectedTextOptions } from '../../../../common/model/textModel.js';\nexport let GotoDefinitionAtPositionEditorContribution = class GotoDefinitionAtPositionEditorContribution {\n    constructor(editor, textModelResolverService, languageService, languageFeaturesService) {\n        this.textModelResolverService = textModelResolverService;\n        this.languageService = languageService;\n        this.languageFeaturesService = languageFeaturesService;\n        this.toUnhook = new DisposableStore();\n        this.toUnhookForKeyboard = new DisposableStore();\n        this.currentWordAtPosition = null;\n        this.previousPromise = null;\n        this.editor = editor;\n        this.linkDecorations = this.editor.createDecorationsCollection();\n        const linkGesture = new ClickLinkGesture(editor);\n        this.toUnhook.add(linkGesture);\n        this.toUnhook.add(linkGesture.onMouseMoveOrRelevantKeyDown(([mouseEvent, keyboardEvent]) => {\n            this.startFindDefinitionFromMouse(mouseEvent, withNullAsUndefined(keyboardEvent));\n        }));\n        this.toUnhook.add(linkGesture.onExecute((mouseEvent) => {\n            if (this.isEnabled(mouseEvent)) {\n                this.gotoDefinition(mouseEvent.target.position, mouseEvent.hasSideBySideModifier)\n                    .catch((error) => {\n                    onUnexpectedError(error);\n                })\n                    .finally(() => {\n                    this.removeLinkDecorations();\n                });\n            }\n        }));\n        this.toUnhook.add(linkGesture.onCancel(() => {\n            this.removeLinkDecorations();\n            this.currentWordAtPosition = null;\n        }));\n    }\n    static get(editor) {\n        return editor.getContribution(GotoDefinitionAtPositionEditorContribution.ID);\n    }\n    startFindDefinitionFromCursor(position) {\n        return __awaiter(this, void 0, void 0, function* () {\n            // For issue: https://github.com/microsoft/vscode/issues/46257\n            // equivalent to mouse move with meta/ctrl key\n            // First find the definition and add decorations\n            // to the editor to be shown with the content hover widget\n            yield this.startFindDefinition(position);\n            // Add listeners for editor cursor move and key down events\n            // Dismiss the \"extended\" editor decorations when the user hides\n            // the hover widget. There is no event for the widget itself so these\n            // serve as a best effort. After removing the link decorations, the hover\n            // widget is clean and will only show declarations per next request.\n            this.toUnhookForKeyboard.add(this.editor.onDidChangeCursorPosition(() => {\n                this.currentWordAtPosition = null;\n                this.removeLinkDecorations();\n                this.toUnhookForKeyboard.clear();\n            }));\n            this.toUnhookForKeyboard.add(this.editor.onKeyDown((e) => {\n                if (e) {\n                    this.currentWordAtPosition = null;\n                    this.removeLinkDecorations();\n                    this.toUnhookForKeyboard.clear();\n                }\n            }));\n        });\n    }\n    startFindDefinitionFromMouse(mouseEvent, withKey) {\n        // check if we are active and on a content widget\n        if (mouseEvent.target.type === 9 /* MouseTargetType.CONTENT_WIDGET */ && this.linkDecorations.length > 0) {\n            return;\n        }\n        if (!this.editor.hasModel() || !this.isEnabled(mouseEvent, withKey)) {\n            this.currentWordAtPosition = null;\n            this.removeLinkDecorations();\n            return;\n        }\n        const position = mouseEvent.target.position;\n        this.startFindDefinition(position);\n    }\n    startFindDefinition(position) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            // Dispose listeners for updating decorations when using keyboard to show definition hover\n            this.toUnhookForKeyboard.clear();\n            // Find word at mouse position\n            const word = position ? (_a = this.editor.getModel()) === null || _a === void 0 ? void 0 : _a.getWordAtPosition(position) : null;\n            if (!word) {\n                this.currentWordAtPosition = null;\n                this.removeLinkDecorations();\n                return;\n            }\n            // Return early if word at position is still the same\n            if (this.currentWordAtPosition && this.currentWordAtPosition.startColumn === word.startColumn && this.currentWordAtPosition.endColumn === word.endColumn && this.currentWordAtPosition.word === word.word) {\n                return;\n            }\n            this.currentWordAtPosition = word;\n            // Find definition and decorate word if found\n            const state = new EditorState(this.editor, 4 /* CodeEditorStateFlag.Position */ | 1 /* CodeEditorStateFlag.Value */ | 2 /* CodeEditorStateFlag.Selection */ | 8 /* CodeEditorStateFlag.Scroll */);\n            if (this.previousPromise) {\n                this.previousPromise.cancel();\n                this.previousPromise = null;\n            }\n            this.previousPromise = createCancelablePromise(token => this.findDefinition(position, token));\n            let results;\n            try {\n                results = yield this.previousPromise;\n            }\n            catch (error) {\n                onUnexpectedError(error);\n                return;\n            }\n            if (!results || !results.length || !state.validate(this.editor)) {\n                this.removeLinkDecorations();\n                return;\n            }\n            const linkRange = results[0].originSelectionRange\n                ? Range.lift(results[0].originSelectionRange)\n                : new Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn);\n            // Multiple results\n            if (results.length > 1) {\n                let combinedRange = linkRange;\n                for (const { originSelectionRange } of results) {\n                    if (originSelectionRange) {\n                        combinedRange = Range.plusRange(combinedRange, originSelectionRange);\n                    }\n                }\n                this.addDecoration(combinedRange, new MarkdownString().appendText(nls.localize('multipleResults', \"Click to show {0} definitions.\", results.length)));\n            }\n            else {\n                // Single result\n                const result = results[0];\n                if (!result.uri) {\n                    return;\n                }\n                this.textModelResolverService.createModelReference(result.uri).then(ref => {\n                    if (!ref.object || !ref.object.textEditorModel) {\n                        ref.dispose();\n                        return;\n                    }\n                    const { object: { textEditorModel } } = ref;\n                    const { startLineNumber } = result.range;\n                    if (startLineNumber < 1 || startLineNumber > textEditorModel.getLineCount()) {\n                        // invalid range\n                        ref.dispose();\n                        return;\n                    }\n                    const previewValue = this.getPreviewValue(textEditorModel, startLineNumber, result);\n                    const languageId = this.languageService.guessLanguageIdByFilepathOrFirstLine(textEditorModel.uri);\n                    this.addDecoration(linkRange, previewValue ? new MarkdownString().appendCodeblock(languageId ? languageId : '', previewValue) : undefined);\n                    ref.dispose();\n                });\n            }\n        });\n    }\n    getPreviewValue(textEditorModel, startLineNumber, result) {\n        let rangeToUse = result.range;\n        const numberOfLinesInRange = rangeToUse.endLineNumber - rangeToUse.startLineNumber;\n        if (numberOfLinesInRange >= GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES) {\n            rangeToUse = this.getPreviewRangeBasedOnIndentation(textEditorModel, startLineNumber);\n        }\n        const previewValue = this.stripIndentationFromPreviewRange(textEditorModel, startLineNumber, rangeToUse);\n        return previewValue;\n    }\n    stripIndentationFromPreviewRange(textEditorModel, startLineNumber, previewRange) {\n        const startIndent = textEditorModel.getLineFirstNonWhitespaceColumn(startLineNumber);\n        let minIndent = startIndent;\n        for (let endLineNumber = startLineNumber + 1; endLineNumber < previewRange.endLineNumber; endLineNumber++) {\n            const endIndent = textEditorModel.getLineFirstNonWhitespaceColumn(endLineNumber);\n            minIndent = Math.min(minIndent, endIndent);\n        }\n        const previewValue = textEditorModel.getValueInRange(previewRange).replace(new RegExp(`^\\\\s{${minIndent - 1}}`, 'gm'), '').trim();\n        return previewValue;\n    }\n    getPreviewRangeBasedOnIndentation(textEditorModel, startLineNumber) {\n        const startIndent = textEditorModel.getLineFirstNonWhitespaceColumn(startLineNumber);\n        const maxLineNumber = Math.min(textEditorModel.getLineCount(), startLineNumber + GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES);\n        let endLineNumber = startLineNumber + 1;\n        for (; endLineNumber < maxLineNumber; endLineNumber++) {\n            const endIndent = textEditorModel.getLineFirstNonWhitespaceColumn(endLineNumber);\n            if (startIndent === endIndent) {\n                break;\n            }\n        }\n        return new Range(startLineNumber, 1, endLineNumber + 1, 1);\n    }\n    addDecoration(range, hoverMessage) {\n        const newDecorations = {\n            range: range,\n            options: {\n                description: 'goto-definition-link',\n                inlineClassName: 'goto-definition-link',\n                hoverMessage\n            }\n        };\n        this.linkDecorations.set([newDecorations]);\n    }\n    removeLinkDecorations() {\n        this.linkDecorations.clear();\n    }\n    isEnabled(mouseEvent, withKey) {\n        var _a;\n        return this.editor.hasModel()\n            && mouseEvent.isLeftClick\n            && mouseEvent.isNoneOrSingleMouseDown\n            && mouseEvent.target.type === 6 /* MouseTargetType.CONTENT_TEXT */\n            && !(((_a = mouseEvent.target.detail.injectedText) === null || _a === void 0 ? void 0 : _a.options) instanceof ModelDecorationInjectedTextOptions)\n            && (mouseEvent.hasTriggerModifier || (withKey ? withKey.keyCodeIsTriggerKey : false))\n            && this.languageFeaturesService.definitionProvider.has(this.editor.getModel());\n    }\n    findDefinition(position, token) {\n        const model = this.editor.getModel();\n        if (!model) {\n            return Promise.resolve(null);\n        }\n        return getDefinitionsAtPosition(this.languageFeaturesService.definitionProvider, model, position, token);\n    }\n    gotoDefinition(position, openToSide) {\n        this.editor.setPosition(position);\n        return this.editor.invokeWithinContext((accessor) => {\n            const canPeek = !openToSide && this.editor.getOption(85 /* EditorOption.definitionLinkOpensInPeek */) && !this.isInPeekEditor(accessor);\n            const action = new DefinitionAction({ openToSide, openInPeek: canPeek, muteMessage: true }, { title: { value: '', original: '' }, id: '', precondition: undefined });\n            return action.run(accessor);\n        });\n    }\n    isInPeekEditor(accessor) {\n        const contextKeyService = accessor.get(IContextKeyService);\n        return PeekContext.inPeekEditor.getValue(contextKeyService);\n    }\n    dispose() {\n        this.toUnhook.dispose();\n        this.toUnhookForKeyboard.dispose();\n    }\n};\nGotoDefinitionAtPositionEditorContribution.ID = 'editor.contrib.gotodefinitionatposition';\nGotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES = 8;\nGotoDefinitionAtPositionEditorContribution = __decorate([\n    __param(1, ITextModelService),\n    __param(2, ILanguageService),\n    __param(3, ILanguageFeaturesService)\n], GotoDefinitionAtPositionEditorContribution);\nregisterEditorContribution(GotoDefinitionAtPositionEditorContribution.ID, GotoDefinitionAtPositionEditorContribution, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../../base/browser/dom.js';\nimport { CountBadge } from '../../../../../base/browser/ui/countBadge/countBadge.js';\nimport { HighlightedLabel } from '../../../../../base/browser/ui/highlightedlabel/highlightedLabel.js';\nimport { IconLabel } from '../../../../../base/browser/ui/iconLabel/iconLabel.js';\nimport { createMatches, FuzzyScore } from '../../../../../base/common/filters.js';\nimport { Disposable } from '../../../../../base/common/lifecycle.js';\nimport { basename, dirname } from '../../../../../base/common/resources.js';\nimport { ITextModelService } from '../../../../common/services/resolverService.js';\nimport { localize } from '../../../../../nls.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { ILabelService } from '../../../../../platform/label/common/label.js';\nimport { defaultCountBadgeStyles } from '../../../../../platform/theme/browser/defaultStyles.js';\nimport { FileReferences, OneReference, ReferencesModel } from '../referencesModel.js';\nexport let DataSource = class DataSource {\n    constructor(_resolverService) {\n        this._resolverService = _resolverService;\n    }\n    hasChildren(element) {\n        if (element instanceof ReferencesModel) {\n            return true;\n        }\n        if (element instanceof FileReferences) {\n            return true;\n        }\n        return false;\n    }\n    getChildren(element) {\n        if (element instanceof ReferencesModel) {\n            return element.groups;\n        }\n        if (element instanceof FileReferences) {\n            return element.resolve(this._resolverService).then(val => {\n                // if (element.failure) {\n                // \t// refresh the element on failure so that\n                // \t// we can update its rendering\n                // \treturn tree.refresh(element).then(() => val.children);\n                // }\n                return val.children;\n            });\n        }\n        throw new Error('bad tree');\n    }\n};\nDataSource = __decorate([\n    __param(0, ITextModelService)\n], DataSource);\n//#endregion\nexport class Delegate {\n    getHeight() {\n        return 23;\n    }\n    getTemplateId(element) {\n        if (element instanceof FileReferences) {\n            return FileReferencesRenderer.id;\n        }\n        else {\n            return OneReferenceRenderer.id;\n        }\n    }\n}\nexport let StringRepresentationProvider = class StringRepresentationProvider {\n    constructor(_keybindingService) {\n        this._keybindingService = _keybindingService;\n    }\n    getKeyboardNavigationLabel(element) {\n        var _a;\n        if (element instanceof OneReference) {\n            const parts = (_a = element.parent.getPreview(element)) === null || _a === void 0 ? void 0 : _a.preview(element.range);\n            if (parts) {\n                return parts.value;\n            }\n        }\n        // FileReferences or unresolved OneReference\n        return basename(element.uri);\n    }\n};\nStringRepresentationProvider = __decorate([\n    __param(0, IKeybindingService)\n], StringRepresentationProvider);\nexport class IdentityProvider {\n    getId(element) {\n        return element instanceof OneReference ? element.id : element.uri;\n    }\n}\n//#region render: File\nlet FileReferencesTemplate = class FileReferencesTemplate extends Disposable {\n    constructor(container, _labelService) {\n        super();\n        this._labelService = _labelService;\n        const parent = document.createElement('div');\n        parent.classList.add('reference-file');\n        this.file = this._register(new IconLabel(parent, { supportHighlights: true }));\n        this.badge = new CountBadge(dom.append(parent, dom.$('.count')), {}, defaultCountBadgeStyles);\n        container.appendChild(parent);\n    }\n    set(element, matches) {\n        const parent = dirname(element.uri);\n        this.file.setLabel(this._labelService.getUriBasenameLabel(element.uri), this._labelService.getUriLabel(parent, { relative: true }), { title: this._labelService.getUriLabel(element.uri), matches });\n        const len = element.children.length;\n        this.badge.setCount(len);\n        if (len > 1) {\n            this.badge.setTitleFormat(localize('referencesCount', \"{0} references\", len));\n        }\n        else {\n            this.badge.setTitleFormat(localize('referenceCount', \"{0} reference\", len));\n        }\n    }\n};\nFileReferencesTemplate = __decorate([\n    __param(1, ILabelService)\n], FileReferencesTemplate);\nexport let FileReferencesRenderer = class FileReferencesRenderer {\n    constructor(_instantiationService) {\n        this._instantiationService = _instantiationService;\n        this.templateId = FileReferencesRenderer.id;\n    }\n    renderTemplate(container) {\n        return this._instantiationService.createInstance(FileReferencesTemplate, container);\n    }\n    renderElement(node, index, template) {\n        template.set(node.element, createMatches(node.filterData));\n    }\n    disposeTemplate(templateData) {\n        templateData.dispose();\n    }\n};\nFileReferencesRenderer.id = 'FileReferencesRenderer';\nFileReferencesRenderer = __decorate([\n    __param(0, IInstantiationService)\n], FileReferencesRenderer);\n//#endregion\n//#region render: Reference\nclass OneReferenceTemplate {\n    constructor(container) {\n        this.label = new HighlightedLabel(container);\n    }\n    set(element, score) {\n        var _a;\n        const preview = (_a = element.parent.getPreview(element)) === null || _a === void 0 ? void 0 : _a.preview(element.range);\n        if (!preview || !preview.value) {\n            // this means we FAILED to resolve the document or the value is the empty string\n            this.label.set(`${basename(element.uri)}:${element.range.startLineNumber + 1}:${element.range.startColumn + 1}`);\n        }\n        else {\n            // render search match as highlight unless\n            // we have score, then render the score\n            const { value, highlight } = preview;\n            if (score && !FuzzyScore.isDefault(score)) {\n                this.label.element.classList.toggle('referenceMatch', false);\n                this.label.set(value, createMatches(score));\n            }\n            else {\n                this.label.element.classList.toggle('referenceMatch', true);\n                this.label.set(value, [highlight]);\n            }\n        }\n    }\n}\nexport class OneReferenceRenderer {\n    constructor() {\n        this.templateId = OneReferenceRenderer.id;\n    }\n    renderTemplate(container) {\n        return new OneReferenceTemplate(container);\n    }\n    renderElement(node, index, templateData) {\n        templateData.set(node.element, node.filterData);\n    }\n    disposeTemplate() {\n    }\n}\nOneReferenceRenderer.id = 'OneReferenceRenderer';\n//#endregion\nexport class AccessibilityProvider {\n    getWidgetAriaLabel() {\n        return localize('treeAriaLabel', \"References\");\n    }\n    getAriaLabel(element) {\n        return element.ariaMessage;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport * as dom from '../../../../../base/browser/dom.js';\nimport { Sizing, SplitView } from '../../../../../base/browser/ui/splitview/splitview.js';\nimport { Color } from '../../../../../base/common/color.js';\nimport { Emitter, Event } from '../../../../../base/common/event.js';\nimport { DisposableStore, dispose } from '../../../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../../../base/common/network.js';\nimport { basenameOrAuthority, dirname } from '../../../../../base/common/resources.js';\nimport './referencesWidget.css';\nimport { EmbeddedCodeEditorWidget } from '../../../../browser/widget/embeddedCodeEditorWidget.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { ModelDecorationOptions, TextModel } from '../../../../common/model/textModel.js';\nimport { ILanguageConfigurationService } from '../../../../common/languages/languageConfigurationRegistry.js';\nimport { PLAINTEXT_LANGUAGE_ID } from '../../../../common/languages/modesRegistry.js';\nimport { ILanguageService } from '../../../../common/languages/language.js';\nimport { ITextModelService } from '../../../../common/services/resolverService.js';\nimport { AccessibilityProvider, DataSource, Delegate, FileReferencesRenderer, IdentityProvider, OneReferenceRenderer, StringRepresentationProvider } from './referencesTree.js';\nimport * as peekView from '../../../peekView/browser/peekView.js';\nimport * as nls from '../../../../../nls.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { ILabelService } from '../../../../../platform/label/common/label.js';\nimport { WorkbenchAsyncDataTree } from '../../../../../platform/list/browser/listService.js';\nimport { IThemeService } from '../../../../../platform/theme/common/themeService.js';\nimport { IUndoRedoService } from '../../../../../platform/undoRedo/common/undoRedo.js';\nimport { FileReferences, OneReference } from '../referencesModel.js';\nclass DecorationsManager {\n    constructor(_editor, _model) {\n        this._editor = _editor;\n        this._model = _model;\n        this._decorations = new Map();\n        this._decorationIgnoreSet = new Set();\n        this._callOnDispose = new DisposableStore();\n        this._callOnModelChange = new DisposableStore();\n        this._callOnDispose.add(this._editor.onDidChangeModel(() => this._onModelChanged()));\n        this._onModelChanged();\n    }\n    dispose() {\n        this._callOnModelChange.dispose();\n        this._callOnDispose.dispose();\n        this.removeDecorations();\n    }\n    _onModelChanged() {\n        this._callOnModelChange.clear();\n        const model = this._editor.getModel();\n        if (!model) {\n            return;\n        }\n        for (const ref of this._model.references) {\n            if (ref.uri.toString() === model.uri.toString()) {\n                this._addDecorations(ref.parent);\n                return;\n            }\n        }\n    }\n    _addDecorations(reference) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        this._callOnModelChange.add(this._editor.getModel().onDidChangeDecorations(() => this._onDecorationChanged()));\n        const newDecorations = [];\n        const newDecorationsActualIndex = [];\n        for (let i = 0, len = reference.children.length; i < len; i++) {\n            const oneReference = reference.children[i];\n            if (this._decorationIgnoreSet.has(oneReference.id)) {\n                continue;\n            }\n            if (oneReference.uri.toString() !== this._editor.getModel().uri.toString()) {\n                continue;\n            }\n            newDecorations.push({\n                range: oneReference.range,\n                options: DecorationsManager.DecorationOptions\n            });\n            newDecorationsActualIndex.push(i);\n        }\n        this._editor.changeDecorations((changeAccessor) => {\n            const decorations = changeAccessor.deltaDecorations([], newDecorations);\n            for (let i = 0; i < decorations.length; i++) {\n                this._decorations.set(decorations[i], reference.children[newDecorationsActualIndex[i]]);\n            }\n        });\n    }\n    _onDecorationChanged() {\n        const toRemove = [];\n        const model = this._editor.getModel();\n        if (!model) {\n            return;\n        }\n        for (const [decorationId, reference] of this._decorations) {\n            const newRange = model.getDecorationRange(decorationId);\n            if (!newRange) {\n                continue;\n            }\n            let ignore = false;\n            if (Range.equalsRange(newRange, reference.range)) {\n                continue;\n            }\n            if (Range.spansMultipleLines(newRange)) {\n                ignore = true;\n            }\n            else {\n                const lineLength = reference.range.endColumn - reference.range.startColumn;\n                const newLineLength = newRange.endColumn - newRange.startColumn;\n                if (lineLength !== newLineLength) {\n                    ignore = true;\n                }\n            }\n            if (ignore) {\n                this._decorationIgnoreSet.add(reference.id);\n                toRemove.push(decorationId);\n            }\n            else {\n                reference.range = newRange;\n            }\n        }\n        for (let i = 0, len = toRemove.length; i < len; i++) {\n            this._decorations.delete(toRemove[i]);\n        }\n        this._editor.removeDecorations(toRemove);\n    }\n    removeDecorations() {\n        this._editor.removeDecorations([...this._decorations.keys()]);\n        this._decorations.clear();\n    }\n}\nDecorationsManager.DecorationOptions = ModelDecorationOptions.register({\n    description: 'reference-decoration',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    className: 'reference-decoration'\n});\nexport class LayoutData {\n    constructor() {\n        this.ratio = 0.7;\n        this.heightInLines = 18;\n    }\n    static fromJSON(raw) {\n        let ratio;\n        let heightInLines;\n        try {\n            const data = JSON.parse(raw);\n            ratio = data.ratio;\n            heightInLines = data.heightInLines;\n        }\n        catch (_a) {\n            //\n        }\n        return {\n            ratio: ratio || 0.7,\n            heightInLines: heightInLines || 18\n        };\n    }\n}\nclass ReferencesTree extends WorkbenchAsyncDataTree {\n}\n/**\n * ZoneWidget that is shown inside the editor\n */\nexport let ReferenceWidget = class ReferenceWidget extends peekView.PeekViewWidget {\n    constructor(editor, _defaultTreeKeyboardSupport, layoutData, themeService, _textModelResolverService, _instantiationService, _peekViewService, _uriLabel, _undoRedoService, _keybindingService, _languageService, _languageConfigurationService) {\n        super(editor, { showFrame: false, showArrow: true, isResizeable: true, isAccessible: true, supportOnTitleClick: true }, _instantiationService);\n        this._defaultTreeKeyboardSupport = _defaultTreeKeyboardSupport;\n        this.layoutData = layoutData;\n        this._textModelResolverService = _textModelResolverService;\n        this._instantiationService = _instantiationService;\n        this._peekViewService = _peekViewService;\n        this._uriLabel = _uriLabel;\n        this._undoRedoService = _undoRedoService;\n        this._keybindingService = _keybindingService;\n        this._languageService = _languageService;\n        this._languageConfigurationService = _languageConfigurationService;\n        this._disposeOnNewModel = new DisposableStore();\n        this._callOnDispose = new DisposableStore();\n        this._onDidSelectReference = new Emitter();\n        this.onDidSelectReference = this._onDidSelectReference.event;\n        this._dim = new dom.Dimension(0, 0);\n        this._applyTheme(themeService.getColorTheme());\n        this._callOnDispose.add(themeService.onDidColorThemeChange(this._applyTheme.bind(this)));\n        this._peekViewService.addExclusiveWidget(editor, this);\n        this.create();\n    }\n    dispose() {\n        this.setModel(undefined);\n        this._callOnDispose.dispose();\n        this._disposeOnNewModel.dispose();\n        dispose(this._preview);\n        dispose(this._previewNotAvailableMessage);\n        dispose(this._tree);\n        dispose(this._previewModelReference);\n        this._splitView.dispose();\n        super.dispose();\n    }\n    _applyTheme(theme) {\n        const borderColor = theme.getColor(peekView.peekViewBorder) || Color.transparent;\n        this.style({\n            arrowColor: borderColor,\n            frameColor: borderColor,\n            headerBackgroundColor: theme.getColor(peekView.peekViewTitleBackground) || Color.transparent,\n            primaryHeadingColor: theme.getColor(peekView.peekViewTitleForeground),\n            secondaryHeadingColor: theme.getColor(peekView.peekViewTitleInfoForeground)\n        });\n    }\n    show(where) {\n        super.show(where, this.layoutData.heightInLines || 18);\n    }\n    focusOnReferenceTree() {\n        this._tree.domFocus();\n    }\n    focusOnPreviewEditor() {\n        this._preview.focus();\n    }\n    isPreviewEditorFocused() {\n        return this._preview.hasTextFocus();\n    }\n    _onTitleClick(e) {\n        if (this._preview && this._preview.getModel()) {\n            this._onDidSelectReference.fire({\n                element: this._getFocusedReference(),\n                kind: e.ctrlKey || e.metaKey || e.altKey ? 'side' : 'open',\n                source: 'title'\n            });\n        }\n    }\n    _fillBody(containerElement) {\n        this.setCssClass('reference-zone-widget');\n        // message pane\n        this._messageContainer = dom.append(containerElement, dom.$('div.messages'));\n        dom.hide(this._messageContainer);\n        this._splitView = new SplitView(containerElement, { orientation: 1 /* Orientation.HORIZONTAL */ });\n        // editor\n        this._previewContainer = dom.append(containerElement, dom.$('div.preview.inline'));\n        const options = {\n            scrollBeyondLastLine: false,\n            scrollbar: {\n                verticalScrollbarSize: 14,\n                horizontal: 'auto',\n                useShadows: true,\n                verticalHasArrows: false,\n                horizontalHasArrows: false,\n                alwaysConsumeMouseWheel: false\n            },\n            overviewRulerLanes: 2,\n            fixedOverflowWidgets: true,\n            minimap: {\n                enabled: false\n            }\n        };\n        this._preview = this._instantiationService.createInstance(EmbeddedCodeEditorWidget, this._previewContainer, options, {}, this.editor);\n        dom.hide(this._previewContainer);\n        this._previewNotAvailableMessage = new TextModel(nls.localize('missingPreviewMessage', \"no preview available\"), PLAINTEXT_LANGUAGE_ID, TextModel.DEFAULT_CREATION_OPTIONS, null, this._undoRedoService, this._languageService, this._languageConfigurationService);\n        // tree\n        this._treeContainer = dom.append(containerElement, dom.$('div.ref-tree.inline'));\n        const treeOptions = {\n            keyboardSupport: this._defaultTreeKeyboardSupport,\n            accessibilityProvider: new AccessibilityProvider(),\n            keyboardNavigationLabelProvider: this._instantiationService.createInstance(StringRepresentationProvider),\n            identityProvider: new IdentityProvider(),\n            openOnSingleClick: true,\n            selectionNavigation: true,\n            overrideStyles: {\n                listBackground: peekView.peekViewResultsBackground\n            }\n        };\n        if (this._defaultTreeKeyboardSupport) {\n            // the tree will consume `Escape` and prevent the widget from closing\n            this._callOnDispose.add(dom.addStandardDisposableListener(this._treeContainer, 'keydown', (e) => {\n                if (e.equals(9 /* KeyCode.Escape */)) {\n                    this._keybindingService.dispatchEvent(e, e.target);\n                    e.stopPropagation();\n                }\n            }, true));\n        }\n        this._tree = this._instantiationService.createInstance(ReferencesTree, 'ReferencesWidget', this._treeContainer, new Delegate(), [\n            this._instantiationService.createInstance(FileReferencesRenderer),\n            this._instantiationService.createInstance(OneReferenceRenderer),\n        ], this._instantiationService.createInstance(DataSource), treeOptions);\n        // split stuff\n        this._splitView.addView({\n            onDidChange: Event.None,\n            element: this._previewContainer,\n            minimumSize: 200,\n            maximumSize: Number.MAX_VALUE,\n            layout: (width) => {\n                this._preview.layout({ height: this._dim.height, width });\n            }\n        }, Sizing.Distribute);\n        this._splitView.addView({\n            onDidChange: Event.None,\n            element: this._treeContainer,\n            minimumSize: 100,\n            maximumSize: Number.MAX_VALUE,\n            layout: (width) => {\n                this._treeContainer.style.height = `${this._dim.height}px`;\n                this._treeContainer.style.width = `${width}px`;\n                this._tree.layout(this._dim.height, width);\n            }\n        }, Sizing.Distribute);\n        this._disposables.add(this._splitView.onDidSashChange(() => {\n            if (this._dim.width) {\n                this.layoutData.ratio = this._splitView.getViewSize(0) / this._dim.width;\n            }\n        }, undefined));\n        // listen on selection and focus\n        const onEvent = (element, kind) => {\n            if (element instanceof OneReference) {\n                if (kind === 'show') {\n                    this._revealReference(element, false);\n                }\n                this._onDidSelectReference.fire({ element, kind, source: 'tree' });\n            }\n        };\n        this._tree.onDidOpen(e => {\n            if (e.sideBySide) {\n                onEvent(e.element, 'side');\n            }\n            else if (e.editorOptions.pinned) {\n                onEvent(e.element, 'goto');\n            }\n            else {\n                onEvent(e.element, 'show');\n            }\n        });\n        dom.hide(this._treeContainer);\n    }\n    _onWidth(width) {\n        if (this._dim) {\n            this._doLayoutBody(this._dim.height, width);\n        }\n    }\n    _doLayoutBody(heightInPixel, widthInPixel) {\n        super._doLayoutBody(heightInPixel, widthInPixel);\n        this._dim = new dom.Dimension(widthInPixel, heightInPixel);\n        this.layoutData.heightInLines = this._viewZone ? this._viewZone.heightInLines : this.layoutData.heightInLines;\n        this._splitView.layout(widthInPixel);\n        this._splitView.resizeView(0, widthInPixel * this.layoutData.ratio);\n    }\n    setSelection(selection) {\n        return this._revealReference(selection, true).then(() => {\n            if (!this._model) {\n                // disposed\n                return;\n            }\n            // show in tree\n            this._tree.setSelection([selection]);\n            this._tree.setFocus([selection]);\n        });\n    }\n    setModel(newModel) {\n        // clean up\n        this._disposeOnNewModel.clear();\n        this._model = newModel;\n        if (this._model) {\n            return this._onNewModel();\n        }\n        return Promise.resolve();\n    }\n    _onNewModel() {\n        if (!this._model) {\n            return Promise.resolve(undefined);\n        }\n        if (this._model.isEmpty) {\n            this.setTitle('');\n            this._messageContainer.innerText = nls.localize('noResults', \"No results\");\n            dom.show(this._messageContainer);\n            return Promise.resolve(undefined);\n        }\n        dom.hide(this._messageContainer);\n        this._decorationsManager = new DecorationsManager(this._preview, this._model);\n        this._disposeOnNewModel.add(this._decorationsManager);\n        // listen on model changes\n        this._disposeOnNewModel.add(this._model.onDidChangeReferenceRange(reference => this._tree.rerender(reference)));\n        // listen on editor\n        this._disposeOnNewModel.add(this._preview.onMouseDown(e => {\n            const { event, target } = e;\n            if (event.detail !== 2) {\n                return;\n            }\n            const element = this._getFocusedReference();\n            if (!element) {\n                return;\n            }\n            this._onDidSelectReference.fire({\n                element: { uri: element.uri, range: target.range },\n                kind: (event.ctrlKey || event.metaKey || event.altKey) ? 'side' : 'open',\n                source: 'editor'\n            });\n        }));\n        // make sure things are rendered\n        this.container.classList.add('results-loaded');\n        dom.show(this._treeContainer);\n        dom.show(this._previewContainer);\n        this._splitView.layout(this._dim.width);\n        this.focusOnReferenceTree();\n        // pick input and a reference to begin with\n        return this._tree.setInput(this._model.groups.length === 1 ? this._model.groups[0] : this._model);\n    }\n    _getFocusedReference() {\n        const [element] = this._tree.getFocus();\n        if (element instanceof OneReference) {\n            return element;\n        }\n        else if (element instanceof FileReferences) {\n            if (element.children.length > 0) {\n                return element.children[0];\n            }\n        }\n        return undefined;\n    }\n    revealReference(reference) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this._revealReference(reference, false);\n            this._onDidSelectReference.fire({ element: reference, kind: 'goto', source: 'tree' });\n        });\n    }\n    _revealReference(reference, revealParent) {\n        return __awaiter(this, void 0, void 0, function* () {\n            // check if there is anything to do...\n            if (this._revealedReference === reference) {\n                return;\n            }\n            this._revealedReference = reference;\n            // Update widget header\n            if (reference.uri.scheme !== Schemas.inMemory) {\n                this.setTitle(basenameOrAuthority(reference.uri), this._uriLabel.getUriLabel(dirname(reference.uri)));\n            }\n            else {\n                this.setTitle(nls.localize('peekView.alternateTitle', \"References\"));\n            }\n            const promise = this._textModelResolverService.createModelReference(reference.uri);\n            if (this._tree.getInput() === reference.parent) {\n                this._tree.reveal(reference);\n            }\n            else {\n                if (revealParent) {\n                    this._tree.reveal(reference.parent);\n                }\n                yield this._tree.expand(reference.parent);\n                this._tree.reveal(reference);\n            }\n            const ref = yield promise;\n            if (!this._model) {\n                // disposed\n                ref.dispose();\n                return;\n            }\n            dispose(this._previewModelReference);\n            // show in editor\n            const model = ref.object;\n            if (model) {\n                const scrollType = this._preview.getModel() === model.textEditorModel ? 0 /* ScrollType.Smooth */ : 1 /* ScrollType.Immediate */;\n                const sel = Range.lift(reference.range).collapseToStart();\n                this._previewModelReference = ref;\n                this._preview.setModel(model.textEditorModel);\n                this._preview.setSelection(sel);\n                this._preview.revealRangeInCenter(sel, scrollType);\n            }\n            else {\n                this._preview.setModel(this._previewNotAvailableMessage);\n                ref.dispose();\n            }\n        });\n    }\n};\nReferenceWidget = __decorate([\n    __param(3, IThemeService),\n    __param(4, ITextModelService),\n    __param(5, IInstantiationService),\n    __param(6, peekView.IPeekViewService),\n    __param(7, ILabelService),\n    __param(8, IUndoRedoService),\n    __param(9, IKeybindingService),\n    __param(10, ILanguageService),\n    __param(11, ILanguageConfigurationService)\n], ReferenceWidget);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { createCancelablePromise } from '../../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../../base/common/errors.js';\nimport { KeyChord } from '../../../../../base/common/keyCodes.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { ICodeEditorService } from '../../../../browser/services/codeEditorService.js';\nimport { Position } from '../../../../common/core/position.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { getOuterEditor, PeekContext } from '../../../peekView/browser/peekView.js';\nimport * as nls from '../../../../../nls.js';\nimport { CommandsRegistry } from '../../../../../platform/commands/common/commands.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { ContextKeyExpr, IContextKeyService, RawContextKey } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { KeybindingsRegistry } from '../../../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { IListService, WorkbenchListFocusContextKey, WorkbenchTreeElementCanCollapse, WorkbenchTreeElementCanExpand } from '../../../../../platform/list/browser/listService.js';\nimport { INotificationService } from '../../../../../platform/notification/common/notification.js';\nimport { IStorageService } from '../../../../../platform/storage/common/storage.js';\nimport { OneReference } from '../referencesModel.js';\nimport { LayoutData, ReferenceWidget } from './referencesWidget.js';\nexport const ctxReferenceSearchVisible = new RawContextKey('referenceSearchVisible', false, nls.localize('referenceSearchVisible', \"Whether reference peek is visible, like 'Peek References' or 'Peek Definition'\"));\nexport let ReferencesController = class ReferencesController {\n    static get(editor) {\n        return editor.getContribution(ReferencesController.ID);\n    }\n    constructor(_defaultTreeKeyboardSupport, _editor, contextKeyService, _editorService, _notificationService, _instantiationService, _storageService, _configurationService) {\n        this._defaultTreeKeyboardSupport = _defaultTreeKeyboardSupport;\n        this._editor = _editor;\n        this._editorService = _editorService;\n        this._notificationService = _notificationService;\n        this._instantiationService = _instantiationService;\n        this._storageService = _storageService;\n        this._configurationService = _configurationService;\n        this._disposables = new DisposableStore();\n        this._requestIdPool = 0;\n        this._ignoreModelChangeEvent = false;\n        this._referenceSearchVisible = ctxReferenceSearchVisible.bindTo(contextKeyService);\n    }\n    dispose() {\n        var _a, _b;\n        this._referenceSearchVisible.reset();\n        this._disposables.dispose();\n        (_a = this._widget) === null || _a === void 0 ? void 0 : _a.dispose();\n        (_b = this._model) === null || _b === void 0 ? void 0 : _b.dispose();\n        this._widget = undefined;\n        this._model = undefined;\n    }\n    toggleWidget(range, modelPromise, peekMode) {\n        // close current widget and return early is position didn't change\n        let widgetPosition;\n        if (this._widget) {\n            widgetPosition = this._widget.position;\n        }\n        this.closeWidget();\n        if (!!widgetPosition && range.containsPosition(widgetPosition)) {\n            return;\n        }\n        this._peekMode = peekMode;\n        this._referenceSearchVisible.set(true);\n        // close the widget on model/mode changes\n        this._disposables.add(this._editor.onDidChangeModelLanguage(() => { this.closeWidget(); }));\n        this._disposables.add(this._editor.onDidChangeModel(() => {\n            if (!this._ignoreModelChangeEvent) {\n                this.closeWidget();\n            }\n        }));\n        const storageKey = 'peekViewLayout';\n        const data = LayoutData.fromJSON(this._storageService.get(storageKey, 0 /* StorageScope.PROFILE */, '{}'));\n        this._widget = this._instantiationService.createInstance(ReferenceWidget, this._editor, this._defaultTreeKeyboardSupport, data);\n        this._widget.setTitle(nls.localize('labelLoading', \"Loading...\"));\n        this._widget.show(range);\n        this._disposables.add(this._widget.onDidClose(() => {\n            modelPromise.cancel();\n            if (this._widget) {\n                this._storageService.store(storageKey, JSON.stringify(this._widget.layoutData), 0 /* StorageScope.PROFILE */, 1 /* StorageTarget.MACHINE */);\n                this._widget = undefined;\n            }\n            this.closeWidget();\n        }));\n        this._disposables.add(this._widget.onDidSelectReference(event => {\n            const { element, kind } = event;\n            if (!element) {\n                return;\n            }\n            switch (kind) {\n                case 'open':\n                    if (event.source !== 'editor' || !this._configurationService.getValue('editor.stablePeek')) {\n                        // when stable peek is configured we don't close\n                        // the peek window on selecting the editor\n                        this.openReference(element, false, false);\n                    }\n                    break;\n                case 'side':\n                    this.openReference(element, true, false);\n                    break;\n                case 'goto':\n                    if (peekMode) {\n                        this._gotoReference(element, true);\n                    }\n                    else {\n                        this.openReference(element, false, true);\n                    }\n                    break;\n            }\n        }));\n        const requestId = ++this._requestIdPool;\n        modelPromise.then(model => {\n            var _a;\n            // still current request? widget still open?\n            if (requestId !== this._requestIdPool || !this._widget) {\n                model.dispose();\n                return undefined;\n            }\n            (_a = this._model) === null || _a === void 0 ? void 0 : _a.dispose();\n            this._model = model;\n            // show widget\n            return this._widget.setModel(this._model).then(() => {\n                if (this._widget && this._model && this._editor.hasModel()) { // might have been closed\n                    // set title\n                    if (!this._model.isEmpty) {\n                        this._widget.setMetaTitle(nls.localize('metaTitle.N', \"{0} ({1})\", this._model.title, this._model.references.length));\n                    }\n                    else {\n                        this._widget.setMetaTitle('');\n                    }\n                    // set 'best' selection\n                    const uri = this._editor.getModel().uri;\n                    const pos = new Position(range.startLineNumber, range.startColumn);\n                    const selection = this._model.nearestReference(uri, pos);\n                    if (selection) {\n                        return this._widget.setSelection(selection).then(() => {\n                            if (this._widget && this._editor.getOption(84 /* EditorOption.peekWidgetDefaultFocus */) === 'editor') {\n                                this._widget.focusOnPreviewEditor();\n                            }\n                        });\n                    }\n                }\n                return undefined;\n            });\n        }, error => {\n            this._notificationService.error(error);\n        });\n    }\n    changeFocusBetweenPreviewAndReferences() {\n        if (!this._widget) {\n            // can be called while still resolving...\n            return;\n        }\n        if (this._widget.isPreviewEditorFocused()) {\n            this._widget.focusOnReferenceTree();\n        }\n        else {\n            this._widget.focusOnPreviewEditor();\n        }\n    }\n    goToNextOrPreviousReference(fwd) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this._editor.hasModel() || !this._model || !this._widget) {\n                // can be called while still resolving...\n                return;\n            }\n            const currentPosition = this._widget.position;\n            if (!currentPosition) {\n                return;\n            }\n            const source = this._model.nearestReference(this._editor.getModel().uri, currentPosition);\n            if (!source) {\n                return;\n            }\n            const target = this._model.nextOrPreviousReference(source, fwd);\n            const editorFocus = this._editor.hasTextFocus();\n            const previewEditorFocus = this._widget.isPreviewEditorFocused();\n            yield this._widget.setSelection(target);\n            yield this._gotoReference(target, false);\n            if (editorFocus) {\n                this._editor.focus();\n            }\n            else if (this._widget && previewEditorFocus) {\n                this._widget.focusOnPreviewEditor();\n            }\n        });\n    }\n    revealReference(reference) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this._editor.hasModel() || !this._model || !this._widget) {\n                // can be called while still resolving...\n                return;\n            }\n            yield this._widget.revealReference(reference);\n        });\n    }\n    closeWidget(focusEditor = true) {\n        var _a, _b;\n        (_a = this._widget) === null || _a === void 0 ? void 0 : _a.dispose();\n        (_b = this._model) === null || _b === void 0 ? void 0 : _b.dispose();\n        this._referenceSearchVisible.reset();\n        this._disposables.clear();\n        this._widget = undefined;\n        this._model = undefined;\n        if (focusEditor) {\n            this._editor.focus();\n        }\n        this._requestIdPool += 1; // Cancel pending requests\n    }\n    _gotoReference(ref, pinned) {\n        var _a;\n        (_a = this._widget) === null || _a === void 0 ? void 0 : _a.hide();\n        this._ignoreModelChangeEvent = true;\n        const range = Range.lift(ref.range).collapseToStart();\n        return this._editorService.openCodeEditor({\n            resource: ref.uri,\n            options: { selection: range, selectionSource: \"code.jump\" /* TextEditorSelectionSource.JUMP */, pinned }\n        }, this._editor).then(openedEditor => {\n            var _a;\n            this._ignoreModelChangeEvent = false;\n            if (!openedEditor || !this._widget) {\n                // something went wrong...\n                this.closeWidget();\n                return;\n            }\n            if (this._editor === openedEditor) {\n                //\n                this._widget.show(range);\n                this._widget.focusOnReferenceTree();\n            }\n            else {\n                // we opened a different editor instance which means a different controller instance.\n                // therefore we stop with this controller and continue with the other\n                const other = ReferencesController.get(openedEditor);\n                const model = this._model.clone();\n                this.closeWidget();\n                openedEditor.focus();\n                other === null || other === void 0 ? void 0 : other.toggleWidget(range, createCancelablePromise(_ => Promise.resolve(model)), (_a = this._peekMode) !== null && _a !== void 0 ? _a : false);\n            }\n        }, (err) => {\n            this._ignoreModelChangeEvent = false;\n            onUnexpectedError(err);\n        });\n    }\n    openReference(ref, sideBySide, pinned) {\n        // clear stage\n        if (!sideBySide) {\n            this.closeWidget();\n        }\n        const { uri, range } = ref;\n        this._editorService.openCodeEditor({\n            resource: uri,\n            options: { selection: range, selectionSource: \"code.jump\" /* TextEditorSelectionSource.JUMP */, pinned }\n        }, this._editor, sideBySide);\n    }\n};\nReferencesController.ID = 'editor.contrib.referencesController';\nReferencesController = __decorate([\n    __param(2, IContextKeyService),\n    __param(3, ICodeEditorService),\n    __param(4, INotificationService),\n    __param(5, IInstantiationService),\n    __param(6, IStorageService),\n    __param(7, IConfigurationService)\n], ReferencesController);\nfunction withController(accessor, fn) {\n    const outerEditor = getOuterEditor(accessor);\n    if (!outerEditor) {\n        return;\n    }\n    const controller = ReferencesController.get(outerEditor);\n    if (controller) {\n        fn(controller);\n    }\n}\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'togglePeekWidgetFocus',\n    weight: 100 /* KeybindingWeight.EditorContrib */,\n    primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 60 /* KeyCode.F2 */),\n    when: ContextKeyExpr.or(ctxReferenceSearchVisible, PeekContext.inPeekEditor),\n    handler(accessor) {\n        withController(accessor, controller => {\n            controller.changeFocusBetweenPreviewAndReferences();\n        });\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'goToNextReference',\n    weight: 100 /* KeybindingWeight.EditorContrib */ - 10,\n    primary: 62 /* KeyCode.F4 */,\n    secondary: [70 /* KeyCode.F12 */],\n    when: ContextKeyExpr.or(ctxReferenceSearchVisible, PeekContext.inPeekEditor),\n    handler(accessor) {\n        withController(accessor, controller => {\n            controller.goToNextOrPreviousReference(true);\n        });\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'goToPreviousReference',\n    weight: 100 /* KeybindingWeight.EditorContrib */ - 10,\n    primary: 1024 /* KeyMod.Shift */ | 62 /* KeyCode.F4 */,\n    secondary: [1024 /* KeyMod.Shift */ | 70 /* KeyCode.F12 */],\n    when: ContextKeyExpr.or(ctxReferenceSearchVisible, PeekContext.inPeekEditor),\n    handler(accessor) {\n        withController(accessor, controller => {\n            controller.goToNextOrPreviousReference(false);\n        });\n    }\n});\n// commands that aren't needed anymore because there is now ContextKeyExpr.OR\nCommandsRegistry.registerCommandAlias('goToNextReferenceFromEmbeddedEditor', 'goToNextReference');\nCommandsRegistry.registerCommandAlias('goToPreviousReferenceFromEmbeddedEditor', 'goToPreviousReference');\n// close\nCommandsRegistry.registerCommandAlias('closeReferenceSearchEditor', 'closeReferenceSearch');\nCommandsRegistry.registerCommand('closeReferenceSearch', accessor => withController(accessor, controller => controller.closeWidget()));\nKeybindingsRegistry.registerKeybindingRule({\n    id: 'closeReferenceSearch',\n    weight: 100 /* KeybindingWeight.EditorContrib */ - 101,\n    primary: 9 /* KeyCode.Escape */,\n    secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */],\n    when: ContextKeyExpr.and(PeekContext.inPeekEditor, ContextKeyExpr.not('config.editor.stablePeek'))\n});\nKeybindingsRegistry.registerKeybindingRule({\n    id: 'closeReferenceSearch',\n    weight: 200 /* KeybindingWeight.WorkbenchContrib */ + 50,\n    primary: 9 /* KeyCode.Escape */,\n    secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */],\n    when: ContextKeyExpr.and(ctxReferenceSearchVisible, ContextKeyExpr.not('config.editor.stablePeek'))\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'revealReference',\n    weight: 200 /* KeybindingWeight.WorkbenchContrib */,\n    primary: 3 /* KeyCode.Enter */,\n    mac: {\n        primary: 3 /* KeyCode.Enter */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 18 /* KeyCode.DownArrow */]\n    },\n    when: ContextKeyExpr.and(ctxReferenceSearchVisible, WorkbenchListFocusContextKey, WorkbenchTreeElementCanCollapse.negate(), WorkbenchTreeElementCanExpand.negate()),\n    handler(accessor) {\n        var _a;\n        const listService = accessor.get(IListService);\n        const focus = (_a = listService.lastFocusedList) === null || _a === void 0 ? void 0 : _a.getFocus();\n        if (Array.isArray(focus) && focus[0] instanceof OneReference) {\n            withController(accessor, controller => controller.revealReference(focus[0]));\n        }\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'openReferenceToSide',\n    weight: 100 /* KeybindingWeight.EditorContrib */,\n    primary: 2048 /* KeyMod.CtrlCmd */ | 3 /* KeyCode.Enter */,\n    mac: {\n        primary: 256 /* KeyMod.WinCtrl */ | 3 /* KeyCode.Enter */\n    },\n    when: ContextKeyExpr.and(ctxReferenceSearchVisible, WorkbenchListFocusContextKey, WorkbenchTreeElementCanCollapse.negate(), WorkbenchTreeElementCanExpand.negate()),\n    handler(accessor) {\n        var _a;\n        const listService = accessor.get(IListService);\n        const focus = (_a = listService.lastFocusedList) === null || _a === void 0 ? void 0 : _a.getFocus();\n        if (Array.isArray(focus) && focus[0] instanceof OneReference) {\n            withController(accessor, controller => controller.openReference(focus[0], true, true));\n        }\n    }\n});\nCommandsRegistry.registerCommand('openReference', (accessor) => {\n    var _a;\n    const listService = accessor.get(IListService);\n    const focus = (_a = listService.lastFocusedList) === null || _a === void 0 ? void 0 : _a.getFocus();\n    if (Array.isArray(focus) && focus[0] instanceof OneReference) {\n        withController(accessor, controller => controller.openReference(focus[0], false, true));\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { defaultGenerator } from '../../../../base/common/idGenerator.js';\nimport { dispose } from '../../../../base/common/lifecycle.js';\nimport { ResourceMap } from '../../../../base/common/map.js';\nimport { basename, extUri } from '../../../../base/common/resources.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport { Range } from '../../../common/core/range.js';\nimport { localize } from '../../../../nls.js';\nexport class OneReference {\n    constructor(isProviderFirst, parent, link, _rangeCallback) {\n        this.isProviderFirst = isProviderFirst;\n        this.parent = parent;\n        this.link = link;\n        this._rangeCallback = _rangeCallback;\n        this.id = defaultGenerator.nextId();\n    }\n    get uri() {\n        return this.link.uri;\n    }\n    get range() {\n        var _a, _b;\n        return (_b = (_a = this._range) !== null && _a !== void 0 ? _a : this.link.targetSelectionRange) !== null && _b !== void 0 ? _b : this.link.range;\n    }\n    set range(value) {\n        this._range = value;\n        this._rangeCallback(this);\n    }\n    get ariaMessage() {\n        var _a;\n        const preview = (_a = this.parent.getPreview(this)) === null || _a === void 0 ? void 0 : _a.preview(this.range);\n        if (!preview) {\n            return localize('aria.oneReference', \"in {0} on line {1} at column {2}\", basename(this.uri), this.range.startLineNumber, this.range.startColumn);\n        }\n        else {\n            return localize({ key: 'aria.oneReference.preview', comment: ['Placeholders are: 0: filename, 1:line number, 2: column number, 3: preview snippet of source code'] }, \"{0} in {1} on line {2} at column {3}\", preview.value, basename(this.uri), this.range.startLineNumber, this.range.startColumn);\n        }\n    }\n}\nexport class FilePreview {\n    constructor(_modelReference) {\n        this._modelReference = _modelReference;\n    }\n    dispose() {\n        this._modelReference.dispose();\n    }\n    preview(range, n = 8) {\n        const model = this._modelReference.object.textEditorModel;\n        if (!model) {\n            return undefined;\n        }\n        const { startLineNumber, startColumn, endLineNumber, endColumn } = range;\n        const word = model.getWordUntilPosition({ lineNumber: startLineNumber, column: startColumn - n });\n        const beforeRange = new Range(startLineNumber, word.startColumn, startLineNumber, startColumn);\n        const afterRange = new Range(endLineNumber, endColumn, endLineNumber, 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */);\n        const before = model.getValueInRange(beforeRange).replace(/^\\s+/, '');\n        const inside = model.getValueInRange(range);\n        const after = model.getValueInRange(afterRange).replace(/\\s+$/, '');\n        return {\n            value: before + inside + after,\n            highlight: { start: before.length, end: before.length + inside.length }\n        };\n    }\n}\nexport class FileReferences {\n    constructor(parent, uri) {\n        this.parent = parent;\n        this.uri = uri;\n        this.children = [];\n        this._previews = new ResourceMap();\n    }\n    dispose() {\n        dispose(this._previews.values());\n        this._previews.clear();\n    }\n    getPreview(child) {\n        return this._previews.get(child.uri);\n    }\n    get ariaMessage() {\n        const len = this.children.length;\n        if (len === 1) {\n            return localize('aria.fileReferences.1', \"1 symbol in {0}, full path {1}\", basename(this.uri), this.uri.fsPath);\n        }\n        else {\n            return localize('aria.fileReferences.N', \"{0} symbols in {1}, full path {2}\", len, basename(this.uri), this.uri.fsPath);\n        }\n    }\n    resolve(textModelResolverService) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this._previews.size !== 0) {\n                return this;\n            }\n            for (const child of this.children) {\n                if (this._previews.has(child.uri)) {\n                    continue;\n                }\n                try {\n                    const ref = yield textModelResolverService.createModelReference(child.uri);\n                    this._previews.set(child.uri, new FilePreview(ref));\n                }\n                catch (err) {\n                    onUnexpectedError(err);\n                }\n            }\n            return this;\n        });\n    }\n}\nexport class ReferencesModel {\n    constructor(links, title) {\n        this.groups = [];\n        this.references = [];\n        this._onDidChangeReferenceRange = new Emitter();\n        this.onDidChangeReferenceRange = this._onDidChangeReferenceRange.event;\n        this._links = links;\n        this._title = title;\n        // grouping and sorting\n        const [providersFirst] = links;\n        links.sort(ReferencesModel._compareReferences);\n        let current;\n        for (const link of links) {\n            if (!current || !extUri.isEqual(current.uri, link.uri, true)) {\n                // new group\n                current = new FileReferences(this, link.uri);\n                this.groups.push(current);\n            }\n            // append, check for equality first!\n            if (current.children.length === 0 || ReferencesModel._compareReferences(link, current.children[current.children.length - 1]) !== 0) {\n                const oneRef = new OneReference(providersFirst === link, current, link, ref => this._onDidChangeReferenceRange.fire(ref));\n                this.references.push(oneRef);\n                current.children.push(oneRef);\n            }\n        }\n    }\n    dispose() {\n        dispose(this.groups);\n        this._onDidChangeReferenceRange.dispose();\n        this.groups.length = 0;\n    }\n    clone() {\n        return new ReferencesModel(this._links, this._title);\n    }\n    get title() {\n        return this._title;\n    }\n    get isEmpty() {\n        return this.groups.length === 0;\n    }\n    get ariaMessage() {\n        if (this.isEmpty) {\n            return localize('aria.result.0', \"No results found\");\n        }\n        else if (this.references.length === 1) {\n            return localize('aria.result.1', \"Found 1 symbol in {0}\", this.references[0].uri.fsPath);\n        }\n        else if (this.groups.length === 1) {\n            return localize('aria.result.n1', \"Found {0} symbols in {1}\", this.references.length, this.groups[0].uri.fsPath);\n        }\n        else {\n            return localize('aria.result.nm', \"Found {0} symbols in {1} files\", this.references.length, this.groups.length);\n        }\n    }\n    nextOrPreviousReference(reference, next) {\n        const { parent } = reference;\n        let idx = parent.children.indexOf(reference);\n        const childCount = parent.children.length;\n        const groupCount = parent.parent.groups.length;\n        if (groupCount === 1 || next && idx + 1 < childCount || !next && idx > 0) {\n            // cycling within one file\n            if (next) {\n                idx = (idx + 1) % childCount;\n            }\n            else {\n                idx = (idx + childCount - 1) % childCount;\n            }\n            return parent.children[idx];\n        }\n        idx = parent.parent.groups.indexOf(parent);\n        if (next) {\n            idx = (idx + 1) % groupCount;\n            return parent.parent.groups[idx].children[0];\n        }\n        else {\n            idx = (idx + groupCount - 1) % groupCount;\n            return parent.parent.groups[idx].children[parent.parent.groups[idx].children.length - 1];\n        }\n    }\n    nearestReference(resource, position) {\n        const nearest = this.references.map((ref, idx) => {\n            return {\n                idx,\n                prefixLen: strings.commonPrefixLength(ref.uri.toString(), resource.toString()),\n                offsetDist: Math.abs(ref.range.startLineNumber - position.lineNumber) * 100 + Math.abs(ref.range.startColumn - position.column)\n            };\n        }).sort((a, b) => {\n            if (a.prefixLen > b.prefixLen) {\n                return -1;\n            }\n            else if (a.prefixLen < b.prefixLen) {\n                return 1;\n            }\n            else if (a.offsetDist < b.offsetDist) {\n                return -1;\n            }\n            else if (a.offsetDist > b.offsetDist) {\n                return 1;\n            }\n            else {\n                return 0;\n            }\n        })[0];\n        if (nearest) {\n            return this.references[nearest.idx];\n        }\n        return undefined;\n    }\n    referenceAt(resource, position) {\n        for (const ref of this.references) {\n            if (ref.uri.toString() === resource.toString()) {\n                if (Range.containsPosition(ref.range, position)) {\n                    return ref;\n                }\n            }\n        }\n        return undefined;\n    }\n    firstReference() {\n        for (const ref of this.references) {\n            if (ref.isProviderFirst) {\n                return ref;\n            }\n        }\n        return this.references[0];\n    }\n    static _compareReferences(a, b) {\n        return extUri.compare(a.uri, b.uri) || Range.compareRangesUsingStarts(a.range, b.range);\n    }\n}\n"],"names":["FoldingModel","regions","this","_regions","textModel","_textModel","constructor","decorationProvider","_updateEventEmitter","Emitter","onDidChange","event","_decorationProvider","FoldingRegions","Uint32Array","_editorDecorationIds","toggleCollapseState","toggledRegions","length","sort","r1","r2","regionIndex","processed","changeDecorations","accessor","k","dirtyRegionEndLine","lastHiddenLine","updateDecorationsUntil","index","endLineNumber","getEndLineNumber","isCollapsed","isManual","getSource","changeDecorationOptions","getDecorationOption","region","editorDecorationId","newCollapseState","setCollapsed","Math","max","fire","model","collapseStateChanged","removeManualRanges","ranges","newFoldingRanges","Array","intersects","foldRange","range","startLineNumber","i","toFoldRange","source","push","updatePost","fromFoldRanges","update","newRegions","blockedLineNumers","arguments","undefined","foldedOrManualRanges","_currentFoldedOrManualRanges","newRanges","sanitizeAndMerge","getLineCount","newEditorDecorations","limit","getStartLineNumber","decorationRange","startColumn","getLineMaxColumn","endColumn","options","deltaDecorations","isBlocked","blockedLineNumber","foldedRanges","decRange","getDecorationRange","type","getMemento","result","maxLineNumber","checksum","_getLinesChecksum","applyMemento","state","_a","_b","isArray","rangesToRestore","lineNumber1","lineNumber2","hash","getLineContent","dispose","removeDecorations","getAllRegionsAtLine","lineNumber","filter","findRange","level","current","toRegion","parentIndex","getRegionAtLine","getRegionsInside","Number","MAX_VALUE","levelStack","len","containedBy","pop","setCollapseStateLevelsDown","foldingModel","doCollapse","levels","lineNumbers","toToggle","regionsInside","r","setCollapseStateLevelsUp","setCollapseStateForRest","blockedLineNumbers","filteredRegions","every","filteredRegion","setCollapseStateForMatchingLines","regExp","editorModel","test","setCollapseStateForType","getType","HiddenRangeModel","hiddenRanges","_hiddenRanges","_hasLineChanges","_foldingModel","_foldingModelListener","_","updateHiddenRanges","notifyChangeModelContent","e","changes","some","change","countEOL","text","updateHiddenAreas","newHiddenAreas","lastCollapsedStart","lastCollapsedEnd","Range","applyHiddenRanges","hasRanges","isHidden","line","adjustSelections","selections","hasChanges","lastRange","adjustLine","isInside","selection","adjustedStartLine","setStartPosition","adjustedEndLine","setEndPosition","findFirstInSorted","foldBackground","registerColor","light","transparent","editorSelectionBackground","dark","hcDark","hcLight","localize","iconForeground","foldingExpandedIcon","registerIcon","Codicon","chevronDown","foldingCollapsedIcon","chevronRight","foldingManualCollapsedIcon","foldingManualExpandedIcon","foldedBackgroundMinimap","color","themeColorFromId","position","MinimapPosition","Inline","FoldingDecorationProvider","editor","showFoldingControls","showFoldingHighlights","HIDDEN_RANGE_DECORATION","NO_CONTROLS_COLLAPSED_HIGHLIGHTED_RANGE_DECORATION","NO_CONTROLS_COLLAPSED_RANGE_DECORATION","NO_CONTROLS_EXPANDED_RANGE_DECORATION","MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION","MANUALLY_COLLAPSED_VISUAL_DECORATION","COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION","COLLAPSED_VISUAL_DECORATION","MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION","EXPANDED_AUTO_HIDE_VISUAL_DECORATION","MANUALLY_EXPANDED_VISUAL_DECORATION","EXPANDED_VISUAL_DECORATION","callback","decorationIds","ModelDecorationOptions","register","description","stickiness","afterContentClassName","isWholeLine","firstLineDecorationClassName","ThemeIcon","asClassName","className","minimap","__decorate","decorators","target","key","desc","d","c","Object","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","__param","paramIndex","decorator","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","rejected","done","then","apply","CONTEXT_FOLDING_ENABLED","RawContextKey","FoldingController","Disposable","get","getContribution","ID","getFoldingRangeProviders","languageFeaturesService","foldingRangeProviders","foldingRangeProvider","ordered","_foldingRangeSelector","call","contextKeyService","languageConfigurationService","notificationService","languageFeatureDebounceService","super","localToDispose","_register","DisposableStore","_foldingLimitReporter","RangesLimitReporter","getOptions","_isEnabled","_useFoldingProviders","_unfoldOnClickAfterEndOfLine","_restoringViewState","_currentModelHasFoldedImports","_foldingImportsByDefault","updateDebounceInfo","for","min","hiddenRangeModel","rangeProvider","foldingRegionPromise","foldingModelPromise","updateScheduler","cursorChangedScheduler","mouseDownInfo","foldingDecorationProvider","foldingEnabled","bindTo","set","onDidChangeModel","onModelChanged","onDidChangeConfiguration","hasChanged","triggerFoldingModelChanged","onFoldingStrategyChanged","saveViewState","getModel","isTooLargeForTokenization","collapsedRegions","provider","id","lineCount","foldedImports","restoreViewState","clear","add","hr","onHiddenRangesChanges","Delayer","RunOnceScheduler","revealCursor","onDidChangeModelLanguageConfiguration","onDidChangeModelContent","onDidChangeCursorPosition","onCursorPositionChanged","onMouseDown","onEditorMouseDown","onMouseUp","onEditorMouseUp","cancel","getRangeProvider","indentRangeProvider","IndentRangeProvider","selectedProviders","SyntaxRangeProvider","getFoldingModel","trigger","sw","StopWatch","createCancelablePromise","token","compute","foldingRanges","scrollState","setCollapsedAllOfType","FoldingRangeKind","Imports","StableEditorScrollState","capture","getSelections","selectionLineNumbers","map","s","restore","newValue","elapsed","defaultDelay","err","onUnexpectedError","setSelections","setHiddenAreas","schedule","selectionStartLineNumber","reveal","getPosition","leftButton","middleButton","iconClicked","data","detail","offsetLeftInGutter","element","offsetLeft","offsetX","isAfterLines","altKey","otherRegion","toMaybeToggle","recursive","shiftKey","column","revealPositionInCenterIfOutsideViewport","IContextKeyService","ILanguageConfigurationService","INotificationService","ILanguageFeatureDebounceService","ILanguageFeaturesService","_onDidChange","_computed","_limited","computed","limited","FoldingAction","EditorAction","runEditorCommand","args","foldingController","reportTelemetry","invoke","getSelection","getStartPosition","getSelectedLines","getLineNumbers","selectionLines","l","run","_accessor","_editor","foldingArgumentsConstraint","types","foldingArgs","direction","FoldLevelAction","getFoldingLevel","parseInt","substr","ID_PREFIX","_foldingController","foldLevel","containsLine","setCollapseStateAtLevel","registerEditorContribution","registerEditorAction","label","nls","alias","precondition","kbOpts","kbExpr","EditorContextKeys","editorTextFocus","primary","mac","weight","name","constraint","schema","KeyChord","_args","setCollapseStateUp","selectedLines","hasTypes","Comment","comments","getLanguageConfiguration","getLanguageId","blockCommentStartToken","RegExp","escapeRegExpCharacters","Region","foldingRules","markers","start","foldingRegion","parentFoldingIdx","getParentFoldLine","setSelection","expectedParentIndex","minLineNumber","getPreviousFoldLine","getNextFoldLine","collapseRanges","a","b","registerInstantiatedEditorAction","concat","CommandsRegistry","registerCommand","_len","_key","resource","URI","illegalArgument","IModelService","configurationService","IConfigurationService","getValue","strategy","foldingLimitReporter","providers","CancellationToken","None","end","kind","fromValue","foldSourceAbbr","MAX_LINE_NUMBER","MASK_INDENT","BitField","size","numWords","ceil","_states","arrayIndex","bit","newState","startIndexes","endIndexes","Error","_startIndexes","_endIndexes","_collapseStates","_userDefinedStates","_recoveredStates","_types","_parentsComputed","ensureParentIndices","parentIndexes","isInsideLast","isUserDefined","setUserDefined","isRecovered","setRecovered","setSource","FoldingRegion","getParentIndex","parent","contains","findIndex","low","high","mid","floor","toString","res","join","rangesLength","gotTypes","rangesA","rangesB","getIndexedFunction","getA","getB","indexA","indexB","nextA","nextB","stackedRanges","topStackedRange","prevLineNumber","resultRanges","useRange","scanIndex","prescanB","foldingRangesLimit","cancelationToken","offSide","foldingRangesLimitDefault","tabSize","RangesCollector","pattern","previousRegions","indent","endAbove","lineContent","computeIndentLevel","m","previous","match","insertFirst","toIndentRanges","computeRanges","_indentOccurrences","_length","_foldingRangesLimit","entries","maxIndent","n","startIndex","foldingContext","handleFoldingRangesChange","fallbackRangeProvider","disposables","cancellationToken","rangeData","promises","provideFoldingRanges","isCancellationRequested","nLines","rank","onUnexpectedExternalError","all","collectSyntaxRanges","sorted","d1","d2","diff","collector","top","entry","sanitizeRanges","_nestingLevels","_nestingLevelCounts","nestingLevel","maxLevel","EditorFontZoomIn","EditorZoom","setZoomLevel","getZoomLevel","EditorFontZoomOut","EditorFontZoomReset","alertFormattingEdits","edits","edit","plusRange","alert","getRealAndSyntheticDocumentFormattersOrdered","documentFormattingEditProvider","documentRangeFormattingEditProvider","seen","ExtensionIdentifierSet","docFormatter","formatter","extensionId","rangeFormatter","has","displayName","provideDocumentFormattingEdits","provideDocumentRangeFormattingEdits","getFullModelRange","FormattingConflicts","setFormatterSelector","selector","_selectors","unshift","select","document","mode","Iterable","first","formatDocumentRangesWithSelectedProvider","editorOrModel","rangeOrRanges","progress","instaService","IInstantiationService","documentRangeFormattingEditProviderRegistry","isCodeEditor","selected","report","invokeFunction","formatDocumentRangesWithProvider","workerService","IEditorWorkerService","logService","ILogService","cts","EditorStateCancellationTokenSource","TextModelCancellationTokenSource","asArray","compareRangesUsingStarts","areIntersectingOrTouching","fromPositions","getEndPosition","computeEdits","_c","_d","trace","getFormattingOptions","hasIntersectingEdit","mergedA","reduce","acc","val","x","intersectRanges","otherEdit","allEdits","rawEditsList","provideDocumentRangesFormattingEdits","j","mergedRange","splice","rawEdits","minimalEdits","computeMoreMinimalEdits","uri","FormattingEdit","execute","initialSelection","Selection","pushEditOperations","lift","forceMoveMarkers","undoEdits","formatDocumentWithSelectedProvider","formatDocumentWithProvider","getOnTypeFormattingEdits","ch","onTypeFormattingEditProvider","autoFormatTriggerCharacters","indexOf","provideOnTypeFormattingEdits","catch","LinkedList","assertType","isUri","isIRange","resolverService","ITextModelService","reference","createModelReference","isNonEmptyArray","getDocumentRangeFormattingEditsUntilResult","object","textEditorModel","_len2","_key2","getDocumentFormattingEditsUntilResult","_len3","_key3","Position","isIPosition","FormatOnType","_languageFeaturesService","_workerService","_disposables","_sessionDisposables","_update","onDidChangeModelLanguage","getOption","hasModel","support","triggerChars","CharacterSet","charCodeAt","onDidType","lastCharCode","_trigger","String","fromCharCode","isEmpty","CancellationTokenSource","unbind","isFlush","finally","FormatOnPaste","_instantiationService","_callOnDispose","_callOnModel","onDidPaste","_ref","Progress","FormatDocumentAction","ContextKeyExpr","and","notInCompositeEditor","writable","hasDocumentFormattingProvider","linux","contextMenuOpts","group","order","progressService","IEditorProgressService","showWhile","FormatSelectionAction","hasDocumentSelectionFormattingProvider","when","hasNonEmptySelection","ICodeEditorService","getFocusedCodeEditor","commandService","ICommandService","executeCommand","_handleEolEdits","newEol","singleEdits","eol","pushEOL","_isFullModelReplaceEdit","editRange","validateRange","equalsRange","_edits","addUndoStops","pushUndoStop","executeEdits","EditOperation","replace","replaceMove","restoreRelativeVerticalPositionOfCursor","MarkerCoordinate","marker","total","MarkerList","resourceFilter","_markerService","_configService","_dispoables","_markers","_nextIdx","_resourceFilter","compareOrder","compareMarker","compare","MarkerSeverity","severity","updateMarker","read","severities","Warning","Info","onMarkerChanged","uris","matches","_initIdx","fwd","found","idx","binarySearch","word","getWordAtPosition","containsPosition","isBeforeOrEqual","resetIndex","move","oldIdx","find","IMarkerService","IMarkerNavigationService","createDecorator","MarkerNavigationService","_provider","getMarkerList","registerSingleton","MessageWidget","onRelatedInformation","_openerService","_labelService","_lines","_longestLineLength","_relatedDiagnostics","WeakMap","domNode","createElement","_messageBlock","classList","setAttribute","appendChild","_relatedBlock","dom","preventDefault","related","_scrollable","ScrollableElement","horizontal","vertical","useShadows","horizontalScrollbarSize","verticalScrollbarSize","getDomNode","onScroll","style","left","scrollLeft","scrollTop","message","relatedInformation","code","sourceAndCodeLength","lines","splitLines","getAriaLabel","applyFontInfo","lastLineElement","innerText","height","lineHeight","detailsElement","sourceElement","codeElement","_codeLink","$","onclick","open","allowCommands","stopPropagation","relatedInformationNode","paddingTop","container","relatedResource","getUriBasenameLabel","title","getUriLabel","relatedMessage","fontInfo","scrollWidth","typicalFullwidthCharacterWidth","scrollHeight","setScrollDimensions","layout","width","getHeightInLines","severityLabel","Hint","ariaLabel","MarkerNavigationWidget","PeekViewWidget","_themeService","_menuService","instantiationService","_contextKeyService","showArrow","showFrame","isAccessible","frameWidth","_onDidSelectRelatedInformation","onDidSelectRelatedInformation","_severity","_backgroundColor","Color","white","_applyTheme","getColorTheme","onDidColorThemeChange","bind","create","theme","getColor","editorMarkerNavigationBackground","colorId","editorMarkerNavigationError","headerBackground","editorMarkerNavigationErrorHeader","editorMarkerNavigationWarning","editorMarkerNavigationWarningHeader","editorMarkerNavigationInfo","editorMarkerNavigationInfoHeader","frameColor","headerBg","arrowColor","headerBackgroundColor","primaryHeadingColor","peekViewTitleForeground","secondaryHeadingColor","peekViewTitleInfoForeground","_applyStyles","_parentContainer","backgroundColor","_fillHead","_actionbarWidget","actionRunner","onWillRun","focus","actions","menu","createMenu","TitleMenu","createAndFillInActionBarActions","icon","_fillTitleIcon","_icon","_fillBody","tabIndex","_container","_message","show","showAtMarker","markerIdx","markerCount","remove","editorPosition","computeRequiredHeight","setTitle","basename","SeverityIcon","toSeverity","revealPositionNearTop","showStale","_relayout","_doLayoutBody","heightInPixel","widthInPixel","_heightInPixel","_onWidth","MenuId","IThemeService","IOpenerService","IMenuService","ILabelService","errorDefault","oneOf","editorErrorForeground","editorErrorBorder","warningDefault","editorWarningForeground","editorWarningBorder","infoDefault","editorInfoForeground","editorInfoBorder","contrastBorder","editorBackground","MarkerController","_markerNavigationService","_editorService","_sessionDispoables","_widgetVisible","CONTEXT_MARKERS_NAVIGATION_VISIBLE","_cleanUp","reset","_widget","_model","_getOrCreateModel","reusePosition","createInstance","onDidClose","close","info","openCodeEditor","pinned","revealIfOpened","collapseToStart","focusEditor","nagivate","multiFile","otherEditor","selectionRevealType","MarkerNavigationAction","_next","_multiFile","opts","NextMarkerAction","LABEL","menuOpts","menuId","arrowDown","PrevMarkerAction","arrowUp","MenubarGoMenu","comment","MarkerCommand","EditorCommand","bindToContribution","registerEditorCommand","handler","secondary","ctxHasSymbols","ISymbolNavigationService","SymbolNavigationService","_notificationService","_keybindingService","_currentModel","_currentIdx","_ignoreEditorChange","_ctxHasSymbols","_currentState","_currentMessage","put","anchor","refModel","references","_showMessage","editorState","EditorState","listener","getActiveCodeEditor","seenUri","seenPosition","isEqual","combinedDisposable","revealNext","kb","lookupKeybinding","getLabel","status","IKeybindingService","KeybindingsRegistry","registerCommandAndKeybindingRule","editorService","_listener","Map","onCodeEditorRemove","_onDidRemoveEditor","onCodeEditorAdd","_onDidAddEditor","listCodeEditors","forEach","values","delete","_e","_f","_g","_h","MenuRegistry","appendMenuItem","EditorContext","submenu","EditorContextPeek","SymbolNavigationAnchor","is","thing","corePosition","SymbolNavigationAction","EditorAction2","_allSymbolNavigationCommands","_patchConfig","assign","f1","item","wrap","configuration","arg","symbolNavService","promise","raceCancellation","_getLocationModel","altAction","ariaMessage","referenceAt","altActionId","_getAlternativeCommand","_activeAlternativeCommands","referenceCount","muteMessage","MessageController","showMessage","_getNoResultFoundMessage","_onResult","error","gotoLocation","_getGoToPreference","EmbeddedCodeEditorWidget","openInPeek","firstReference","peek","targetEditor","_openReference","openToSide","_openInPeek","sideBySide","highlight","isLocationLink","targetSelectionRange","selectionSource","modelNow","decorations","createDecorationsCollection","setTimeout","controller","ReferencesController","toggleWidget","Set","DefinitionAction","ReferencesModel","getDefinitionsAtPosition","definitionProvider","alternativeDefinitionCommand","multipleDefinitions","goToDefinitionKb","isWeb","isStandalone","registerAction2","GoToDefinitionAction","original","mnemonicTitle","hasDefinitionProvider","isInWalkThroughSnippet","toNegated","keybinding","registerCommandAlias","OpenDefinitionToSideAction","PeekDefinitionAction","PeekContext","notInPeekEditor","DeclarationAction","getDeclarationsAtPosition","declarationProvider","alternativeDeclarationCommand","multipleDeclarations","GoToDeclarationAction","hasDeclarationProvider","TypeDefinitionAction","getTypeDefinitionsAtPosition","typeDefinitionProvider","alternativeTypeDefinitionCommand","multipleTypeDefinitions","GoToTypeDefinitionAction","hasTypeDefinitionProvider","PeekTypeDefinitionAction","ImplementationAction","getImplementationsAtPosition","implementationProvider","alternativeImplementationCommand","multipleImplementations","GoToImplementationAction","hasImplementationProvider","PeekImplementationAction","ReferencesAction","alternativeReferenceCommand","multipleReferences","hasReferenceProvider","getReferencesAtPosition","referenceProvider","GenericGoToLocationAction","config","_references","_gotoMultipleBehaviour","_position","_token","multiple","noResultsMessage","setPosition","invokeWithinContext","command","Boolean","codeEditorService","control","getLocationLinks","registry","provide","coalesce","flat","provideDefinition","provideDeclaration","provideImplementation","provideTypeDefinition","compact","provideReferences","includeDeclaration","resultWithoutDeclaration","_sortedAndDeduped","rawLinks","modelLinks","ref","link","registerModelAndPositionCommand","hasModifier","modifier","ClickLinkMouseEvent","isLeftClick","isMiddleClick","isRightClick","rightButton","hasTriggerModifier","triggerModifier","hasSideBySideModifier","triggerSideBySideModifier","isNoneOrSingleMouseDown","ClickLinkKeyboardEvent","keyCodeIsTriggerKey","keyCode","triggerKey","keyCodeIsSideBySideKey","triggerSideBySideKey","ClickLinkOptions","equals","other","createOptions","multiCursorModifier","platform","ClickLinkGesture","alwaysFireOnMouseUp","_onMouseMoveOrRelevantKeyDown","onMouseMoveOrRelevantKeyDown","_onExecute","onExecute","_onCancel","onCancel","_alwaysFireExecuteOnMouseUp","_opts","_lastMouseMoveEvent","_hasTriggerKeyOnMouseDown","_lineNumberOnMouseDown","newOpts","onMouseMove","_onEditorMouseMove","_onEditorMouseDown","_onEditorMouseUp","onKeyDown","_onEditorKeyDown","onKeyUp","_onEditorKeyUp","onMouseDrag","_resetHandler","onDidChangeCursorSelection","_onDidChangeCursorSelection","onDidScrollChange","scrollTopChanged","scrollLeftChanged","mouseEvent","currentLineNumber","GotoDefinitionAtPositionEditorContribution","textModelResolverService","languageService","toUnhook","toUnhookForKeyboard","currentWordAtPosition","previousPromise","linkDecorations","linkGesture","keyboardEvent","startFindDefinitionFromMouse","withNullAsUndefined","isEnabled","gotoDefinition","removeLinkDecorations","startFindDefinitionFromCursor","startFindDefinition","withKey","results","findDefinition","validate","linkRange","originSelectionRange","combinedRange","addDecoration","MarkdownString","appendText","previewValue","getPreviewValue","languageId","guessLanguageIdByFilepathOrFirstLine","appendCodeblock","rangeToUse","MAX_SOURCE_PREVIEW_LINES","getPreviewRangeBasedOnIndentation","stripIndentationFromPreviewRange","previewRange","minIndent","getLineFirstNonWhitespaceColumn","endIndent","getValueInRange","trim","startIndent","hoverMessage","newDecorations","inlineClassName","injectedText","ModelDecorationInjectedTextOptions","canPeek","isInPeekEditor","inPeekEditor","ILanguageService","DataSource","_resolverService","hasChildren","FileReferences","getChildren","groups","children","Delegate","getHeight","getTemplateId","FileReferencesRenderer","OneReferenceRenderer","StringRepresentationProvider","getKeyboardNavigationLabel","OneReference","parts","getPreview","preview","IdentityProvider","getId","FileReferencesTemplate","file","IconLabel","supportHighlights","badge","CountBadge","defaultCountBadgeStyles","dirname","setLabel","relative","setCount","setTitleFormat","templateId","renderTemplate","renderElement","node","template","createMatches","filterData","disposeTemplate","templateData","OneReferenceTemplate","HighlightedLabel","score","FuzzyScore","isDefault","toggle","AccessibilityProvider","getWidgetAriaLabel","DecorationsManager","_decorations","_decorationIgnoreSet","_callOnModelChange","_onModelChanged","_addDecorations","onDidChangeDecorations","_onDecorationChanged","newDecorationsActualIndex","oneReference","DecorationOptions","changeAccessor","toRemove","decorationId","newRange","ignore","spansMultipleLines","keys","LayoutData","ratio","heightInLines","fromJSON","raw","JSON","parse","ReferencesTree","WorkbenchAsyncDataTree","ReferenceWidget","peekView","_defaultTreeKeyboardSupport","layoutData","themeService","_textModelResolverService","_peekViewService","_uriLabel","_undoRedoService","_languageService","_languageConfigurationService","isResizeable","supportOnTitleClick","_disposeOnNewModel","_onDidSelectReference","onDidSelectReference","_dim","addExclusiveWidget","setModel","_preview","_previewNotAvailableMessage","_tree","_previewModelReference","_splitView","borderColor","where","focusOnReferenceTree","domFocus","focusOnPreviewEditor","isPreviewEditorFocused","hasTextFocus","_onTitleClick","_getFocusedReference","ctrlKey","metaKey","containerElement","setCssClass","_messageContainer","SplitView","orientation","_previewContainer","scrollBeyondLastLine","scrollbar","verticalHasArrows","horizontalHasArrows","alwaysConsumeMouseWheel","overviewRulerLanes","fixedOverflowWidgets","enabled","TextModel","PLAINTEXT_LANGUAGE_ID","DEFAULT_CREATION_OPTIONS","_treeContainer","treeOptions","keyboardSupport","accessibilityProvider","keyboardNavigationLabelProvider","identityProvider","openOnSingleClick","selectionNavigation","overrideStyles","listBackground","dispatchEvent","addView","Event","minimumSize","maximumSize","Sizing","Distribute","onDidSashChange","getViewSize","onEvent","_revealReference","onDidOpen","editorOptions","_viewZone","resizeView","setFocus","newModel","_onNewModel","_decorationsManager","onDidChangeReferenceRange","rerender","setInput","getFocus","revealReference","revealParent","_revealedReference","scheme","Schemas","inMemory","basenameOrAuthority","getInput","expand","scrollType","sel","revealRangeInCenter","IUndoRedoService","ctxReferenceSearchVisible","_storageService","_configurationService","_requestIdPool","_ignoreModelChangeEvent","_referenceSearchVisible","modelPromise","peekMode","widgetPosition","closeWidget","_peekMode","storageKey","store","stringify","openReference","_gotoReference","requestId","setMetaTitle","pos","nearestReference","changeFocusBetweenPreviewAndReferences","goToNextOrPreviousReference","currentPosition","nextOrPreviousReference","editorFocus","previewEditorFocus","hide","openedEditor","clone","withController","fn","outerEditor","getOuterEditor","IStorageService","or","registerKeybindingRule","not","WorkbenchListFocusContextKey","WorkbenchTreeElementCanCollapse","negate","WorkbenchTreeElementCanExpand","IListService","lastFocusedList","isProviderFirst","_rangeCallback","defaultGenerator","nextId","_range","FilePreview","_modelReference","getWordUntilPosition","beforeRange","afterRange","before","inside","_previews","ResourceMap","child","fsPath","links","_onDidChangeReferenceRange","_links","_title","providersFirst","_compareReferences","extUri","oneRef","childCount","groupCount","nearest","prefixLen","strings","offsetDist","abs"],"sourceRoot":""}