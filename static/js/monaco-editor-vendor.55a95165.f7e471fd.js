"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[666],{34485:(e,i,t)=>{t.d(i,{CH:()=>l,CR:()=>a,D4:()=>d,u7:()=>s,xh:()=>n,yu:()=>r});class o{constructor(e,i){this._restrictedRenderingContextBrand=void 0,this._viewLayout=e,this.viewportData=i,this.scrollWidth=this._viewLayout.getScrollWidth(),this.scrollHeight=this._viewLayout.getScrollHeight(),this.visibleRange=this.viewportData.visibleRange,this.bigNumbersDelta=this.viewportData.bigNumbersDelta;const t=this._viewLayout.getCurrentViewport();this.scrollTop=t.top,this.scrollLeft=t.left,this.viewportWidth=t.width,this.viewportHeight=t.height}getScrolledTopFromAbsoluteTop(e){return e-this.scrollTop}getVerticalOffsetForLineNumber(e,i){return this._viewLayout.getVerticalOffsetForLineNumber(e,i)}getVerticalOffsetAfterLineNumber(e,i){return this._viewLayout.getVerticalOffsetAfterLineNumber(e,i)}getDecorationsInViewport(){return this.viewportData.getDecorationsInViewport()}}class n extends o{constructor(e,i,t){super(e,i),this._renderingContextBrand=void 0,this._viewLines=t}linesVisibleRangesForRange(e,i){return this._viewLines.linesVisibleRangesForRange(e,i)}visibleRangeForPosition(e){return this._viewLines.visibleRangeForPosition(e)}}class s{constructor(e,i,t){this.outsideRenderedLine=e,this.lineNumber=i,this.ranges=t}}class r{static from(e){const i=new Array(e.length);for(let t=0,o=e.length;t<o;t++){const o=e[t];i[t]=new r(o.left,o.width)}return i}constructor(e,i){this._horizontalRangeBrand=void 0,this.left=Math.round(e),this.width=Math.round(i)}toString(){return"[".concat(this.left,",").concat(this.width,"]")}}class a{constructor(e,i){this._floatHorizontalRangeBrand=void 0,this.left=e,this.width=i}toString(){return"[".concat(this.left,",").concat(this.width,"]")}static compare(e,i){return e.left-i.left}}class d{constructor(e,i){this.outsideRenderedLine=e,this.originalLeft=i,this.left=Math.round(this.originalLeft)}}class l{constructor(e,i){this.outsideRenderedLine=e,this.ranges=i}}},25157:(e,i,t)=>{t.d(i,{N:()=>r});var o=t(73731),n=t(99924),s=t(44352);class r{constructor(e,i,t,o){this.configuration=e,this.viewModel=i,this.userInputEvents=t,this.commandDelegate=o}paste(e,i,t,o){this.commandDelegate.paste(e,i,t,o)}type(e){this.commandDelegate.type(e)}compositionType(e,i,t,o){this.commandDelegate.compositionType(e,i,t,o)}compositionStart(){this.commandDelegate.startComposition()}compositionEnd(){this.commandDelegate.endComposition()}cut(){this.commandDelegate.cut()}setSelection(e){o.CoreNavigationCommands.SetSelection.runCoreEditorCommand(this.viewModel,{source:"keyboard",selection:e})}_validateViewColumn(e){const i=this.viewModel.getLineMinColumn(e.lineNumber);return e.column<i?new n.L(e.lineNumber,i):e}_hasMulticursorModifier(e){switch(this.configuration.options.get(75)){case"altKey":return e.altKey;case"ctrlKey":return e.ctrlKey;case"metaKey":return e.metaKey;default:return!1}}_hasNonMulticursorModifier(e){switch(this.configuration.options.get(75)){case"altKey":return e.ctrlKey||e.metaKey;case"ctrlKey":return e.altKey||e.metaKey;case"metaKey":return e.ctrlKey||e.altKey;default:return!1}}dispatchMouse(e){const i=this.configuration.options,t=s.IJ&&i.get(103),o=i.get(20);e.middleButton&&!t?this._columnSelect(e.position,e.mouseColumn,e.inSelectionMode):e.startedOnLineNumbers?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelect(e.position,e.revealType):this._createCursor(e.position,!0):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount>=4?this._selectAll():3===e.mouseDownCount?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelectDrag(e.position,e.revealType):this._lastCursorLineSelect(e.position,e.revealType):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):2===e.mouseDownCount?e.onInjectedText||(this._hasMulticursorModifier(e)?this._lastCursorWordSelect(e.position,e.revealType):e.inSelectionMode?this._wordSelectDrag(e.position,e.revealType):this._wordSelect(e.position,e.revealType)):this._hasMulticursorModifier(e)?this._hasNonMulticursorModifier(e)||(e.shiftKey?this._columnSelect(e.position,e.mouseColumn,!0):e.inSelectionMode?this._lastCursorMoveToSelect(e.position,e.revealType):this._createCursor(e.position,!1)):e.inSelectionMode?e.altKey||o?this._columnSelect(e.position,e.mouseColumn,!0):this._moveToSelect(e.position,e.revealType):this.moveTo(e.position,e.revealType)}_usualArgs(e,i){return e=this._validateViewColumn(e),{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,revealType:i}}moveTo(e,i){o.CoreNavigationCommands.MoveTo.runCoreEditorCommand(this.viewModel,this._usualArgs(e,i))}_moveToSelect(e,i){o.CoreNavigationCommands.MoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,i))}_columnSelect(e,i,t){e=this._validateViewColumn(e),o.CoreNavigationCommands.ColumnSelect.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,mouseColumn:i,doColumnSelect:t})}_createCursor(e,i){e=this._validateViewColumn(e),o.CoreNavigationCommands.CreateCursor.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,wholeLine:i})}_lastCursorMoveToSelect(e,i){o.CoreNavigationCommands.LastCursorMoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,i))}_wordSelect(e,i){o.CoreNavigationCommands.WordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,i))}_wordSelectDrag(e,i){o.CoreNavigationCommands.WordSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,i))}_lastCursorWordSelect(e,i){o.CoreNavigationCommands.LastCursorWordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,i))}_lineSelect(e,i){o.CoreNavigationCommands.LineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,i))}_lineSelectDrag(e,i){o.CoreNavigationCommands.LineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,i))}_lastCursorLineSelect(e,i){o.CoreNavigationCommands.LastCursorLineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,i))}_lastCursorLineSelectDrag(e,i){o.CoreNavigationCommands.LastCursorLineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,i))}_selectAll(){o.CoreNavigationCommands.SelectAll.runCoreEditorCommand(this.viewModel,{source:"mouse"})}_convertViewToModelPosition(e){return this.viewModel.coordinatesConverter.convertViewPositionToModelPosition(e)}emitKeyDown(e){this.userInputEvents.emitKeyDown(e)}emitKeyUp(e){this.userInputEvents.emitKeyUp(e)}emitContextMenu(e){this.userInputEvents.emitContextMenu(e)}emitMouseMove(e){this.userInputEvents.emitMouseMove(e)}emitMouseLeave(e){this.userInputEvents.emitMouseLeave(e)}emitMouseUp(e){this.userInputEvents.emitMouseUp(e)}emitMouseDown(e){this.userInputEvents.emitMouseDown(e)}emitMouseDrag(e){this.userInputEvents.emitMouseDrag(e)}emitMouseDrop(e){this.userInputEvents.emitMouseDrop(e)}emitMouseDropCanceled(){this.userInputEvents.emitMouseDropCanceled()}emitMouseWheel(e){this.userInputEvents.emitMouseWheel(e)}}},81514:(e,i,t)=>{t.d(i,{F:()=>a,G:()=>d});var o=t(86837),n=t(8071),s=t(33309),r=t(21531);class a{constructor(e){this._createLine=e,this._set(1,[])}flush(){this._set(1,[])}_set(e,i){this._lines=i,this._rendLineNumberStart=e}_get(){return{rendLineNumberStart:this._rendLineNumberStart,lines:this._lines}}getStartLineNumber(){return this._rendLineNumberStart}getEndLineNumber(){return this._rendLineNumberStart+this._lines.length-1}getCount(){return this._lines.length}getLine(e){const i=e-this._rendLineNumberStart;if(i<0||i>=this._lines.length)throw new s.he("Illegal value for lineNumber");return this._lines[i]}onLinesDeleted(e,i){if(0===this.getCount())return null;const t=this.getStartLineNumber(),o=this.getEndLineNumber();if(i<t){const t=i-e+1;return this._rendLineNumberStart-=t,null}if(e>o)return null;let n=0,s=0;for(let r=t;r<=o;r++){const t=r-this._rendLineNumberStart;e<=r&&r<=i&&(0===s?(n=t,s=1):s++)}if(e<t){let o=0;o=i<t?i-e+1:t-e,this._rendLineNumberStart-=o}return this._lines.splice(n,s)}onLinesChanged(e,i){const t=e+i-1;if(0===this.getCount())return!1;const o=this.getStartLineNumber(),n=this.getEndLineNumber();let s=!1;for(let r=e;r<=t;r++)r>=o&&r<=n&&(this._lines[r-this._rendLineNumberStart].onContentChanged(),s=!0);return s}onLinesInserted(e,i){if(0===this.getCount())return null;const t=i-e+1,o=this.getStartLineNumber(),n=this.getEndLineNumber();if(e<=o)return this._rendLineNumberStart+=t,null;if(e>n)return null;if(t+e>n){return this._lines.splice(e-this._rendLineNumberStart,n-e+1)}const s=[];for(let h=0;h<t;h++)s[h]=this._createLine();const r=e-this._rendLineNumberStart,a=this._lines.slice(0,r),d=this._lines.slice(r,this._lines.length-t),l=this._lines.slice(this._lines.length-t,this._lines.length);return this._lines=a.concat(s).concat(d),l}onTokensChanged(e){if(0===this.getCount())return!1;const i=this.getStartLineNumber(),t=this.getEndLineNumber();let o=!1;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.toLineNumber<i||s.fromLineNumber>t)continue;const r=Math.max(i,s.fromLineNumber),a=Math.min(t,s.toLineNumber);for(let e=r;e<=a;e++){const i=e-this._rendLineNumberStart;this._lines[i].onTokensChanged(),o=!0}}return o}}class d{constructor(e){this._host=e,this.domNode=this._createDomNode(),this._linesCollection=new a((()=>this._host.createVisibleLine()))}_createDomNode(){const e=(0,o.X)(document.createElement("div"));return e.setClassName("view-layer"),e.setPosition("absolute"),e.domNode.setAttribute("role","presentation"),e.domNode.setAttribute("aria-hidden","true"),e}onConfigurationChanged(e){return!!e.hasChanged(140)}onFlushed(e){return this._linesCollection.flush(),!0}onLinesChanged(e){return this._linesCollection.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){const i=this._linesCollection.onLinesDeleted(e.fromLineNumber,e.toLineNumber);if(i)for(let t=0,o=i.length;t<o;t++){const e=i[t].getDomNode();e&&this.domNode.domNode.removeChild(e)}return!0}onLinesInserted(e){const i=this._linesCollection.onLinesInserted(e.fromLineNumber,e.toLineNumber);if(i)for(let t=0,o=i.length;t<o;t++){const e=i[t].getDomNode();e&&this.domNode.domNode.removeChild(e)}return!0}onScrollChanged(e){return e.scrollTopChanged}onTokensChanged(e){return this._linesCollection.onTokensChanged(e.ranges)}onZonesChanged(e){return!0}getStartLineNumber(){return this._linesCollection.getStartLineNumber()}getEndLineNumber(){return this._linesCollection.getEndLineNumber()}getVisibleLine(e){return this._linesCollection.getLine(e)}renderLines(e){const i=this._linesCollection._get(),t=new l(this.domNode.domNode,this._host,e),o={rendLineNumberStart:i.rendLineNumberStart,lines:i.lines,linesLength:i.lines.length},n=t.render(o,e.startLineNumber,e.endLineNumber,e.relativeVerticalOffset);this._linesCollection._set(n.rendLineNumberStart,n.lines)}}class l{constructor(e,i,t){this.domNode=e,this.host=i,this.viewportData=t}render(e,i,t,o){const n={rendLineNumberStart:e.rendLineNumberStart,lines:e.lines.slice(0),linesLength:e.linesLength};if(n.rendLineNumberStart+n.linesLength-1<i||t<n.rendLineNumberStart){n.rendLineNumberStart=i,n.linesLength=t-i+1,n.lines=[];for(let e=i;e<=t;e++)n.lines[e-i]=this.host.createVisibleLine();return this._finishRendering(n,!0,o),n}if(this._renderUntouchedLines(n,Math.max(i-n.rendLineNumberStart,0),Math.min(t-n.rendLineNumberStart,n.linesLength-1),o,i),n.rendLineNumberStart>i){const e=i,s=Math.min(t,n.rendLineNumberStart-1);e<=s&&(this._insertLinesBefore(n,e,s,o,i),n.linesLength+=s-e+1)}else if(n.rendLineNumberStart<i){const e=Math.min(n.linesLength,i-n.rendLineNumberStart);e>0&&(this._removeLinesBefore(n,e),n.linesLength-=e)}if(n.rendLineNumberStart=i,n.rendLineNumberStart+n.linesLength-1<t){const e=n.rendLineNumberStart+n.linesLength,s=t;e<=s&&(this._insertLinesAfter(n,e,s,o,i),n.linesLength+=s-e+1)}else if(n.rendLineNumberStart+n.linesLength-1>t){const e=Math.max(0,t-n.rendLineNumberStart+1),i=n.linesLength-1-e+1;i>0&&(this._removeLinesAfter(n,i),n.linesLength-=i)}return this._finishRendering(n,!1,o),n}_renderUntouchedLines(e,i,t,o,n){const s=e.rendLineNumberStart,r=e.lines;for(let a=i;a<=t;a++){const e=s+a;r[a].layoutLine(e,o[e-n])}}_insertLinesBefore(e,i,t,o,n){const s=[];let r=0;for(let a=i;a<=t;a++)s[r++]=this.host.createVisibleLine();e.lines=s.concat(e.lines)}_removeLinesBefore(e,i){for(let t=0;t<i;t++){const i=e.lines[t].getDomNode();i&&this.domNode.removeChild(i)}e.lines.splice(0,i)}_insertLinesAfter(e,i,t,o,n){const s=[];let r=0;for(let a=i;a<=t;a++)s[r++]=this.host.createVisibleLine();e.lines=e.lines.concat(s)}_removeLinesAfter(e,i){const t=e.linesLength-i;for(let o=0;o<i;o++){const i=e.lines[t+o].getDomNode();i&&this.domNode.removeChild(i)}e.lines.splice(t,i)}_finishRenderingNewLines(e,i,t,o){l._ttPolicy&&(t=l._ttPolicy.createHTML(t));const n=this.domNode.lastChild;i||!n?this.domNode.innerHTML=t:n.insertAdjacentHTML("afterend",t);let s=this.domNode.lastChild;for(let r=e.linesLength-1;r>=0;r--){const i=e.lines[r];o[r]&&(i.setDomNode(s),s=s.previousSibling)}}_finishRenderingInvalidLines(e,i,t){const o=document.createElement("div");l._ttPolicy&&(i=l._ttPolicy.createHTML(i)),o.innerHTML=i;for(let n=0;n<e.linesLength;n++){const i=e.lines[n];if(t[n]){const e=o.firstChild,t=i.getDomNode();t.parentNode.replaceChild(e,t),i.setDomNode(e)}}}_finishRendering(e,i,t){const o=l._sb,n=e.linesLength,s=e.lines,r=e.rendLineNumberStart,a=[];{o.reset();let d=!1;for(let e=0;e<n;e++){const i=s[e];a[e]=!1;if(i.getDomNode())continue;i.renderLine(e+r,t[e],this.viewportData,o)&&(a[e]=!0,d=!0)}d&&this._finishRenderingNewLines(e,i,o.build(),a)}{o.reset();let i=!1;const d=[];for(let e=0;e<n;e++){const n=s[e];if(d[e]=!1,a[e])continue;n.renderLine(e+r,t[e],this.viewportData,o)&&(d[e]=!0,i=!0)}i&&this._finishRenderingInvalidLines(e,o.build(),d)}}}l._ttPolicy=(0,n.Z)("editorViewLayer",{createHTML:e=>e}),l._sb=new r.HT(1e5)},45739:(e,i,t)=>{t.d(i,{Ib:()=>h,Ip:()=>l});var o=t(86837),n=t(58314),s=t(81514),r=t(27113);class a extends r.E{constructor(e){super(e),this._visibleLines=new s.G(this),this.domNode=this._visibleLines.domNode;const i=this._context.configuration.options.get(48);(0,n.N)(this.domNode,i),this._dynamicOverlays=[],this._isFocused=!1,this.domNode.setClassName("view-overlays")}shouldRender(){if(super.shouldRender())return!0;for(let e=0,i=this._dynamicOverlays.length;e<i;e++){if(this._dynamicOverlays[e].shouldRender())return!0}return!1}dispose(){super.dispose();for(let e=0,i=this._dynamicOverlays.length;e<i;e++){this._dynamicOverlays[e].dispose()}this._dynamicOverlays=[]}getDomNode(){return this.domNode}createVisibleLine(){return new d(this._context.configuration,this._dynamicOverlays)}addDynamicOverlay(e){this._dynamicOverlays.push(e)}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e);const i=this._visibleLines.getStartLineNumber(),t=this._visibleLines.getEndLineNumber();for(let n=i;n<=t;n++){this._visibleLines.getVisibleLine(n).onConfigurationChanged(e)}const o=this._context.configuration.options.get(48);return(0,n.N)(this.domNode,o),!0}onFlushed(e){return this._visibleLines.onFlushed(e)}onFocusChanged(e){return this._isFocused=e.isFocused,!0}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onScrollChanged(e){return this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._visibleLines.onZonesChanged(e)}prepareRender(e){const i=this._dynamicOverlays.filter((e=>e.shouldRender()));for(let t=0,o=i.length;t<o;t++){const o=i[t];o.prepareRender(e),o.onDidRender()}}render(e){this._viewOverlaysRender(e),this.domNode.toggleClassName("focused",this._isFocused)}_viewOverlaysRender(e){this._visibleLines.renderLines(e.viewportData)}}class d{constructor(e,i){this._configuration=e,this._lineHeight=this._configuration.options.get(64),this._dynamicOverlays=i,this._domNode=null,this._renderedContent=null}getDomNode(){return this._domNode?this._domNode.domNode:null}setDomNode(e){this._domNode=(0,o.X)(e)}onContentChanged(){}onTokensChanged(){}onConfigurationChanged(e){this._lineHeight=this._configuration.options.get(64)}renderLine(e,i,t,o){let n="";for(let s=0,r=this._dynamicOverlays.length;s<r;s++){n+=this._dynamicOverlays[s].render(t.startLineNumber,e)}return this._renderedContent!==n&&(this._renderedContent=n,o.appendString('<div style="position:absolute;top:'),o.appendString(String(i)),o.appendString("px;width:100%;height:"),o.appendString(String(this._lineHeight)),o.appendString('px;">'),o.appendString(n),o.appendString("</div>"),!0)}layoutLine(e,i){this._domNode&&(this._domNode.setTop(i),this._domNode.setHeight(this._lineHeight))}}class l extends a{constructor(e){super(e);const i=this._context.configuration.options.get(140);this._contentWidth=i.contentWidth,this.domNode.setHeight(0)}onConfigurationChanged(e){const i=this._context.configuration.options.get(140);return this._contentWidth=i.contentWidth,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollWidthChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e),this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth))}}class h extends a{constructor(e){super(e);const i=this._context.configuration.options,t=i.get(140);this._contentLeft=t.contentLeft,this.domNode.setClassName("margin-view-overlays"),this.domNode.setWidth(1),(0,n.N)(this.domNode,i.get(48))}onConfigurationChanged(e){const i=this._context.configuration.options;(0,n.N)(this.domNode,i.get(48));const t=i.get(140);return this._contentLeft=t.contentLeft,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollHeightChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e);const i=Math.min(e.scrollHeight,1e6);this.domNode.setHeight(i),this.domNode.setWidth(this._contentLeft)}}},27113:(e,i,t)=>{t.d(i,{E:()=>n,K:()=>s});var o=t(80629);class n extends o.O{constructor(e){super(),this._context=e,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}}class s{static write(e,i){e.setAttribute("data-mprt",String(i))}static read(e){const i=e.getAttribute("data-mprt");return null===i?0:parseInt(i,10)}static collect(e,i){const t=[];let o=0;for(;e&&e!==document.body&&e!==i;)e.nodeType===e.ELEMENT_NODE&&(t[o++]=this.read(e)),e=e.parentElement;const n=new Uint8Array(o);for(let s=0;s<o;s++)n[s]=t[o-s-1];return n}}},97461:(e,i,t)=>{t.d(i,{q:()=>n});var o=t(99924);class n{constructor(e){this.onKeyDown=null,this.onKeyUp=null,this.onContextMenu=null,this.onMouseMove=null,this.onMouseLeave=null,this.onMouseDown=null,this.onMouseUp=null,this.onMouseDrag=null,this.onMouseDrop=null,this.onMouseDropCanceled=null,this.onMouseWheel=null,this._coordinatesConverter=e}emitKeyDown(e){var i;null===(i=this.onKeyDown)||void 0===i||i.call(this,e)}emitKeyUp(e){var i;null===(i=this.onKeyUp)||void 0===i||i.call(this,e)}emitContextMenu(e){var i;null===(i=this.onContextMenu)||void 0===i||i.call(this,this._convertViewToModelMouseEvent(e))}emitMouseMove(e){var i;null===(i=this.onMouseMove)||void 0===i||i.call(this,this._convertViewToModelMouseEvent(e))}emitMouseLeave(e){var i;null===(i=this.onMouseLeave)||void 0===i||i.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDown(e){var i;null===(i=this.onMouseDown)||void 0===i||i.call(this,this._convertViewToModelMouseEvent(e))}emitMouseUp(e){var i;null===(i=this.onMouseUp)||void 0===i||i.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDrag(e){var i;null===(i=this.onMouseDrag)||void 0===i||i.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDrop(e){var i;null===(i=this.onMouseDrop)||void 0===i||i.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDropCanceled(){var e;null===(e=this.onMouseDropCanceled)||void 0===e||e.call(this)}emitMouseWheel(e){var i;null===(i=this.onMouseWheel)||void 0===i||i.call(this,e)}_convertViewToModelMouseEvent(e){return e.target?{event:e.event,target:this._convertViewToModelMouseTarget(e.target)}:e}_convertViewToModelMouseTarget(e){return n.convertViewToModelMouseTarget(e,this._coordinatesConverter)}static convertViewToModelMouseTarget(e,i){const t=Object.assign({},e);return t.position&&(t.position=i.convertViewPositionToModelPosition(t.position)),t.range&&(t.range=i.convertViewRangeToModelRange(t.range)),5!==t.type&&8!==t.type||(t.detail=this.convertViewToModelViewZoneData(t.detail,i)),t}static convertViewToModelViewZoneData(e,i){return{viewZoneId:e.viewZoneId,positionBefore:e.positionBefore?i.convertViewPositionToModelPosition(e.positionBefore):e.positionBefore,positionAfter:e.positionAfter?i.convertViewPositionToModelPosition(e.positionAfter):e.positionAfter,position:i.convertViewPositionToModelPosition(e.position),afterLineNumber:i.convertViewPositionToModelPosition(new o.L(e.afterLineNumber,1)).lineNumber}}}},21290:(e,i,t)=>{t.d(i,{Gm:()=>j});t(22025);var o=t(26511),n=t(20494),s=t(33309),r=t(68515),a=t(59652),d=t(46946),l=t(30545),h=t(33344),u=t(3527),c=t(4888),g=t(97461),m=t(77116),_=t(20596),f=t(99924),v=t(55597),p=t(80253),C=t(2032),D=t(77734),w=t(90567),b=t(13101),L=t(78873),S=t(24999),N=t(11213),E=t(39049),y=t(10071),M=t(22046),R=t(94175),I=t(37709),T=t(58023),O=t(65429),x=t(71923),P=t(16023),V=t(18022),W=t(51631),F=t(41598),A=t(58314),H=t(90024),k=t(37368);class z extends a.JT{constructor(){super(),this._editor=null,this._instantiationService=null,this._instances=this._register(new a.b2),this._pending=new Map,this._finishedInstantiation=[],this._finishedInstantiation[0]=!1,this._finishedInstantiation[1]=!1,this._finishedInstantiation[2]=!1,this._finishedInstantiation[3]=!1}initialize(e,i,t){this._editor=e,this._instantiationService=t;for(const o of i)this._pending.has(o.id)?(0,s.dL)(new Error("Cannot have two contributions with the same id ".concat(o.id))):this._pending.set(o.id,o);this._instantiateSome(0),this._register((0,k.To)((()=>{this._instantiateSome(1)}))),this._register((0,k.To)((()=>{this._instantiateSome(2)}))),this._register((0,k.To)((()=>{this._instantiateSome(3)}),5e3))}saveViewState(){const e={};for(const[i,t]of this._instances)"function"===typeof t.saveViewState&&(e[i]=t.saveViewState());return e}restoreViewState(e){for(const[i,t]of this._instances)"function"===typeof t.restoreViewState&&t.restoreViewState(e[i])}get(e){return this._instantiateById(e),this._instances.get(e)||null}onBeforeInteractionEvent(){this._instantiateSome(2)}onAfterModelAttached(){this._register((0,k.To)((()=>{this._instantiateSome(1)}),50))}_instantiateSome(e){if(this._finishedInstantiation[e])return;this._finishedInstantiation[e]=!0;const i=this._findPendingContributionsByInstantiation(e);for(const t of i)this._instantiateById(t.id)}_findPendingContributionsByInstantiation(e){const i=[];for(const[,t]of this._pending)t.instantiation===e&&i.push(t);return i}_instantiateById(e){const i=this._pending.get(e);if(i){if(this._pending.delete(e),!this._instantiationService||!this._editor)throw new Error("Cannot instantiate contributions before being initialized!");try{const e=this._instantiationService.createInstance(i.ctor,this._editor);this._instances.set(i.id,e),"function"===typeof e.restoreViewState&&0!==i.instantiation&&console.warn("Editor contribution '".concat(i.id,"' should be eager instantiated because it uses saveViewState / restoreViewState."))}catch(t){(0,s.dL)(t)}}}}var U=t(30264),B=function(e,i,t,o){var n,s=arguments.length,r=s<3?i:null===o?o=Object.getOwnPropertyDescriptor(i,t):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,i,t,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(r=(s<3?n(r):s>3?n(i,t,r):n(i,t))||r);return s>3&&r&&Object.defineProperty(i,t,r),r},Q=function(e,i){return function(t,o){i(t,o,e)}},Z=function(e,i,t,o){return new(t||(t=Promise))((function(n,s){function r(e){try{d(o.next(e))}catch(i){s(i)}}function a(e){try{d(o.throw(e))}catch(i){s(i)}}function d(e){var i;e.done?n(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(r,a)}d((o=o.apply(e,i||[])).next())}))};let K=0;class q{constructor(e,i,t,o,n,s){this.model=e,this.viewModel=i,this.view=t,this.hasRealView=o,this.listenersToRemove=n,this.attachedView=s}dispose(){(0,a.B9)(this.listenersToRemove),this.model.onBeforeDetached(this.attachedView),this.hasRealView&&this.view.dispose(),this.viewModel.dispose()}}let j=class e extends a.JT{get isSimpleWidget(){return this._configuration.isSimpleWidget}constructor(e,i,t,o,a,d,l,u,c,g,m,_){super(),this.languageConfigurationService=m,this._deliveryQueue=new r.F3,this._contributions=this._register(new z),this._onDidDispose=this._register(new r.Q5),this.onDidDispose=this._onDidDispose.event,this._onDidChangeModelContent=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelContent=this._onDidChangeModelContent.event,this._onDidChangeModelLanguage=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelLanguage=this._onDidChangeModelLanguage.event,this._onDidChangeModelLanguageConfiguration=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelLanguageConfiguration=this._onDidChangeModelLanguageConfiguration.event,this._onDidChangeModelOptions=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelOptions=this._onDidChangeModelOptions.event,this._onDidChangeModelDecorations=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelDecorations=this._onDidChangeModelDecorations.event,this._onDidChangeModelTokens=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelTokens=this._onDidChangeModelTokens.event,this._onDidChangeConfiguration=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this._onDidChangeModel=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeModel=this._onDidChangeModel.event,this._onDidChangeCursorPosition=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeCursorPosition=this._onDidChangeCursorPosition.event,this._onDidChangeCursorSelection=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeCursorSelection=this._onDidChangeCursorSelection.event,this._onDidAttemptReadOnlyEdit=this._register(new X(this._contributions,this._deliveryQueue)),this.onDidAttemptReadOnlyEdit=this._onDidAttemptReadOnlyEdit.event,this._onDidLayoutChange=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidLayoutChange=this._onDidLayoutChange.event,this._editorTextFocus=this._register(new J({deliveryQueue:this._deliveryQueue})),this.onDidFocusEditorText=this._editorTextFocus.onDidChangeToTrue,this.onDidBlurEditorText=this._editorTextFocus.onDidChangeToFalse,this._editorWidgetFocus=this._register(new J({deliveryQueue:this._deliveryQueue})),this.onDidFocusEditorWidget=this._editorWidgetFocus.onDidChangeToTrue,this.onDidBlurEditorWidget=this._editorWidgetFocus.onDidChangeToFalse,this._onWillType=this._register(new X(this._contributions,this._deliveryQueue)),this.onWillType=this._onWillType.event,this._onDidType=this._register(new X(this._contributions,this._deliveryQueue)),this.onDidType=this._onDidType.event,this._onDidCompositionStart=this._register(new X(this._contributions,this._deliveryQueue)),this.onDidCompositionStart=this._onDidCompositionStart.event,this._onDidCompositionEnd=this._register(new X(this._contributions,this._deliveryQueue)),this.onDidCompositionEnd=this._onDidCompositionEnd.event,this._onDidPaste=this._register(new X(this._contributions,this._deliveryQueue)),this.onDidPaste=this._onDidPaste.event,this._onMouseUp=this._register(new X(this._contributions,this._deliveryQueue)),this.onMouseUp=this._onMouseUp.event,this._onMouseDown=this._register(new X(this._contributions,this._deliveryQueue)),this.onMouseDown=this._onMouseDown.event,this._onMouseDrag=this._register(new X(this._contributions,this._deliveryQueue)),this.onMouseDrag=this._onMouseDrag.event,this._onMouseDrop=this._register(new X(this._contributions,this._deliveryQueue)),this.onMouseDrop=this._onMouseDrop.event,this._onMouseDropCanceled=this._register(new X(this._contributions,this._deliveryQueue)),this.onMouseDropCanceled=this._onMouseDropCanceled.event,this._onDropIntoEditor=this._register(new X(this._contributions,this._deliveryQueue)),this.onDropIntoEditor=this._onDropIntoEditor.event,this._onContextMenu=this._register(new X(this._contributions,this._deliveryQueue)),this.onContextMenu=this._onContextMenu.event,this._onMouseMove=this._register(new X(this._contributions,this._deliveryQueue)),this.onMouseMove=this._onMouseMove.event,this._onMouseLeave=this._register(new X(this._contributions,this._deliveryQueue)),this.onMouseLeave=this._onMouseLeave.event,this._onMouseWheel=this._register(new X(this._contributions,this._deliveryQueue)),this.onMouseWheel=this._onMouseWheel.event,this._onKeyUp=this._register(new X(this._contributions,this._deliveryQueue)),this.onKeyUp=this._onKeyUp.event,this._onKeyDown=this._register(new X(this._contributions,this._deliveryQueue)),this.onKeyDown=this._onKeyDown.event,this._onDidContentSizeChange=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidContentSizeChange=this._onDidContentSizeChange.event,this._onDidScrollChange=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidScrollChange=this._onDidScrollChange.event,this._onDidChangeViewZones=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeViewZones=this._onDidChangeViewZones.event,this._onDidChangeHiddenAreas=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeHiddenAreas=this._onDidChangeHiddenAreas.event,this._actions=new Map,this._bannerDomNode=null,this._dropIntoEditorDecorations=this.createDecorationsCollection(),a.willCreateCodeEditor();const f=Object.assign({},i);let v;this._domElement=e,this._overflowWidgetsDomNode=f.overflowWidgetsDomNode,delete f.overflowWidgetsDomNode,this._id=++K,this._decorationTypeKeysToIds={},this._decorationTypeSubtypes={},this._telemetryData=t.telemetryData,this._configuration=this._register(this._createConfiguration(t.isSimpleWidget||!1,f,g)),this._register(this._configuration.onDidChange((e=>{this._onDidChangeConfiguration.fire(e);const i=this._configuration.options;if(e.hasChanged(140)){const e=i.get(140);this._onDidLayoutChange.fire(e)}}))),this._contextKeyService=this._register(l.createScoped(this._domElement)),this._notificationService=c,this._codeEditorService=a,this._commandService=d,this._themeService=u,this._register(new Y(this,this._contextKeyService)),this._register(new G(this,this._contextKeyService,_)),this._instantiationService=o.createChild(new R.y([y.i6,this._contextKeyService])),this._modelData=null,this._focusTracker=new $(e),this._register(this._focusTracker.onChange((()=>{this._editorWidgetFocus.setValue(this._focusTracker.hasFocus())}))),this._contentWidgets={},this._overlayWidgets={},v=Array.isArray(t.contributions)?t.contributions:h.Uc.getEditorContributions(),this._contributions.initialize(this,v,this._instantiationService);for(const n of h.Uc.getEditorActions()){if(this._actions.has(n.id)){(0,s.dL)(new Error("Cannot have two actions with the same id ".concat(n.id)));continue}const e=new C.p(n.id,n.label,n.alias,(0,x.f6)(n.precondition),(()=>this._instantiationService.invokeFunction((e=>Promise.resolve(n.runEditorCommand(e,this,null))))),this._contextKeyService);this._actions.set(e.id,e)}const p=()=>!this._configuration.options.get(88)&&this._configuration.options.get(34).enabled;this._register(new n.eg(this._domElement,{onDragEnter:()=>{},onDragOver:e=>{if(!p())return;const i=this.getTargetAtClientPoint(e.clientX,e.clientY);(null===i||void 0===i?void 0:i.position)&&this.showDropIndicatorAt(i.position)},onDrop:e=>Z(this,void 0,void 0,(function*(){if(!p())return;if(this.removeDropIndicator(),!e.dataTransfer)return;const i=this.getTargetAtClientPoint(e.clientX,e.clientY);(null===i||void 0===i?void 0:i.position)&&this._onDropIntoEditor.fire({position:i.position,event:e})})),onDragLeave:()=>{this.removeDropIndicator()},onDragEnd:()=>{this.removeDropIndicator()}})),this._codeEditorService.addCodeEditor(this)}writeScreenReaderContent(e){var i;null===(i=this._modelData)||void 0===i||i.view.writeScreenReaderContent(e)}_createConfiguration(e,i,t){return new l.z(e,i,this._domElement,t)}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return D.g.ICodeEditor}dispose(){this._codeEditorService.removeCodeEditor(this),this._focusTracker.dispose(),this._actions.clear(),this._contentWidgets={},this._overlayWidgets={},this._removeDecorationTypes(),this._postDetachModelCleanup(this._detachModel()),this._onDidDispose.fire(),super.dispose()}invokeWithinContext(e){return this._instantiationService.invokeFunction(e)}updateOptions(e){this._configuration.updateOptions(e||{})}getOptions(){return this._configuration.options}getOption(e){return this._configuration.options.get(e)}getRawOptions(){return this._configuration.getRawOptions()}getOverflowWidgetsDomNode(){return this._overflowWidgetsDomNode}getConfiguredWordAtPosition(e){return this._modelData?W.w.getWordAtPosition(this._modelData.model,this._configuration.options.get(126),e):null}getValue(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!this._modelData)return"";const i=!(!e||!e.preserveBOM);let t=0;return e&&e.lineEnding&&"\n"===e.lineEnding?t=1:e&&e.lineEnding&&"\r\n"===e.lineEnding&&(t=2),this._modelData.model.getValue(t,i)}setValue(e){this._modelData&&this._modelData.model.setValue(e)}getModel(){return this._modelData?this._modelData.model:null}setModel(){const e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null===this._modelData&&null===e)return;if(this._modelData&&this._modelData.model===e)return;const i=this.hasTextFocus(),t=this._detachModel();this._attachModel(e),i&&this.hasModel()&&this.focus();const o={oldModelUrl:t?t.uri:null,newModelUrl:e?e.uri:null};this._removeDecorationTypes(),this._onDidChangeModel.fire(o),this._postDetachModelCleanup(t),this._contributions.onAfterModelAttached()}_removeDecorationTypes(){if(this._decorationTypeKeysToIds={},this._decorationTypeSubtypes){for(const e in this._decorationTypeSubtypes){const i=this._decorationTypeSubtypes[e];for(const t in i)this._removeDecorationType(e+"-"+t)}this._decorationTypeSubtypes={}}}getVisibleRanges(){return this._modelData?this._modelData.viewModel.getVisibleRanges():[]}getVisibleRangesPlusViewportAboveBelow(){return this._modelData?this._modelData.viewModel.getVisibleRangesPlusViewportAboveBelow():[]}getWhitespaces(){return this._modelData?this._modelData.viewModel.viewLayout.getWhitespaces():[]}static _getVerticalOffsetAfterPosition(e,i,t,o){const n=e.model.validatePosition({lineNumber:i,column:t}),s=e.viewModel.coordinatesConverter.convertModelPositionToViewPosition(n);return e.viewModel.viewLayout.getVerticalOffsetAfterLineNumber(s.lineNumber,o)}getTopForLineNumber(i){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._modelData?e._getVerticalOffsetForPosition(this._modelData,i,1,t):-1}getTopForPosition(i,t){return this._modelData?e._getVerticalOffsetForPosition(this._modelData,i,t,!1):-1}static _getVerticalOffsetForPosition(e,i,t){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const n=e.model.validatePosition({lineNumber:i,column:t}),s=e.viewModel.coordinatesConverter.convertModelPositionToViewPosition(n);return e.viewModel.viewLayout.getVerticalOffsetForLineNumber(s.lineNumber,o)}getBottomForLineNumber(i){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._modelData?e._getVerticalOffsetAfterPosition(this._modelData,i,1,t):-1}setHiddenAreas(e,i){var t;null===(t=this._modelData)||void 0===t||t.viewModel.setHiddenAreas(e.map((e=>v.e.lift(e))),i)}getVisibleColumnFromPosition(e){if(!this._modelData)return e.column;const i=this._modelData.model.validatePosition(e),t=this._modelData.model.getOptions().tabSize;return _.i.visibleColumnFromColumn(this._modelData.model.getLineContent(i.lineNumber),i.column,t)+1}getPosition(){return this._modelData?this._modelData.viewModel.getPosition():null}setPosition(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";if(this._modelData){if(!f.L.isIPosition(e))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(i,[{selectionStartLineNumber:e.lineNumber,selectionStartColumn:e.column,positionLineNumber:e.lineNumber,positionColumn:e.column}])}}_sendRevealRange(e,i,t,o){if(!this._modelData)return;if(!v.e.isIRange(e))throw new Error("Invalid arguments");const n=this._modelData.model.validateRange(e),s=this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(n);this._modelData.viewModel.revealRange("api",t,s,i,o)}revealLine(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._revealLine(e,0,i)}revealLineInCenter(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._revealLine(e,1,i)}revealLineInCenterIfOutsideViewport(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._revealLine(e,2,i)}revealLineNearTop(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._revealLine(e,5,i)}_revealLine(e,i,t){if("number"!==typeof e)throw new Error("Invalid arguments");this._sendRevealRange(new v.e(e,1,e,1),i,!1,t)}revealPosition(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._revealPosition(e,0,!0,i)}revealPositionInCenter(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._revealPosition(e,1,!0,i)}revealPositionInCenterIfOutsideViewport(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._revealPosition(e,2,!0,i)}revealPositionNearTop(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._revealPosition(e,5,!0,i)}_revealPosition(e,i,t,o){if(!f.L.isIPosition(e))throw new Error("Invalid arguments");this._sendRevealRange(new v.e(e.lineNumber,e.column,e.lineNumber,e.column),i,t,o)}getSelection(){return this._modelData?this._modelData.viewModel.getSelection():null}getSelections(){return this._modelData?this._modelData.viewModel.getSelections():null}setSelection(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";const t=p.Y.isISelection(e),o=v.e.isIRange(e);if(!t&&!o)throw new Error("Invalid arguments");if(t)this._setSelectionImpl(e,i);else if(o){const t={selectionStartLineNumber:e.startLineNumber,selectionStartColumn:e.startColumn,positionLineNumber:e.endLineNumber,positionColumn:e.endColumn};this._setSelectionImpl(t,i)}}_setSelectionImpl(e,i){if(!this._modelData)return;const t=new p.Y(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn);this._modelData.viewModel.setSelections(i,[t])}revealLines(e,i){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._revealLines(e,i,0,t)}revealLinesInCenter(e,i){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._revealLines(e,i,1,t)}revealLinesInCenterIfOutsideViewport(e,i){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._revealLines(e,i,2,t)}revealLinesNearTop(e,i){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._revealLines(e,i,5,t)}_revealLines(e,i,t,o){if("number"!==typeof e||"number"!==typeof i)throw new Error("Invalid arguments");this._sendRevealRange(new v.e(e,1,i,1),t,!1,o)}revealRange(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this._revealRange(e,t?1:0,o,i)}revealRangeInCenter(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._revealRange(e,1,!0,i)}revealRangeInCenterIfOutsideViewport(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._revealRange(e,2,!0,i)}revealRangeNearTop(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._revealRange(e,5,!0,i)}revealRangeNearTopIfOutsideViewport(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._revealRange(e,6,!0,i)}revealRangeAtTop(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._revealRange(e,3,!0,i)}_revealRange(e,i,t,o){if(!v.e.isIRange(e))throw new Error("Invalid arguments");this._sendRevealRange(v.e.lift(e),i,t,o)}setSelections(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(this._modelData){if(!e||0===e.length)throw new Error("Invalid arguments");for(let i=0,t=e.length;i<t;i++)if(!p.Y.isISelection(e[i]))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(i,e,t)}}getContentWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getContentWidth():-1}getScrollWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollWidth():-1}getScrollLeft(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollLeft():-1}getContentHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getContentHeight():-1}getScrollHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollHeight():-1}getScrollTop(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollTop():-1}setScrollLeft(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(this._modelData){if("number"!==typeof e)throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollLeft:e},i)}}setScrollTop(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(this._modelData){if("number"!==typeof e)throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollTop:e},i)}}setScrollPosition(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this._modelData&&this._modelData.viewModel.viewLayout.setScrollPosition(e,i)}hasPendingScrollAnimation(){return!!this._modelData&&this._modelData.viewModel.viewLayout.hasPendingScrollAnimation()}saveViewState(){if(!this._modelData)return null;const e=this._contributions.saveViewState();return{cursorState:this._modelData.viewModel.saveCursorState(),viewState:this._modelData.viewModel.saveState(),contributionsState:e}}restoreViewState(e){if(!this._modelData||!this._modelData.hasRealView)return;const i=e;if(i&&i.cursorState&&i.viewState){const e=i.cursorState;Array.isArray(e)?e.length>0&&this._modelData.viewModel.restoreCursorState(e):this._modelData.viewModel.restoreCursorState([e]),this._contributions.restoreViewState(i.contributionsState||{});const t=this._modelData.viewModel.reduceRestoreState(i.viewState);this._modelData.view.restoreState(t)}}getContribution(e){return this._contributions.get(e)}getActions(){return Array.from(this._actions.values())}getSupportedActions(){let e=this.getActions();return e=e.filter((e=>e.isSupported())),e}getAction(e){return this._actions.get(e)||null}trigger(e,i,t){switch(t=t||{},i){case"compositionStart":return void this._startComposition();case"compositionEnd":return void this._endComposition(e);case"type":{const i=t;return void this._type(e,i.text||"")}case"replacePreviousChar":{const i=t;return void this._compositionType(e,i.text||"",i.replaceCharCnt||0,0,0)}case"compositionType":{const i=t;return void this._compositionType(e,i.text||"",i.replacePrevCharCnt||0,i.replaceNextCharCnt||0,i.positionDelta||0)}case"paste":{const i=t;return void this._paste(e,i.text||"",i.pasteOnNewLine||!1,i.multicursorText||null,i.mode||null)}case"cut":return void this._cut(e)}const o=this.getAction(i);o?Promise.resolve(o.run(t)).then(void 0,s.dL):this._modelData&&(this._triggerEditorCommand(e,i,t)||this._triggerCommand(i,t))}_triggerCommand(e,i){this._commandService.executeCommand(e,i)}_startComposition(){this._modelData&&(this._modelData.viewModel.startComposition(),this._onDidCompositionStart.fire())}_endComposition(e){this._modelData&&(this._modelData.viewModel.endComposition(e),this._onDidCompositionEnd.fire())}_type(e,i){this._modelData&&0!==i.length&&("keyboard"===e&&this._onWillType.fire(i),this._modelData.viewModel.type(i,e),"keyboard"===e&&this._onDidType.fire(i))}_compositionType(e,i,t,o,n){this._modelData&&this._modelData.viewModel.compositionType(i,t,o,n,e)}_paste(e,i,t,o,n){if(!this._modelData||0===i.length)return;const s=this._modelData.viewModel,r=s.getSelection().getStartPosition();s.paste(i,t,o,e);const a=s.getSelection().getStartPosition();"keyboard"===e&&this._onDidPaste.fire({range:new v.e(r.lineNumber,r.column,a.lineNumber,a.column),languageId:n})}_cut(e){this._modelData&&this._modelData.viewModel.cut(e)}_triggerEditorCommand(e,i,t){const o=h.Uc.getEditorCommand(i);return!!o&&((t=t||{}).source=e,this._instantiationService.invokeFunction((e=>{Promise.resolve(o.runEditorCommand(e,this,t)).then(void 0,s.dL)})),!0)}_getViewModel(){return this._modelData?this._modelData.viewModel:null}pushUndoStop(){return!!this._modelData&&(!this._configuration.options.get(88)&&(this._modelData.model.pushStackElement(),!0))}popUndoStop(){return!!this._modelData&&(!this._configuration.options.get(88)&&(this._modelData.model.popStackElement(),!0))}executeEdits(e,i,t){if(!this._modelData)return!1;if(this._configuration.options.get(88))return!1;let o;return o=t?Array.isArray(t)?()=>t:t:()=>null,this._modelData.viewModel.executeEdits(e,i,o),!0}executeCommand(e,i){this._modelData&&this._modelData.viewModel.executeCommand(i,e)}executeCommands(e,i){this._modelData&&this._modelData.viewModel.executeCommands(i,e)}createDecorationsCollection(e){return new ee(this,e)}changeDecorations(e){return this._modelData?this._modelData.model.changeDecorations(e,this._id):null}getLineDecorations(e){return this._modelData?this._modelData.model.getLineDecorations(e,this._id,(0,m.$J)(this._configuration.options)):null}getDecorationsInRange(e){return this._modelData?this._modelData.model.getDecorationsInRange(e,this._id,(0,m.$J)(this._configuration.options)):null}deltaDecorations(e,i){return this._modelData?0===e.length&&0===i.length?e:this._modelData.model.deltaDecorations(e,i,this._id):[]}removeDecorations(e){this._modelData&&0!==e.length&&this._modelData.model.changeDecorations((i=>{i.deltaDecorations(e,[])}))}removeDecorationsByType(e){const i=this._decorationTypeKeysToIds[e];i&&this.deltaDecorations(i,[]),this._decorationTypeKeysToIds.hasOwnProperty(e)&&delete this._decorationTypeKeysToIds[e],this._decorationTypeSubtypes.hasOwnProperty(e)&&delete this._decorationTypeSubtypes[e]}getLayoutInfo(){return this._configuration.options.get(140)}createOverviewRuler(e){return this._modelData&&this._modelData.hasRealView?this._modelData.view.createOverviewRuler(e):null}getContainerDomNode(){return this._domElement}getDomNode(){return this._modelData&&this._modelData.hasRealView?this._modelData.view.domNode.domNode:null}delegateVerticalScrollbarPointerDown(e){this._modelData&&this._modelData.hasRealView&&this._modelData.view.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){this._modelData&&this._modelData.hasRealView&&this._modelData.view.delegateScrollFromMouseWheelEvent(e)}layout(e){this._configuration.observeContainer(e),this.render()}focus(){this._modelData&&this._modelData.hasRealView&&this._modelData.view.focus()}hasTextFocus(){return!(!this._modelData||!this._modelData.hasRealView)&&this._modelData.view.isFocused()}hasWidgetFocus(){return this._focusTracker&&this._focusTracker.hasFocus()}addContentWidget(e){const i={widget:e,position:e.getPosition()};this._contentWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting a content widget with the same id."),this._contentWidgets[e.getId()]=i,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addContentWidget(i)}layoutContentWidget(e){const i=e.getId();if(this._contentWidgets.hasOwnProperty(i)){const t=this._contentWidgets[i];t.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutContentWidget(t)}}removeContentWidget(e){const i=e.getId();if(this._contentWidgets.hasOwnProperty(i)){const e=this._contentWidgets[i];delete this._contentWidgets[i],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeContentWidget(e)}}addOverlayWidget(e){const i={widget:e,position:e.getPosition()};this._overlayWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting an overlay widget with the same id."),this._overlayWidgets[e.getId()]=i,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addOverlayWidget(i)}layoutOverlayWidget(e){const i=e.getId();if(this._overlayWidgets.hasOwnProperty(i)){const t=this._overlayWidgets[i];t.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutOverlayWidget(t)}}removeOverlayWidget(e){const i=e.getId();if(this._overlayWidgets.hasOwnProperty(i)){const e=this._overlayWidgets[i];delete this._overlayWidgets[i],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeOverlayWidget(e)}}changeViewZones(e){this._modelData&&this._modelData.hasRealView&&this._modelData.view.change(e)}getTargetAtClientPoint(e,i){return this._modelData&&this._modelData.hasRealView?this._modelData.view.getTargetAtClientPoint(e,i):null}getScrolledVisiblePosition(i){if(!this._modelData||!this._modelData.hasRealView)return null;const t=this._modelData.model.validatePosition(i),o=this._configuration.options,n=o.get(140);return{top:e._getVerticalOffsetForPosition(this._modelData,t.lineNumber,t.column)-this.getScrollTop(),left:this._modelData.view.getOffsetForColumn(t.lineNumber,t.column)+n.glyphMarginWidth+n.lineNumbersWidth+n.decorationsWidth-this.getScrollLeft(),height:o.get(64)}}getOffsetForColumn(e,i){return this._modelData&&this._modelData.hasRealView?this._modelData.view.getOffsetForColumn(e,i):-1}render(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._modelData&&this._modelData.hasRealView&&this._modelData.view.render(!0,e)}setAriaOptions(e){this._modelData&&this._modelData.hasRealView&&this._modelData.view.setAriaOptions(e)}applyFontInfo(e){(0,A.N)(e,this._configuration.options.get(48))}setBanner(e,i){this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._domElement.removeChild(this._bannerDomNode),this._bannerDomNode=e,this._configuration.setReservedHeight(e?i:0),this._bannerDomNode&&this._domElement.prepend(this._bannerDomNode)}_attachModel(e){if(!e)return void(this._modelData=null);const i=[];this._domElement.setAttribute("data-mode-id",e.getLanguageId()),this._configuration.setIsDominatedByLongLines(e.isDominatedByLongLines()),this._configuration.setModelLineCount(e.getLineCount());const t=e.onBeforeAttached(),s=new N.j(this._id,this._configuration,e,V.C.create(),P.p.create(this._configuration.options),(e=>n.jL(e)),this.languageConfigurationService,this._themeService,t);i.push(e.onWillDispose((()=>this.setModel(null)))),i.push(s.onEvent((i=>{switch(i.kind){case 0:this._onDidContentSizeChange.fire(i);break;case 1:this._editorTextFocus.setValue(i.hasFocus);break;case 2:this._onDidScrollChange.fire(i);break;case 3:this._onDidChangeViewZones.fire();break;case 4:this._onDidChangeHiddenAreas.fire();break;case 5:this._onDidAttemptReadOnlyEdit.fire();break;case 6:{if(i.reachedMaxCursorCount){const e=this.getOption(77),i=o.NC("cursors.maximum","The number of cursors has been limited to {0}. Consider using [find and replace](https://code.visualstudio.com/docs/editor/codebasics#_find-and-replace) for larger changes or increase the editor multi cursor limit setting.",e);this._notificationService.prompt(I.zb.Warning,i,[{label:"Find and Replace",run:()=>{this._commandService.executeCommand("editor.action.startFindReplaceAction")}},{label:o.NC("goToSetting","Increase Multi Cursor Limit"),run:()=>{this._commandService.executeCommand("workbench.action.openSettings2",{query:"editor.multiCursorLimit"})}}])}const e=[];for(let o=0,s=i.selections.length;o<s;o++)e[o]=i.selections[o].getPosition();const t={position:e[0],secondaryPositions:e.slice(1),reason:i.reason,source:i.source};this._onDidChangeCursorPosition.fire(t);const n={selection:i.selections[0],secondarySelections:i.selections.slice(1),modelVersionId:i.modelVersionId,oldSelections:i.oldSelections,oldModelVersionId:i.oldModelVersionId,source:i.source,reason:i.reason};this._onDidChangeCursorSelection.fire(n);break}case 7:this._onDidChangeModelDecorations.fire(i.event);break;case 8:this._domElement.setAttribute("data-mode-id",e.getLanguageId()),this._onDidChangeModelLanguage.fire(i.event);break;case 9:this._onDidChangeModelLanguageConfiguration.fire(i.event);break;case 10:this._onDidChangeModelContent.fire(i.event);break;case 11:this._onDidChangeModelOptions.fire(i.event);break;case 12:this._onDidChangeModelTokens.fire(i.event)}})));const[r,a]=this._createView(s);if(a){this._domElement.appendChild(r.domNode.domNode);let i=Object.keys(this._contentWidgets);for(let e=0,t=i.length;e<t;e++){const t=i[e];r.addContentWidget(this._contentWidgets[t])}i=Object.keys(this._overlayWidgets);for(let e=0,t=i.length;e<t;e++){const t=i[e];r.addOverlayWidget(this._overlayWidgets[t])}r.render(!1,!0),r.domNode.domNode.setAttribute("data-uri",e.uri.toString())}this._modelData=new q(e,s,r,a,i,t)}_createView(e){let i;i=this.isSimpleWidget?{paste:(e,i,t,o)=>{this._paste("keyboard",e,i,t,o)},type:e=>{this._type("keyboard",e)},compositionType:(e,i,t,o)=>{this._compositionType("keyboard",e,i,t,o)},startComposition:()=>{this._startComposition()},endComposition:()=>{this._endComposition("keyboard")},cut:()=>{this._cut("keyboard")}}:{paste:(e,i,t,o)=>{const n={text:e,pasteOnNewLine:i,multicursorText:t,mode:o};this._commandService.executeCommand("paste",n)},type:e=>{const i={text:e};this._commandService.executeCommand("type",i)},compositionType:(e,i,t,o)=>{if(t||o){const n={text:e,replacePrevCharCnt:i,replaceNextCharCnt:t,positionDelta:o};this._commandService.executeCommand("compositionType",n)}else{const t={text:e,replaceCharCnt:i};this._commandService.executeCommand("replacePreviousChar",t)}},startComposition:()=>{this._commandService.executeCommand("compositionStart",{})},endComposition:()=>{this._commandService.executeCommand("compositionEnd",{})},cut:()=>{this._commandService.executeCommand("cut",{})}};const t=new g.q(e.coordinatesConverter);t.onKeyDown=e=>this._onKeyDown.fire(e),t.onKeyUp=e=>this._onKeyUp.fire(e),t.onContextMenu=e=>this._onContextMenu.fire(e),t.onMouseMove=e=>this._onMouseMove.fire(e),t.onMouseLeave=e=>this._onMouseLeave.fire(e),t.onMouseDown=e=>this._onMouseDown.fire(e),t.onMouseUp=e=>this._onMouseUp.fire(e),t.onMouseDrag=e=>this._onMouseDrag.fire(e),t.onMouseDrop=e=>this._onMouseDrop.fire(e),t.onMouseDropCanceled=e=>this._onMouseDropCanceled.fire(e),t.onMouseWheel=e=>this._onMouseWheel.fire(e);return[new c.G(i,this._configuration,this._themeService.getColorTheme(),e,t,this._overflowWidgetsDomNode),!0]}_postDetachModelCleanup(e){null===e||void 0===e||e.removeAllDecorationsWithOwnerId(this._id)}_detachModel(){if(!this._modelData)return null;const e=this._modelData.model,i=this._modelData.hasRealView?this._modelData.view.domNode.domNode:null;return this._modelData.dispose(),this._modelData=null,this._domElement.removeAttribute("data-mode-id"),i&&this._domElement.contains(i)&&this._domElement.removeChild(i),this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._domElement.removeChild(this._bannerDomNode),e}_removeDecorationType(e){this._codeEditorService.removeDecorationType(e)}hasModel(){return null!==this._modelData}showDropIndicatorAt(i){const t=[{range:new v.e(i.lineNumber,i.column,i.lineNumber,i.column),options:e.dropIntoEditorDecorationOptions}];this._dropIntoEditorDecorations.set(t),this.revealPosition(i,1)}removeDropIndicator(){this._dropIntoEditorDecorations.clear()}};j.dropIntoEditorDecorationOptions=b.qx.register({description:"workbench-dnd-target",className:"dnd-target"}),j=B([Q(3,M.TG),Q(4,u.$),Q(5,E.H),Q(6,y.i6),Q(7,T.XE),Q(8,I.lT),Q(9,O.F),Q(10,F.c_),Q(11,H.p)],j);class J extends a.JT{constructor(e){super(),this._emitterOptions=e,this._onDidChangeToTrue=this._register(new r.Q5(this._emitterOptions)),this.onDidChangeToTrue=this._onDidChangeToTrue.event,this._onDidChangeToFalse=this._register(new r.Q5(this._emitterOptions)),this.onDidChangeToFalse=this._onDidChangeToFalse.event,this._value=0}setValue(e){const i=e?2:1;this._value!==i&&(this._value=i,2===this._value?this._onDidChangeToTrue.fire():1===this._value&&this._onDidChangeToFalse.fire())}}class X extends r.Q5{constructor(e,i){super({deliveryQueue:i}),this._contributions=e}fire(e){this._contributions.onBeforeInteractionEvent(),super.fire(e)}}class Y extends a.JT{constructor(e,i){super(),this._editor=e,i.createKey("editorId",e.getId()),this._editorSimpleInput=w.u.editorSimpleInput.bindTo(i),this._editorFocus=w.u.focus.bindTo(i),this._textInputFocus=w.u.textInputFocus.bindTo(i),this._editorTextFocus=w.u.editorTextFocus.bindTo(i),this._editorTabMovesFocus=w.u.tabMovesFocus.bindTo(i),this._editorReadonly=w.u.readOnly.bindTo(i),this._inDiffEditor=w.u.inDiffEditor.bindTo(i),this._editorColumnSelection=w.u.columnSelection.bindTo(i),this._hasMultipleSelections=w.u.hasMultipleSelections.bindTo(i),this._hasNonEmptySelection=w.u.hasNonEmptySelection.bindTo(i),this._canUndo=w.u.canUndo.bindTo(i),this._canRedo=w.u.canRedo.bindTo(i),this._register(this._editor.onDidChangeConfiguration((()=>this._updateFromConfig()))),this._register(this._editor.onDidChangeCursorSelection((()=>this._updateFromSelection()))),this._register(this._editor.onDidFocusEditorWidget((()=>this._updateFromFocus()))),this._register(this._editor.onDidBlurEditorWidget((()=>this._updateFromFocus()))),this._register(this._editor.onDidFocusEditorText((()=>this._updateFromFocus()))),this._register(this._editor.onDidBlurEditorText((()=>this._updateFromFocus()))),this._register(this._editor.onDidChangeModel((()=>this._updateFromModel()))),this._register(this._editor.onDidChangeConfiguration((()=>this._updateFromModel()))),this._register(U.n.onDidChangeTabFocus((()=>this._editorTabMovesFocus.set(U.n.getTabFocusMode("editorFocus"))))),this._updateFromConfig(),this._updateFromSelection(),this._updateFromFocus(),this._updateFromModel(),this._editorSimpleInput.set(this._editor.isSimpleWidget)}_updateFromConfig(){const e=this._editor.getOptions();this._editorTabMovesFocus.set(U.n.getTabFocusMode("editorFocus")),this._editorReadonly.set(e.get(88)),this._inDiffEditor.set(e.get(59)),this._editorColumnSelection.set(e.get(20))}_updateFromSelection(){const e=this._editor.getSelections();e?(this._hasMultipleSelections.set(e.length>1),this._hasNonEmptySelection.set(e.some((e=>!e.isEmpty())))):(this._hasMultipleSelections.reset(),this._hasNonEmptySelection.reset())}_updateFromFocus(){this._editorFocus.set(this._editor.hasWidgetFocus()&&!this._editor.isSimpleWidget),this._editorTextFocus.set(this._editor.hasTextFocus()&&!this._editor.isSimpleWidget),this._textInputFocus.set(this._editor.hasTextFocus())}_updateFromModel(){const e=this._editor.getModel();this._canUndo.set(Boolean(e&&e.canUndo())),this._canRedo.set(Boolean(e&&e.canRedo()))}}class G extends a.JT{constructor(e,i,t){super(),this._editor=e,this._contextKeyService=i,this._languageFeaturesService=t,this._langId=w.u.languageId.bindTo(i),this._hasCompletionItemProvider=w.u.hasCompletionItemProvider.bindTo(i),this._hasCodeActionsProvider=w.u.hasCodeActionsProvider.bindTo(i),this._hasCodeLensProvider=w.u.hasCodeLensProvider.bindTo(i),this._hasDefinitionProvider=w.u.hasDefinitionProvider.bindTo(i),this._hasDeclarationProvider=w.u.hasDeclarationProvider.bindTo(i),this._hasImplementationProvider=w.u.hasImplementationProvider.bindTo(i),this._hasTypeDefinitionProvider=w.u.hasTypeDefinitionProvider.bindTo(i),this._hasHoverProvider=w.u.hasHoverProvider.bindTo(i),this._hasDocumentHighlightProvider=w.u.hasDocumentHighlightProvider.bindTo(i),this._hasDocumentSymbolProvider=w.u.hasDocumentSymbolProvider.bindTo(i),this._hasReferenceProvider=w.u.hasReferenceProvider.bindTo(i),this._hasRenameProvider=w.u.hasRenameProvider.bindTo(i),this._hasSignatureHelpProvider=w.u.hasSignatureHelpProvider.bindTo(i),this._hasInlayHintsProvider=w.u.hasInlayHintsProvider.bindTo(i),this._hasDocumentFormattingProvider=w.u.hasDocumentFormattingProvider.bindTo(i),this._hasDocumentSelectionFormattingProvider=w.u.hasDocumentSelectionFormattingProvider.bindTo(i),this._hasMultipleDocumentFormattingProvider=w.u.hasMultipleDocumentFormattingProvider.bindTo(i),this._hasMultipleDocumentSelectionFormattingProvider=w.u.hasMultipleDocumentSelectionFormattingProvider.bindTo(i),this._isInWalkThrough=w.u.isInWalkThroughSnippet.bindTo(i);const o=()=>this._update();this._register(e.onDidChangeModel(o)),this._register(e.onDidChangeModelLanguage(o)),this._register(t.completionProvider.onDidChange(o)),this._register(t.codeActionProvider.onDidChange(o)),this._register(t.codeLensProvider.onDidChange(o)),this._register(t.definitionProvider.onDidChange(o)),this._register(t.declarationProvider.onDidChange(o)),this._register(t.implementationProvider.onDidChange(o)),this._register(t.typeDefinitionProvider.onDidChange(o)),this._register(t.hoverProvider.onDidChange(o)),this._register(t.documentHighlightProvider.onDidChange(o)),this._register(t.documentSymbolProvider.onDidChange(o)),this._register(t.referenceProvider.onDidChange(o)),this._register(t.renameProvider.onDidChange(o)),this._register(t.documentFormattingEditProvider.onDidChange(o)),this._register(t.documentRangeFormattingEditProvider.onDidChange(o)),this._register(t.signatureHelpProvider.onDidChange(o)),this._register(t.inlayHintsProvider.onDidChange(o)),o()}dispose(){super.dispose()}reset(){this._contextKeyService.bufferChangeEvents((()=>{this._langId.reset(),this._hasCompletionItemProvider.reset(),this._hasCodeActionsProvider.reset(),this._hasCodeLensProvider.reset(),this._hasDefinitionProvider.reset(),this._hasDeclarationProvider.reset(),this._hasImplementationProvider.reset(),this._hasTypeDefinitionProvider.reset(),this._hasHoverProvider.reset(),this._hasDocumentHighlightProvider.reset(),this._hasDocumentSymbolProvider.reset(),this._hasReferenceProvider.reset(),this._hasRenameProvider.reset(),this._hasDocumentFormattingProvider.reset(),this._hasDocumentSelectionFormattingProvider.reset(),this._hasSignatureHelpProvider.reset(),this._isInWalkThrough.reset()}))}_update(){const e=this._editor.getModel();e?this._contextKeyService.bufferChangeEvents((()=>{this._langId.set(e.getLanguageId()),this._hasCompletionItemProvider.set(this._languageFeaturesService.completionProvider.has(e)),this._hasCodeActionsProvider.set(this._languageFeaturesService.codeActionProvider.has(e)),this._hasCodeLensProvider.set(this._languageFeaturesService.codeLensProvider.has(e)),this._hasDefinitionProvider.set(this._languageFeaturesService.definitionProvider.has(e)),this._hasDeclarationProvider.set(this._languageFeaturesService.declarationProvider.has(e)),this._hasImplementationProvider.set(this._languageFeaturesService.implementationProvider.has(e)),this._hasTypeDefinitionProvider.set(this._languageFeaturesService.typeDefinitionProvider.has(e)),this._hasHoverProvider.set(this._languageFeaturesService.hoverProvider.has(e)),this._hasDocumentHighlightProvider.set(this._languageFeaturesService.documentHighlightProvider.has(e)),this._hasDocumentSymbolProvider.set(this._languageFeaturesService.documentSymbolProvider.has(e)),this._hasReferenceProvider.set(this._languageFeaturesService.referenceProvider.has(e)),this._hasRenameProvider.set(this._languageFeaturesService.renameProvider.has(e)),this._hasSignatureHelpProvider.set(this._languageFeaturesService.signatureHelpProvider.has(e)),this._hasInlayHintsProvider.set(this._languageFeaturesService.inlayHintsProvider.has(e)),this._hasDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.has(e)||this._languageFeaturesService.documentRangeFormattingEditProvider.has(e)),this._hasDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.has(e)),this._hasMultipleDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.all(e).length+this._languageFeaturesService.documentRangeFormattingEditProvider.all(e).length>1),this._hasMultipleDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.all(e).length>1),this._isInWalkThrough.set(e.uri.scheme===d.lg.walkThroughSnippet)})):this.reset()}}class $ extends a.JT{constructor(e){super(),this._onChange=this._register(new r.Q5),this.onChange=this._onChange.event,this._hasFocus=!1,this._domFocusTracker=this._register(n.go(e)),this._register(this._domFocusTracker.onDidFocus((()=>{this._hasFocus=!0,this._onChange.fire(void 0)}))),this._register(this._domFocusTracker.onDidBlur((()=>{this._hasFocus=!1,this._onChange.fire(void 0)})))}hasFocus(){return this._hasFocus}}class ee{get length(){return this._decorationIds.length}constructor(e,i){this._editor=e,this._decorationIds=[],this._isChangingDecorations=!1,Array.isArray(i)&&i.length>0&&this.set(i)}onDidChange(e,i,t){return this._editor.onDidChangeModelDecorations((t=>{this._isChangingDecorations||e.call(i,t)}),t)}getRange(e){return this._editor.hasModel()?e>=this._decorationIds.length?null:this._editor.getModel().getDecorationRange(this._decorationIds[e]):null}getRanges(){if(!this._editor.hasModel())return[];const e=this._editor.getModel(),i=[];for(const t of this._decorationIds){const o=e.getDecorationRange(t);o&&i.push(o)}return i}has(e){return this._decorationIds.includes(e.id)}clear(){0!==this._decorationIds.length&&this.set([])}set(e){try{this._isChangingDecorations=!0,this._editor.changeDecorations((i=>{this._decorationIds=i.deltaDecorations(this._decorationIds,e)}))}finally{this._isChangingDecorations=!1}return this._decorationIds}}const ie=encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='"),te=encodeURIComponent("'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>");function oe(e){return ie+encodeURIComponent(e.toString())+te}const ne=encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" height="3" width="12"><g fill="'),se=encodeURIComponent('"><circle cx="1" cy="1" r="1"/><circle cx="5" cy="1" r="1"/><circle cx="9" cy="1" r="1"/></g></svg>');(0,T.Ic)(((e,i)=>{const t=e.getColor(S.lXJ);t&&i.addRule(".monaco-editor .".concat("squiggly-error",' { background: url("data:image/svg+xml,',oe(t),'") repeat-x bottom left; }'));const o=e.getColor(S.uoC);o&&i.addRule(".monaco-editor .".concat("squiggly-warning",' { background: url("data:image/svg+xml,',oe(o),'") repeat-x bottom left; }'));const n=e.getColor(S.c63);n&&i.addRule(".monaco-editor .".concat("squiggly-info",' { background: url("data:image/svg+xml,',oe(n),'") repeat-x bottom left; }'));const s=e.getColor(S.Dut);s&&i.addRule(".monaco-editor .".concat("squiggly-hint",' { background: url("data:image/svg+xml,',ne+encodeURIComponent(s.toString())+se,'") no-repeat bottom left; }'));const r=e.getColor(L.zu);r&&i.addRule(".monaco-editor.showUnused .".concat("squiggly-inline-unnecessary"," { opacity: ",r.rgba.a,"; }"))}))},23964:(e,i,t)=>{t.d(i,{p:()=>Ie});var o=t(20494),n=t(86837),s=t(8071),r=t(22907),a=t(67676),d=t(26728),l=t(37368),h=t(87159),u=t(33309),c=t(68515),g=t(41045),m=t(59652),_=t(75246),f=t(58314),v=t(26405),p=t(33344),C=t(3527),D=t(80134),w=t(21290),b=t(48830),L=t(74623),S=t(59844),N=t(98110),E=t(77116),y=t(99924),M=t(62281),R=t(21605),I=t(68523),T=t(42990),O=t(26511),x=t(49396),P=t(53435),V=t(10071),W=t(31708),F=function(e,i,t,o){var n,s=arguments.length,r=s<3?i:null===o?o=Object.getOwnPropertyDescriptor(i,t):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,i,t,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(r=(s<3?n(r):s>3?n(i,t,r):n(i,t))||r);return s>3&&r&&Object.defineProperty(i,t,r),r},A=function(e,i){return function(t,o){i(t,o,e)}},H=function(e,i,t,o){return new(t||(t=Promise))((function(n,s){function r(e){try{d(o.next(e))}catch(i){s(i)}}function a(e){try{d(o.throw(e))}catch(i){s(i)}}function d(e){var i;e.done?n(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(r,a)}d((o=o.apply(e,i||[])).next())}))};class k{constructor(e,i,t,o){this.originalLineStart=e,this.originalLineEnd=i,this.modifiedLineStart=t,this.modifiedLineEnd=o}getType(){return 0===this.originalLineStart?1:0===this.modifiedLineStart?2:0}}class z{constructor(e){this.entries=e}}const U=(0,W.q5)("diff-review-insert",h.l.add,O.NC("diffReviewInsertIcon","Icon for 'Insert' in diff review.")),B=(0,W.q5)("diff-review-remove",h.l.remove,O.NC("diffReviewRemoveIcon","Icon for 'Remove' in diff review.")),Q=(0,W.q5)("diff-review-close",h.l.close,O.NC("diffReviewCloseIcon","Icon for 'Close' in diff review."));let Z=class e extends m.JT{constructor(e,i,t,s){super(),this._languageService=i,this._audioCueService=t,this._configurationService=s,this._width=0,this._diffEditor=e,this._isVisible=!1,this.shadow=(0,n.X)(document.createElement("div")),this.shadow.setClassName("diff-review-shadow"),this.actionBarContainer=(0,n.X)(document.createElement("div")),this.actionBarContainer.setClassName("diff-review-actions"),this._actionBar=this._register(new L.o(this.actionBarContainer.domNode)),this._actionBar.push(new N.aU("diffreview.close",O.NC("label.close","Close"),"close-diff-review "+_.k.asClassName(Q),!0,(()=>H(this,void 0,void 0,(function*(){return this.hide()})))),{label:!1,icon:!0}),this.domNode=(0,n.X)(document.createElement("div")),this.domNode.setClassName("diff-review monaco-editor-background"),this._content=(0,n.X)(document.createElement("div")),this._content.setClassName("diff-review-content"),this._content.setAttribute("role","code"),this.scrollbar=this._register(new S.s$(this._content.domNode,{})),this.domNode.domNode.appendChild(this.scrollbar.getDomNode()),this._register(e.onDidUpdateDiff((()=>{this._isVisible&&(this._diffs=this._compute(),this._render())}))),this._register(e.getModifiedEditor().onDidChangeCursorPosition((()=>{this._isVisible&&this._render()}))),this._register(o.mu(this.domNode.domNode,"click",(e=>{e.preventDefault();const i=o.Fx(e.target,"diff-review-row");i&&this._goToRow(i)}))),this._register(o.mu(this.domNode.domNode,"keydown",(e=>{(e.equals(18)||e.equals(2066)||e.equals(530))&&(e.preventDefault(),this._goToRow(this._getNextRow(),"next")),(e.equals(16)||e.equals(2064)||e.equals(528))&&(e.preventDefault(),this._goToRow(this._getPrevRow(),"previous")),(e.equals(9)||e.equals(2057)||e.equals(521)||e.equals(1033)||e.equals(10)||e.equals(3))&&(e.preventDefault(),this.accept())}))),this._register(this._configurationService.onDidChangeConfiguration((e=>{e.affectsConfiguration("accessibility.verbosity.diffEditor")&&this._diffEditor.updateOptions({accessibilityVerbose:this._configurationService.getValue("accessibility.verbosity.diffEditor")})}))),this._diffs=[],this._currentDiff=null}prev(){let e=0;if(this._isVisible||(this._diffs=this._compute()),this._isVisible){let i=-1;for(let e=0,t=this._diffs.length;e<t;e++)if(this._diffs[e]===this._currentDiff){i=e;break}e=this._diffs.length+i-1}else e=this._findDiffIndex(this._diffEditor.getPosition());if(0===this._diffs.length)return;e%=this._diffs.length;const i=this._diffs[e].entries;this._diffEditor.setPosition(new y.L(i[0].modifiedLineStart,1)),this._diffEditor.setSelection({startColumn:1,startLineNumber:i[0].modifiedLineStart,endColumn:1073741824,endLineNumber:i[i.length-1].modifiedLineEnd}),this._isVisible=!0,this._diffEditor.doLayout(),this._render(),this._goToRow(this._getPrevRow(),"previous")}next(){let e=0;if(this._isVisible||(this._diffs=this._compute()),this._isVisible){let i=-1;for(let e=0,t=this._diffs.length;e<t;e++)if(this._diffs[e]===this._currentDiff){i=e;break}e=i+1}else e=this._findDiffIndex(this._diffEditor.getPosition());if(0===this._diffs.length)return;e%=this._diffs.length;const i=this._diffs[e].entries;this._diffEditor.setPosition(new y.L(i[0].modifiedLineStart,1)),this._diffEditor.setSelection({startColumn:1,startLineNumber:i[0].modifiedLineStart,endColumn:1073741824,endLineNumber:i[i.length-1].modifiedLineEnd}),this._isVisible=!0,this._diffEditor.doLayout(),this._render(),this._goToRow(this._getNextRow(),"next")}accept(){let e=-1;const i=this._getCurrentFocusedRow();if(i){const t=parseInt(i.getAttribute("data-line"),10);isNaN(t)||(e=t)}this.hide(),-1!==e&&(this._diffEditor.setPosition(new y.L(e,1)),this._diffEditor.revealPosition(new y.L(e,1),1))}hide(){this._isVisible=!1,this._diffEditor.updateOptions({readOnly:!1}),this._diffEditor.focus(),this._diffEditor.doLayout(),this._render()}_getPrevRow(){const e=this._getCurrentFocusedRow();return e?e.previousElementSibling?e.previousElementSibling:e:this._getFirstRow()}_getNextRow(){const e=this._getCurrentFocusedRow();return e?e.nextElementSibling?e.nextElementSibling:e:this._getFirstRow()}_getFirstRow(){return this.domNode.domNode.querySelector(".diff-review-row")}_getCurrentFocusedRow(){const e=document.activeElement;return e&&/diff-review-row/.test(e.className)?e:null}_goToRow(e,i){const t=this._getCurrentFocusedRow();e.tabIndex=0,e.focus(),t&&t!==e&&(t.tabIndex=-1);const o=i?"next"===i?null===t||void 0===t?void 0:t.nextElementSibling:null===t||void 0===t?void 0:t.previousElementSibling:t;(null===o||void 0===o?void 0:o.classList.contains("line-insert"))?this._audioCueService.playAudioCue(x.y$.diffLineInserted,!0):(null===o||void 0===o?void 0:o.classList.contains("line-delete"))&&this._audioCueService.playAudioCue(x.y$.diffLineDeleted,!0),this.scrollbar.scanDomNode()}isVisible(){return this._isVisible}layout(e,i,t){this._width=i,this.shadow.setTop(e-6),this.shadow.setWidth(i),this.shadow.setHeight(this._isVisible?6:0),this.domNode.setTop(e),this.domNode.setWidth(i),this.domNode.setHeight(t),this._content.setHeight(t),this._content.setWidth(i),this._isVisible?(this.actionBarContainer.setAttribute("aria-hidden","false"),this.actionBarContainer.setDisplay("block")):(this.actionBarContainer.setAttribute("aria-hidden","true"),this.actionBarContainer.setDisplay("none"))}_compute(){const i=this._diffEditor.getLineChanges();if(!i||0===i.length)return[];const t=this._diffEditor.getOriginalEditor().getModel(),o=this._diffEditor.getModifiedEditor().getModel();return t&&o?e._mergeAdjacent(i,t.getLineCount(),o.getLineCount()):[]}static _mergeAdjacent(e,i,t){if(!e||0===e.length)return[];const o=[];let n=0;for(let d=0,l=e.length;d<l;d++){const s=e[d],r=s.originalStartLineNumber,a=s.originalEndLineNumber,h=s.modifiedStartLineNumber,u=s.modifiedEndLineNumber,c=[];let g=0;{const i=0===a?r:r-1,t=0===u?h:h-1;let o=1,n=1;if(d>0){const i=e[d-1];o=0===i.originalEndLineNumber?i.originalStartLineNumber+1:i.originalEndLineNumber+1,n=0===i.modifiedEndLineNumber?i.modifiedStartLineNumber+1:i.modifiedEndLineNumber+1}let s=i-3+1,l=t-3+1;if(s<o){const e=o-s;s+=e,l+=e}if(l<n){const e=n-l;s+=e,l+=e}c[g++]=new k(s,i,l,t)}0!==a&&(c[g++]=new k(r,a,0,0)),0!==u&&(c[g++]=new k(0,0,h,u));{const o=0===a?r+1:a+1,n=0===u?h+1:u+1;let s=i,m=t;if(d+1<l){const i=e[d+1];s=0===i.originalEndLineNumber?i.originalStartLineNumber:i.originalStartLineNumber-1,m=0===i.modifiedEndLineNumber?i.modifiedStartLineNumber:i.modifiedStartLineNumber-1}let _=o+3-1,f=n+3-1;if(_>s){const e=s-_;_+=e,f+=e}if(f>m){const e=m-f;_+=e,f+=e}c[g++]=new k(o,_,n,f)}o[n++]=new z(c)}let s=o[0].entries;const r=[];let a=0;for(let d=1,l=o.length;d<l;d++){const e=o[d].entries,i=s[s.length-1],t=e[0];0===i.getType()&&0===t.getType()&&t.originalLineStart<=i.originalLineEnd?(s[s.length-1]=new k(i.originalLineStart,t.originalLineEnd,i.modifiedLineStart,t.modifiedLineEnd),s=s.concat(e.slice(1))):(r[a++]=new z(s),s=e)}return r[a++]=new z(s),r}_findDiffIndex(e){const i=e.lineNumber;for(let t=0,o=this._diffs.length;t<o;t++){const e=this._diffs[t].entries;if(i<=e[e.length-1].modifiedLineEnd)return t}return 0}_render(){const i=this._diffEditor.getOriginalEditor().getOptions(),t=this._diffEditor.getModifiedEditor().getOptions(),n=this._diffEditor.getOriginalEditor().getModel(),s=this._diffEditor.getModifiedEditor().getModel(),r=n.getOptions(),a=s.getOptions();if(!this._isVisible||!n||!s)return o.PO(this._content.domNode),this._currentDiff=null,void this.scrollbar.scanDomNode();this._diffEditor.updateOptions({readOnly:!0});const d=this._findDiffIndex(this._diffEditor.getPosition());if(this._diffs[d]===this._currentDiff)return;this._currentDiff=this._diffs[d];const l=this._diffs[d].entries,h=document.createElement("div");h.className="diff-review-table",h.setAttribute("role","list"),h.setAttribute("aria-label",'Difference review. Use "Stage | Unstage | Revert Selected Ranges" commands'),(0,f.N)(h,t.get(48));let u=0,c=0,g=0,m=0;for(let e=0,o=l.length;e<o;e++){const i=l[e],t=i.originalLineStart,o=i.originalLineEnd,n=i.modifiedLineStart,s=i.modifiedLineEnd;0!==t&&(0===u||t<u)&&(u=t),0!==o&&(0===c||o>c)&&(c=o),0!==n&&(0===g||n<g)&&(g=n),0!==s&&(0===m||s>m)&&(m=s)}const _=document.createElement("div");_.className="diff-review-row";const v=document.createElement("div");v.className="diff-review-cell diff-review-summary";const p=c-u+1,C=m-g+1;v.appendChild(document.createTextNode("".concat(d+1,"/").concat(this._diffs.length,": @@ -").concat(u,",").concat(p," +").concat(g,",").concat(C," @@"))),_.setAttribute("data-line",String(g));const D=e=>0===e?O.NC("no_lines_changed","no lines changed"):1===e?O.NC("one_line_changed","1 line changed"):O.NC("more_lines_changed","{0} lines changed",e),w=D(p),b=D(C);_.setAttribute("aria-label",O.NC({key:"header",comment:["This is the ARIA label for a git diff header.","A git diff header looks like this: @@ -154,12 +159,39 @@.","That encodes that at original line 154 (which is now line 159), 12 lines were removed/changed with 39 lines.","Variables 0 and 1 refer to the diff index out of total number of diffs.","Variables 2 and 4 will be numbers (a line number).",'Variables 3 and 5 will be "no lines changed", "1 line changed" or "X lines changed", localized separately.']},"Difference {0} of {1}: original line {2}, {3}, modified line {4}, {5}",d+1,this._diffs.length,u,w,g,b)),_.appendChild(v),_.setAttribute("role","listitem"),h.appendChild(_);const L=t.get(64);let S=g;for(let o=0,f=l.length;o<f;o++){const d=l[o];e._renderSection(h,d,S,L,this._width,i,n,r,t,s,a,this._languageService.languageIdCodec),0!==d.modifiedLineStart&&(S=d.modifiedLineEnd)}o.PO(this._content.domNode),this._content.domNode.appendChild(h),this.scrollbar.scanDomNode()}static _renderSection(i,t,o,n,s,r,a,d,l,h,u,c){const g=t.getType();let m="diff-review-row",f="";let v=null;switch(g){case 1:m="diff-review-row line-insert",f=" char-insert",v=U;break;case 2:m="diff-review-row line-delete",f=" char-delete",v=B}const p=t.originalLineStart,C=t.originalLineEnd,D=t.modifiedLineStart,w=t.modifiedLineEnd,b=Math.max(w-D,C-p),L=r.get(140),S=L.glyphMarginWidth+L.lineNumbersWidth,N=l.get(140),E=10+N.glyphMarginWidth+N.lineNumbersWidth;for(let y=0;y<=b;y++){const t=0===p?0:p+y,C=0===D?0:D+y,w=document.createElement("div");w.style.minWidth=s+"px",w.className=m,w.setAttribute("role","listitem"),0!==C&&(o=C),w.setAttribute("data-line",String(o));const b=document.createElement("div");b.className="diff-review-cell",b.style.height="".concat(n,"px"),w.appendChild(b);const L=document.createElement("span");L.style.width=S+"px",L.style.minWidth=S+"px",L.className="diff-review-line-number"+f,0!==t?L.appendChild(document.createTextNode(String(t))):L.innerText="\xa0",b.appendChild(L);const N=document.createElement("span");N.style.width=E+"px",N.style.minWidth=E+"px",N.style.paddingRight="10px",N.className="diff-review-line-number"+f,0!==C?N.appendChild(document.createTextNode(String(C))):N.innerText="\xa0",b.appendChild(N);const M=document.createElement("span");if(M.className="diff-review-spacer",v){const e=document.createElement("span");e.className=_.k.asClassName(v),e.innerText="\xa0\xa0",M.appendChild(e)}else M.innerText="\xa0\xa0";let R;if(b.appendChild(M),0!==C){let i=this._renderLine(h,l,u.tabSize,C,c);e._ttPolicy&&(i=e._ttPolicy.createHTML(i)),b.insertAdjacentHTML("beforeend",i),R=h.getLineContent(C)}else{let i=this._renderLine(a,r,d.tabSize,t,c);e._ttPolicy&&(i=e._ttPolicy.createHTML(i)),b.insertAdjacentHTML("beforeend",i),R=a.getLineContent(t)}0===R.length&&(R=O.NC("blankLine","blank"));let I="";switch(g){case 0:I=t===C?O.NC({key:"unchangedLine",comment:["The placeholders are contents of the line and should not be translated."]},"{0} unchanged line {1}",R,t):O.NC("equalLine","{0} original line {1} modified line {2}",R,t,C);break;case 1:I=O.NC("insertLine","+ {0} modified line {1}",R,C);break;case 2:I=O.NC("deleteLine","- {0} original line {1}",R,t)}w.setAttribute("aria-label",I),i.appendChild(w)}}static _renderLine(e,i,t,o,n){const s=e.getLineContent(o),r=i.get(48),a=R.A.createEmpty(s,n),d=T.wA.isBasicASCII(s,e.mightContainNonBasicASCII()),l=T.wA.containsRTL(s,d,e.mightContainRTL());return(0,I.tF)(new I.IJ(r.isMonospace&&!i.get(31),r.canUseHalfwidthRightwardsArrow,s,!1,d,l,0,a,[],t,0,r.spaceWidth,r.middotWidth,r.wsmiddotWidth,i.get(113),i.get(95),i.get(90),i.get(49)!==E.n0.OFF,null)).html}};Z._ttPolicy=(0,s.Z)("diffReview",{createHTML:e=>e}),Z=F([A(1,M.O),A(2,x.e7),A(3,P.Ui)],Z);class K extends p.R6{constructor(){super({id:"editor.action.diffReview.next",label:O.NC("editor.action.diffReview.next","Go to Next Difference"),alias:"Go to Next Difference",precondition:V.Ao.has("isInDiffEditor"),kbOpts:{kbExpr:null,primary:65,weight:100}})}run(e,i){const t=j(e);null===t||void 0===t||t.diffReviewNext()}}class q extends p.R6{constructor(){super({id:"editor.action.diffReview.prev",label:O.NC("editor.action.diffReview.prev","Go to Previous Difference"),alias:"Go to Previous Difference",precondition:V.Ao.has("isInDiffEditor"),kbOpts:{kbExpr:null,primary:1089,weight:100}})}run(e,i){const t=j(e);null===t||void 0===t||t.diffReviewPrev()}}function j(e){var i;const t=e.get(C.$),o=t.listDiffEditors(),n=null!==(i=t.getFocusedCodeEditor())&&void 0!==i?i:t.getActiveCodeEditor();if(!n)return null;for(let s=0,r=o.length;s<r;s++){const e=o[s];if(e.getModifiedEditor().getId()===n.getId()||e.getOriginalEditor().getId()===n.getId())return e}return null}(0,p.Qr)(K),(0,p.Qr)(q);var J=t(55597),X=t(44352),Y=function(e,i,t,o){return new(t||(t=Promise))((function(n,s){function r(e){try{d(o.next(e))}catch(i){s(i)}}function a(e){try{d(o.throw(e))}catch(i){s(i)}}function d(e){var i;e.done?n(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(r,a)}d((o=o.apply(e,i||[])).next())}))};class G extends m.JT{get visibility(){return this._visibility}set visibility(e){this._visibility!==e&&(this._visibility=e,this._diffActions.style.visibility=e?"visible":"hidden")}constructor(e,i,t,n,s,r){super(),this._viewZoneId=e,this._marginDomNode=i,this.editor=t,this.diff=n,this._contextMenuService=s,this._clipboardService=r,this._visibility=!1,this._marginDomNode.style.zIndex="10",this._diffActions=document.createElement("div"),this._diffActions.className=_.k.asClassName(h.l.lightBulb)+" lightbulb-glyph",this._diffActions.style.position="absolute";const a=t.getOption(64),d=t.getModel().getEOL();this._diffActions.style.right="0px",this._diffActions.style.visibility="hidden",this._diffActions.style.height="".concat(a,"px"),this._diffActions.style.lineHeight="".concat(a,"px"),this._marginDomNode.appendChild(this._diffActions);const l=[],u=0===n.modifiedEndLineNumber;l.push(new N.aU("diff.clipboard.copyDeletedContent",u?n.originalEndLineNumber>n.modifiedStartLineNumber?O.NC("diff.clipboard.copyDeletedLinesContent.label","Copy deleted lines"):O.NC("diff.clipboard.copyDeletedLinesContent.single.label","Copy deleted line"):n.originalEndLineNumber>n.modifiedStartLineNumber?O.NC("diff.clipboard.copyChangedLinesContent.label","Copy changed lines"):O.NC("diff.clipboard.copyChangedLinesContent.single.label","Copy changed line"),void 0,!0,(()=>Y(this,void 0,void 0,(function*(){const e=new J.e(n.originalStartLineNumber,1,n.originalEndLineNumber+1,1),i=n.originalModel.getValueInRange(e);yield this._clipboardService.writeText(i)})))));let c,g=0;n.originalEndLineNumber>n.modifiedStartLineNumber&&(c=new N.aU("diff.clipboard.copyDeletedLineContent",u?O.NC("diff.clipboard.copyDeletedLineContent.label","Copy deleted line ({0})",n.originalStartLineNumber):O.NC("diff.clipboard.copyChangedLineContent.label","Copy changed line ({0})",n.originalStartLineNumber),void 0,!0,(()=>Y(this,void 0,void 0,(function*(){const e=n.originalModel.getLineContent(n.originalStartLineNumber+g);if(""===e){const e=n.originalModel.getEndOfLineSequence();yield this._clipboardService.writeText(0===e?"\n":"\r\n")}else yield this._clipboardService.writeText(e)})))),l.push(c));t.getOption(88)||l.push(new N.aU("diff.inline.revertChange",O.NC("diff.inline.revertChange.label","Revert this change"),void 0,!0,(()=>Y(this,void 0,void 0,(function*(){const e=new J.e(n.originalStartLineNumber,1,n.originalEndLineNumber,n.originalModel.getLineMaxColumn(n.originalEndLineNumber)),i=n.originalModel.getValueInRange(e);if(0===n.modifiedEndLineNumber){const e=t.getModel().getLineMaxColumn(n.modifiedStartLineNumber);t.executeEdits("diffEditor",[{range:new J.e(n.modifiedStartLineNumber,e,n.modifiedStartLineNumber,e),text:d+i}])}else{const e=t.getModel().getLineMaxColumn(n.modifiedEndLineNumber);t.executeEdits("diffEditor",[{range:new J.e(n.modifiedStartLineNumber,1,n.modifiedEndLineNumber,e),text:i}])}})))));const m=t.getOption(123)&&!X.gn,f=(e,i)=>{var o;this._contextMenuService.showContextMenu({domForShadowRoot:m&&null!==(o=t.getDomNode())&&void 0!==o?o:void 0,getAnchor:()=>({x:e,y:i}),getActions:()=>(c&&(c.label=u?O.NC("diff.clipboard.copyDeletedLineContent.label","Copy deleted line ({0})",n.originalStartLineNumber+g):O.NC("diff.clipboard.copyChangedLineContent.label","Copy changed line ({0})",n.originalStartLineNumber+g)),l),autoSelectFirstItem:!0})};this._register(o.mu(this._diffActions,"mousedown",(e=>{const{top:i,height:t}=o.i(this._diffActions),n=Math.floor(a/3);e.preventDefault(),f(e.posx,i+t+n)}))),this._register(t.onMouseMove((e=>{if(8===e.target.type||5===e.target.type){e.target.detail.viewZoneId===this._viewZoneId?(this.visibility=!0,g=this._updateLightBulbPosition(this._marginDomNode,e.event.browserEvent.y,a)):this.visibility=!1}else this.visibility=!1}))),this._register(t.onMouseDown((e=>{if(e.event.rightButton&&(8===e.target.type||5===e.target.type)){e.target.detail.viewZoneId===this._viewZoneId&&(e.event.preventDefault(),g=this._updateLightBulbPosition(this._marginDomNode,e.event.browserEvent.y,a),f(e.event.posx,e.event.posy+a))}})))}_updateLightBulbPosition(e,i,t){const{top:n}=o.i(e),s=i-n,r=Math.floor(s/t),a=r*t;if(this._diffActions.style.top="".concat(a,"px"),this.diff.viewLineCounts){let e=0;for(let i=0;i<this.diff.viewLineCounts.length;i++)if(e+=this.diff.viewLineCounts[i],r<e)return i}return r}}var $=t(87794),ee=t(87621),ie=t(25501),te=t(41776),oe=t(57732),ne=function(e,i,t,o){var n,s=arguments.length,r=s<3?i:null===o?o=Object.getOwnPropertyDescriptor(i,t):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,i,t,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(r=(s<3?n(r):s>3?n(i,t,r):n(i,t))||r);return s>3&&r&&Object.defineProperty(i,t,r),r},se=function(e,i){return function(t,o){i(t,o,e)}},re=function(e,i,t,o){return new(t||(t=Promise))((function(n,s){function r(e){try{d(o.next(e))}catch(i){s(i)}}function a(e){try{d(o.throw(e))}catch(i){s(i)}}function d(e){var i;e.done?n(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(r,a)}d((o=o.apply(e,i||[])).next())}))};let ae=class{constructor(e,i,t){this.editorWorkerService=i,this.telemetryService=t,this.onDidChangeEventEmitter=new c.Q5,this.onDidChange=this.onDidChangeEventEmitter.event,this.diffAlgorithm="advanced",this.diffAlgorithmOnDidChangeSubscription=void 0,this.setOptions(e)}dispose(){var e;null===(e=this.diffAlgorithmOnDidChangeSubscription)||void 0===e||e.dispose()}computeDiff(e,i,t){var o;return re(this,void 0,void 0,(function*(){if("string"!==typeof this.diffAlgorithm)return this.diffAlgorithm.computeDiff(e,i,t);if(1===e.getLineCount()&&1===e.getLineMaxColumn(1))return{changes:[new ie.f0(new ee.z(1,1),new ee.z(1,i.getLineCount()),[new ie.iy(e.getFullModelRange(),i.getFullModelRange())])],identical:!1,quitEarly:!1};const n=$.G.create(!0),s=yield this.editorWorkerService.computeDiff(e.uri,i.uri,t,this.diffAlgorithm),r=n.elapsed();if(this.telemetryService.publicLog2("diffEditor.computeDiff",{timeMs:r,timedOut:null===(o=null===s||void 0===s?void 0:s.quitEarly)||void 0===o||o}),!s)throw new Error("no diff result available");return s}))}setOptions(e){var i;let t=!1;e.diffAlgorithm&&this.diffAlgorithm!==e.diffAlgorithm&&(null===(i=this.diffAlgorithmOnDidChangeSubscription)||void 0===i||i.dispose(),this.diffAlgorithmOnDidChangeSubscription=void 0,this.diffAlgorithm=e.diffAlgorithm,"string"!==typeof e.diffAlgorithm&&(this.diffAlgorithmOnDidChangeSubscription=e.diffAlgorithm.onDidChange((()=>this.onDidChangeEventEmitter.fire()))),t=!0),t&&this.onDidChangeEventEmitter.fire()}};ae=ne([se(1,te.p),se(2,oe.b)],ae);var de=t(21531),le=t(77734),he=t(90567),ue=t(13101),ce=t(14133),ge=t(79455),me=t(27591),_e=t(23417),fe=t(22046),ve=t(94175),pe=t(37709),Ce=t(94247),De=t(24999),we=t(58023),be=function(e,i,t,o){var n,s=arguments.length,r=s<3?i:null===o?o=Object.getOwnPropertyDescriptor(i,t):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,i,t,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(r=(s<3?n(r):s>3?n(i,t,r):n(i,t))||r);return s>3&&r&&Object.defineProperty(i,t,r),r},Le=function(e,i){return function(t,o){i(t,o,e)}};class Se{constructor(e,i){this._contextMenuService=e,this._clipboardService=i,this._zones=[],this._inlineDiffMargins=[],this._zonesMap={},this._decorations=[]}getForeignViewZones(e){return e.filter((e=>!this._zonesMap[String(e.id)]))}clean(e){this._zones.length>0&&e.changeViewZones((e=>{for(const i of this._zones)e.removeZone(i)})),this._zones=[],this._zonesMap={},e.changeDecorations((e=>{this._decorations=e.deltaDecorations(this._decorations,[])}))}apply(e,i,t,o){const n=o?D.Z.capture(e):null;e.changeViewZones((i=>{var o;for(const e of this._zones)i.removeZone(e);for(const e of this._inlineDiffMargins)e.dispose();this._zones=[],this._zonesMap={},this._inlineDiffMargins=[];for(let n=0,s=t.zones.length;n<s;n++){const s=t.zones[n];s.suppressMouseDown=!0;const r=i.addZone(s);this._zones.push(r),this._zonesMap[String(r)]=!0,t.zones[n].diff&&s.marginDomNode&&(s.suppressMouseDown=!1,0!==(null===(o=t.zones[n].diff)||void 0===o?void 0:o.originalModel.getValueLength())&&this._inlineDiffMargins.push(new G(r,s.marginDomNode,e,t.zones[n].diff,this._contextMenuService,this._clipboardService)))}})),null===n||void 0===n||n.restore(e),e.changeDecorations((e=>{this._decorations=e.deltaDecorations(this._decorations,t.decorations)})),null===i||void 0===i||i.setZones(t.overviewZones)}}let Ne=0;const Ee=(0,W.q5)("diff-insert",h.l.add,O.NC("diffInsertIcon","Line decoration for inserts in the diff editor.")),ye=(0,W.q5)("diff-remove",h.l.remove,O.NC("diffRemoveIcon","Line decoration for removals in the diff editor.")),Me=(0,s.Z)("diffEditorWidget",{createHTML:e=>e}),Re=O.NC("diff-aria-navigation-tip"," use Shift + F7 to navigate changes");let Ie=class e extends m.JT{constructor(i,t,s,r,a,d,h,g,m,_,f){super(),this._editorProgressService=f,this._onDidDispose=this._register(new c.Q5),this.onDidDispose=this._onDidDispose.event,this._onDidChangeModel=this._register(new c.Q5),this.onDidChangeModel=this._onDidChangeModel.event,this._onDidUpdateDiff=this._register(new c.Q5),this.onDidUpdateDiff=this._onDidUpdateDiff.event,this._onDidContentSizeChange=this._register(new c.Q5),this._lastOriginalWarning=null,this._lastModifiedWarning=null,h.willCreateDiffEditor(),this._documentDiffProvider=this._register(d.createInstance(ae,t)),this._register(this._documentDiffProvider.onDidChange((e=>this._beginUpdateDecorationsSoon()))),this._codeEditorService=h,this._contextKeyService=this._register(a.createScoped(i)),this._instantiationService=d.createChild(new ve.y([V.i6,this._contextKeyService])),this._contextKeyService.createKey("isInDiffEditor",!0),this._themeService=g,this._notificationService=m,this._id=++Ne,this._state=0,this._updatingDiffProgress=null,this._domElement=i,t=t||{},this._options=qe(t,{enableSplitViewResizing:!0,splitViewDefaultRatio:.5,renderSideBySide:!0,renderMarginRevertIcon:!0,maxComputationTime:5e3,maxFileSize:50,ignoreTrimWhitespace:!0,renderIndicators:!0,originalEditable:!1,diffCodeLens:!1,renderOverviewRuler:!0,diffWordWrap:"inherit",diffAlgorithm:"advanced",accessibilityVerbose:!1,experimental:{collapseUnchangedRegions:!1}}),this.isEmbeddedDiffEditorKey=he.u.isEmbeddedDiffEditor.bindTo(this._contextKeyService),this.isEmbeddedDiffEditorKey.set("undefined"!==typeof t.isInEmbeddedEditor&&t.isInEmbeddedEditor),this._updateDecorationsRunner=this._register(new l.pY((()=>this._updateDecorations()),0)),this._containerDomElement=document.createElement("div"),this._containerDomElement.className=e._getClassName(this._themeService.getColorTheme(),this._options.renderSideBySide),this._containerDomElement.style.position="relative",this._containerDomElement.style.height="100%",this._domElement.appendChild(this._containerDomElement),this._overviewViewportDomElement=(0,n.X)(document.createElement("div")),this._overviewViewportDomElement.setClassName("diffViewport"),this._overviewViewportDomElement.setPosition("absolute"),this._overviewDomElement=document.createElement("div"),this._overviewDomElement.className="diffOverview",this._overviewDomElement.style.position="absolute",this._overviewDomElement.appendChild(this._overviewViewportDomElement.domNode),this._register(o.mu(this._overviewDomElement,o.tw.POINTER_DOWN,(e=>{this._modifiedEditor.delegateVerticalScrollbarPointerDown(e)}))),this._register(o.nm(this._overviewDomElement,o.tw.MOUSE_WHEEL,(e=>{this._modifiedEditor.delegateScrollFromMouseWheelEvent(e)}),{passive:!1})),this._options.renderOverviewRuler&&this._containerDomElement.appendChild(this._overviewDomElement),this._originalDomNode=document.createElement("div"),this._originalDomNode.className="editor original",this._originalDomNode.style.position="absolute",this._originalDomNode.style.height="100%",this._containerDomElement.appendChild(this._originalDomNode),this._modifiedDomNode=document.createElement("div"),this._modifiedDomNode.className="editor modified",this._modifiedDomNode.style.position="absolute",this._modifiedDomNode.style.height="100%",this._containerDomElement.appendChild(this._modifiedDomNode),this._beginUpdateDecorationsTimeout=-1,this._currentlyChangingViewZones=!1,this._diffComputationToken=0,this._originalEditorState=new Se(_,r),this._modifiedEditorState=new Se(_,r),this._isVisible=!0,this._isHandlingScrollEvent=!1,this._elementSizeObserver=this._register(new v.I(this._containerDomElement,t.dimension)),this._register(this._elementSizeObserver.onDidChange((()=>this._onDidContainerSizeChanged()))),t.automaticLayout&&this._elementSizeObserver.startObserving(),this._diffComputationResult=null,this._originalEditor=this._createLeftHandSideEditor(t,s.originalEditor||{}),this._modifiedEditor=this._createRightHandSideEditor(t,s.modifiedEditor||{}),this._originalOverviewRuler=null,this._modifiedOverviewRuler=null,this._reviewPane=d.createInstance(Z,this),this._containerDomElement.appendChild(this._reviewPane.domNode.domNode),this._containerDomElement.appendChild(this._reviewPane.shadow.domNode),this._containerDomElement.appendChild(this._reviewPane.actionBarContainer.domNode),this._options.renderSideBySide?this._setStrategy(new We(this._createDataSource(),this._options.enableSplitViewResizing,this._options.splitViewDefaultRatio)):this._setStrategy(new Ae(this._createDataSource(),this._options.enableSplitViewResizing)),this._register(g.onDidColorThemeChange((i=>{this._strategy&&this._strategy.applyColors(i)&&this._updateDecorationsRunner.schedule(),this._containerDomElement.className=e._getClassName(this._themeService.getColorTheme(),this._options.renderSideBySide)})));const C=p.Uc.getDiffEditorContributions();for(const e of C)try{this._register(d.createInstance(e.ctor,this))}catch(D){(0,u.dL)(D)}this._codeEditorService.addDiffEditor(this)}_setState(e){this._state!==e&&(this._state=e,this._updatingDiffProgress&&(this._updatingDiffProgress.done(),this._updatingDiffProgress=null),1===this._state&&(this._updatingDiffProgress=this._editorProgressService.show(!0,1e3)))}diffReviewNext(){this._reviewPane.next()}diffReviewPrev(){this._reviewPane.prev()}static _getClassName(e,i){let t="monaco-diff-editor monaco-editor-background ";return i&&(t+="side-by-side "),t+=(0,we.m6)(e.type),t}_disposeOverviewRulers(){this._originalOverviewRuler&&(this._overviewDomElement.removeChild(this._originalOverviewRuler.getDomNode()),this._originalOverviewRuler.dispose(),this._originalOverviewRuler=null),this._modifiedOverviewRuler&&(this._overviewDomElement.removeChild(this._modifiedOverviewRuler.getDomNode()),this._modifiedOverviewRuler.dispose(),this._modifiedOverviewRuler=null)}_createOverviewRulers(){this._options.renderOverviewRuler&&(d.ok(!this._originalOverviewRuler&&!this._modifiedOverviewRuler),this._originalEditor.hasModel()&&(this._originalOverviewRuler=this._originalEditor.createOverviewRuler("original diffOverviewRuler"),this._overviewDomElement.appendChild(this._originalOverviewRuler.getDomNode())),this._modifiedEditor.hasModel()&&(this._modifiedOverviewRuler=this._modifiedEditor.createOverviewRuler("modified diffOverviewRuler"),this._overviewDomElement.appendChild(this._modifiedOverviewRuler.getDomNode())),this._layoutOverviewRulers())}_createLeftHandSideEditor(i,t){const o=this._createInnerEditor(this._instantiationService,this._originalDomNode,this._adjustOptionsForLeftHandSide(i),t);this._register(o.onDidScrollChange((e=>{this._isHandlingScrollEvent||(e.scrollTopChanged||e.scrollLeftChanged||e.scrollHeightChanged)&&(this._isHandlingScrollEvent=!0,this._modifiedEditor.setScrollPosition({scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}),this._isHandlingScrollEvent=!1,this._layoutOverviewViewport())}))),this._register(o.onDidChangeViewZones((()=>{this._onViewZonesChanged()}))),this._register(o.onDidChangeConfiguration((e=>{o.getModel()&&(e.hasChanged(48)&&this._updateDecorationsRunner.schedule(),e.hasChanged(141)&&(this._updateDecorationsRunner.cancel(),this._updateDecorations()))}))),this._register(o.onDidChangeHiddenAreas((()=>{this._updateDecorationsRunner.cancel(),this._updateDecorations()}))),this._register(o.onDidChangeModelContent((()=>{this._isVisible&&this._beginUpdateDecorationsSoon()})));const n=this._contextKeyService.createKey("isInDiffLeftEditor",o.hasWidgetFocus());return this._register(o.onDidFocusEditorWidget((()=>n.set(!0)))),this._register(o.onDidBlurEditorWidget((()=>n.set(!1)))),this._register(o.onDidContentSizeChange((i=>{const t=this._originalEditor.getContentWidth()+this._modifiedEditor.getContentWidth()+e.ONE_OVERVIEW_WIDTH,o=Math.max(this._modifiedEditor.getContentHeight(),this._originalEditor.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:o,contentWidth:t,contentHeightChanged:i.contentHeightChanged,contentWidthChanged:i.contentWidthChanged})}))),o}_createRightHandSideEditor(i,t){const o=this._createInnerEditor(this._instantiationService,this._modifiedDomNode,this._adjustOptionsForRightHandSide(i),t);this._register(o.onDidScrollChange((e=>{this._isHandlingScrollEvent||(e.scrollTopChanged||e.scrollLeftChanged||e.scrollHeightChanged)&&(this._isHandlingScrollEvent=!0,this._originalEditor.setScrollPosition({scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}),this._isHandlingScrollEvent=!1,this._layoutOverviewViewport())}))),this._register(o.onDidChangeViewZones((()=>{this._onViewZonesChanged()}))),this._register(o.onDidChangeConfiguration((e=>{o.getModel()&&(e.hasChanged(48)&&this._updateDecorationsRunner.schedule(),e.hasChanged(141)&&(this._updateDecorationsRunner.cancel(),this._updateDecorations()))}))),this._register(o.onDidChangeHiddenAreas((()=>{this._updateDecorationsRunner.cancel(),this._updateDecorations()}))),this._register(o.onDidChangeModelContent((()=>{this._isVisible&&this._beginUpdateDecorationsSoon()}))),this._register(o.onDidChangeModelOptions((e=>{e.tabSize&&this._updateDecorationsRunner.schedule()})));const n=this._contextKeyService.createKey("isInDiffRightEditor",o.hasWidgetFocus());return this._register(o.onDidFocusEditorWidget((()=>n.set(!0)))),this._register(o.onDidBlurEditorWidget((()=>n.set(!1)))),this._register(o.onDidContentSizeChange((i=>{const t=this._originalEditor.getContentWidth()+this._modifiedEditor.getContentWidth()+e.ONE_OVERVIEW_WIDTH,o=Math.max(this._modifiedEditor.getContentHeight(),this._originalEditor.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:o,contentWidth:t,contentHeightChanged:i.contentHeightChanged,contentWidthChanged:i.contentWidthChanged})}))),this._register(o.onMouseDown((e=>{var i,t;if(!e.event.rightButton&&e.target.position&&(null===(i=e.target.element)||void 0===i?void 0:i.className.includes("arrow-revert-change"))){const i=e.target.position.lineNumber,o=e.target,n=null===(t=this._diffComputationResult)||void 0===t?void 0:t.changes.find((e=>(null===o||void 0===o?void 0:o.detail.afterLineNumber)===e.modifiedStartLineNumber||e.modifiedEndLineNumber>0&&e.modifiedStartLineNumber===i));return n&&this.revertChange(n),e.event.stopPropagation(),void this._updateDecorations()}}))),o}revertChange(e){const i=this._modifiedEditor,t=this._originalEditor.getModel(),o=this._modifiedEditor.getModel();if(!t||!o||!i)return;const n=e.originalEndLineNumber>0?new J.e(e.originalStartLineNumber,1,e.originalEndLineNumber,t.getLineMaxColumn(e.originalEndLineNumber)):null,s=n?t.getValueInRange(n):null,r=e.modifiedEndLineNumber>0?new J.e(e.modifiedStartLineNumber,1,e.modifiedEndLineNumber,o.getLineMaxColumn(e.modifiedEndLineNumber)):null,a=o.getEOL();if(0===e.originalEndLineNumber&&r){let t=r;e.modifiedStartLineNumber>1?t=r.setStartPosition(e.modifiedStartLineNumber-1,o.getLineMaxColumn(e.modifiedStartLineNumber-1)):e.modifiedEndLineNumber<o.getLineCount()&&(t=r.setEndPosition(e.modifiedEndLineNumber+1,1)),i.executeEdits("diffEditor",[{range:t,text:""}])}else if(0===e.modifiedEndLineNumber&&null!==s){const t=e.modifiedStartLineNumber<o.getLineCount()?new y.L(e.modifiedStartLineNumber+1,1):new y.L(e.modifiedStartLineNumber,o.getLineMaxColumn(e.modifiedStartLineNumber));i.executeEdits("diffEditor",[{range:J.e.fromPositions(t,t),text:e.modifiedStartLineNumber<o.getLineCount()?s+a:a+s}])}else r&&null!==s&&i.executeEdits("diffEditor",[{range:r,text:s}])}_createInnerEditor(e,i,t,o){return e.createInstance(w.Gm,i,t,o)}dispose(){this._codeEditorService.removeDiffEditor(this),-1!==this._beginUpdateDecorationsTimeout&&(window.clearTimeout(this._beginUpdateDecorationsTimeout),this._beginUpdateDecorationsTimeout=-1),this._cleanViewZonesAndDecorations(),this._originalOverviewRuler&&(this._overviewDomElement.removeChild(this._originalOverviewRuler.getDomNode()),this._originalOverviewRuler.dispose()),this._modifiedOverviewRuler&&(this._overviewDomElement.removeChild(this._modifiedOverviewRuler.getDomNode()),this._modifiedOverviewRuler.dispose()),this._overviewDomElement.removeChild(this._overviewViewportDomElement.domNode),this._options.renderOverviewRuler&&this._containerDomElement.removeChild(this._overviewDomElement),this._containerDomElement.removeChild(this._originalDomNode),this._originalEditor.dispose(),this._containerDomElement.removeChild(this._modifiedDomNode),this._modifiedEditor.dispose(),this._strategy.dispose(),this._containerDomElement.removeChild(this._reviewPane.domNode.domNode),this._containerDomElement.removeChild(this._reviewPane.shadow.domNode),this._containerDomElement.removeChild(this._reviewPane.actionBarContainer.domNode),this._reviewPane.dispose(),this._domElement.removeChild(this._containerDomElement),this._onDidDispose.fire(),super.dispose()}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return le.g.IDiffEditor}getLineChanges(){return this._diffComputationResult?this._diffComputationResult.changes:null}getOriginalEditor(){return this._originalEditor}getModifiedEditor(){return this._modifiedEditor}updateOptions(i){const t=qe(i,this._options),o=(n=this._options,s=t,{enableSplitViewResizing:n.enableSplitViewResizing!==s.enableSplitViewResizing,renderSideBySide:n.renderSideBySide!==s.renderSideBySide,renderMarginRevertIcon:n.renderMarginRevertIcon!==s.renderMarginRevertIcon,maxComputationTime:n.maxComputationTime!==s.maxComputationTime,maxFileSize:n.maxFileSize!==s.maxFileSize,ignoreTrimWhitespace:n.ignoreTrimWhitespace!==s.ignoreTrimWhitespace,renderIndicators:n.renderIndicators!==s.renderIndicators,originalEditable:n.originalEditable!==s.originalEditable,diffCodeLens:n.diffCodeLens!==s.diffCodeLens,renderOverviewRuler:n.renderOverviewRuler!==s.renderOverviewRuler,diffWordWrap:n.diffWordWrap!==s.diffWordWrap,diffAlgorithm:n.diffAlgorithm!==s.diffAlgorithm,accessibilityVerbose:n.accessibilityVerbose!==s.accessibilityVerbose});var n,s;this._options=t,this.isEmbeddedDiffEditorKey.set("undefined"!==typeof i.isInEmbeddedEditor&&i.isInEmbeddedEditor);const r=o.ignoreTrimWhitespace||o.renderIndicators||o.renderMarginRevertIcon,a=this._isVisible&&(o.maxComputationTime||o.maxFileSize);this._documentDiffProvider.setOptions(t),r?this._beginUpdateDecorations():a&&this._beginUpdateDecorationsSoon(),this._modifiedEditor.updateOptions(this._adjustOptionsForRightHandSide(i)),this._originalEditor.updateOptions(this._adjustOptionsForLeftHandSide(i)),this._strategy.setEnableSplitViewResizing(this._options.enableSplitViewResizing,this._options.splitViewDefaultRatio),o.renderSideBySide&&(this._options.renderSideBySide?this._setStrategy(new We(this._createDataSource(),this._options.enableSplitViewResizing,this._options.splitViewDefaultRatio)):this._setStrategy(new Ae(this._createDataSource(),this._options.enableSplitViewResizing)),this._containerDomElement.className=e._getClassName(this._themeService.getColorTheme(),this._options.renderSideBySide)),o.renderOverviewRuler&&(this._options.renderOverviewRuler?this._containerDomElement.appendChild(this._overviewDomElement):this._containerDomElement.removeChild(this._overviewDomElement))}getModel(){return{original:this._originalEditor.getModel(),modified:this._modifiedEditor.getModel()}}setModel(e){if(e&&(!e.original||!e.modified))throw new Error(e.original?"DiffEditorWidget.setModel: Modified model is null":"DiffEditorWidget.setModel: Original model is null");this._cleanViewZonesAndDecorations(),this._disposeOverviewRulers(),this._originalEditor.setModel(e?e.original:null),this._modifiedEditor.setModel(e?e.modified:null),this._updateDecorationsRunner.cancel(),e&&(this._originalEditor.setScrollTop(0),this._modifiedEditor.setScrollTop(0)),this._diffComputationResult=null,this._diffComputationToken++,this._setState(0),e&&(this._createOverviewRulers(),this._beginUpdateDecorations()),this._layoutOverviewViewport(),this._onDidChangeModel.fire(),this._diffNavigator=this._register(this._instantiationService.createInstance(b.F,this,{alwaysRevealFirst:!1,findResultLoop:this.getModifiedEditor().getOption(39).loop}))}getContainerDomNode(){return this._domElement}getVisibleColumnFromPosition(e){return this._modifiedEditor.getVisibleColumnFromPosition(e)}getPosition(){return this._modifiedEditor.getPosition()}setPosition(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this._modifiedEditor.setPosition(e,i)}revealLine(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._modifiedEditor.revealLine(e,i)}revealLineInCenter(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._modifiedEditor.revealLineInCenter(e,i)}revealLineInCenterIfOutsideViewport(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._modifiedEditor.revealLineInCenterIfOutsideViewport(e,i)}revealLineNearTop(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._modifiedEditor.revealLineNearTop(e,i)}revealPosition(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._modifiedEditor.revealPosition(e,i)}revealPositionInCenter(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._modifiedEditor.revealPositionInCenter(e,i)}revealPositionInCenterIfOutsideViewport(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._modifiedEditor.revealPositionInCenterIfOutsideViewport(e,i)}revealPositionNearTop(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._modifiedEditor.revealPositionNearTop(e,i)}getSelection(){return this._modifiedEditor.getSelection()}getSelections(){return this._modifiedEditor.getSelections()}setSelection(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this._modifiedEditor.setSelection(e,i)}setSelections(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this._modifiedEditor.setSelections(e,i)}revealLines(e,i){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._modifiedEditor.revealLines(e,i,t)}revealLinesInCenter(e,i){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._modifiedEditor.revealLinesInCenter(e,i,t)}revealLinesInCenterIfOutsideViewport(e,i){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._modifiedEditor.revealLinesInCenterIfOutsideViewport(e,i,t)}revealLinesNearTop(e,i){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._modifiedEditor.revealLinesNearTop(e,i,t)}revealRange(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this._modifiedEditor.revealRange(e,i,t,o)}revealRangeInCenter(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._modifiedEditor.revealRangeInCenter(e,i)}revealRangeInCenterIfOutsideViewport(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._modifiedEditor.revealRangeInCenterIfOutsideViewport(e,i)}revealRangeNearTop(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._modifiedEditor.revealRangeNearTop(e,i)}revealRangeNearTopIfOutsideViewport(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._modifiedEditor.revealRangeNearTopIfOutsideViewport(e,i)}revealRangeAtTop(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._modifiedEditor.revealRangeAtTop(e,i)}getSupportedActions(){return this._modifiedEditor.getSupportedActions()}focus(){this._modifiedEditor.focus()}trigger(e,i,t){this._modifiedEditor.trigger(e,i,t)}createDecorationsCollection(e){return this._modifiedEditor.createDecorationsCollection(e)}changeDecorations(e){return this._modifiedEditor.changeDecorations(e)}saveViewState(){return{original:this._originalEditor.saveViewState(),modified:this._modifiedEditor.saveViewState()}}restoreViewState(e){if(e&&e.original&&e.modified){const i=e;this._originalEditor.restoreViewState(i.original),this._modifiedEditor.restoreViewState(i.modified)}}layout(e){this._elementSizeObserver.observe(e)}hasTextFocus(){return this._originalEditor.hasTextFocus()||this._modifiedEditor.hasTextFocus()}_onDidContainerSizeChanged(){this._doLayout()}_getReviewHeight(){return this._reviewPane.isVisible()?this._elementSizeObserver.getHeight():0}_layoutOverviewRulers(){if(!this._options.renderOverviewRuler)return;if(!this._originalOverviewRuler||!this._modifiedOverviewRuler)return;const i=this._elementSizeObserver.getHeight(),t=this._getReviewHeight(),o=e.ENTIRE_DIFF_OVERVIEW_WIDTH-2*e.ONE_OVERVIEW_WIDTH;this._modifiedEditor.getLayoutInfo()&&(this._originalOverviewRuler.setLayout({top:0,width:e.ONE_OVERVIEW_WIDTH,right:o+e.ONE_OVERVIEW_WIDTH,height:i-t}),this._modifiedOverviewRuler.setLayout({top:0,right:0,width:e.ONE_OVERVIEW_WIDTH,height:i-t}))}_onViewZonesChanged(){this._currentlyChangingViewZones||this._updateDecorationsRunner.schedule()}_beginUpdateDecorationsSoon(){-1!==this._beginUpdateDecorationsTimeout&&(window.clearTimeout(this._beginUpdateDecorationsTimeout),this._beginUpdateDecorationsTimeout=-1),this._beginUpdateDecorationsTimeout=window.setTimeout((()=>this._beginUpdateDecorations()),e.UPDATE_DIFF_DECORATIONS_DELAY)}static _equals(e,i){return!e&&!i||!(!e||!i)&&e.toString()===i.toString()}_beginUpdateDecorations(){-1!==this._beginUpdateDecorationsTimeout&&(window.clearTimeout(this._beginUpdateDecorationsTimeout),this._beginUpdateDecorationsTimeout=-1);const i=this._originalEditor.getModel(),t=this._modifiedEditor.getModel();if(!i||!t)return;this._diffComputationToken++;const o=this._diffComputationToken,n=1024*this._options.maxFileSize*1024,s=e=>{const i=e.getValueLength();return 0===n||i<=n};s(i)&&s(t)?(this._setState(1),this._documentDiffProvider.computeDiff(i,t,{ignoreTrimWhitespace:this._options.ignoreTrimWhitespace,maxComputationTimeMs:this._options.maxComputationTime}).then((e=>{o===this._diffComputationToken&&i===this._originalEditor.getModel()&&t===this._modifiedEditor.getModel()&&(this._setState(2),this._diffComputationResult={identical:e.identical,quitEarly:e.quitEarly,changes2:e.changes,changes:e.changes.map((e=>{let i,t,o,n,s=e.innerChanges;return e.originalRange.isEmpty?(i=e.originalRange.startLineNumber-1,t=0,s=void 0):(i=e.originalRange.startLineNumber,t=e.originalRange.endLineNumberExclusive-1),e.modifiedRange.isEmpty?(o=e.modifiedRange.startLineNumber-1,n=0,s=void 0):(o=e.modifiedRange.startLineNumber,n=e.modifiedRange.endLineNumberExclusive-1),{originalStartLineNumber:i,originalEndLineNumber:t,modifiedStartLineNumber:o,modifiedEndLineNumber:n,charChanges:null===s||void 0===s?void 0:s.map((e=>({originalStartLineNumber:e.originalRange.startLineNumber,originalStartColumn:e.originalRange.startColumn,originalEndLineNumber:e.originalRange.endLineNumber,originalEndColumn:e.originalRange.endColumn,modifiedStartLineNumber:e.modifiedRange.startLineNumber,modifiedStartColumn:e.modifiedRange.startColumn,modifiedEndLineNumber:e.modifiedRange.endLineNumber,modifiedEndColumn:e.modifiedRange.endColumn})))}}))},this._updateDecorationsRunner.schedule(),this._onDidUpdateDiff.fire())}),(e=>{o===this._diffComputationToken&&i===this._originalEditor.getModel()&&t===this._modifiedEditor.getModel()&&(this._setState(2),this._diffComputationResult=null,this._updateDecorationsRunner.schedule())}))):e._equals(i.uri,this._lastOriginalWarning)&&e._equals(t.uri,this._lastModifiedWarning)||(this._lastOriginalWarning=i.uri,this._lastModifiedWarning=t.uri,this._notificationService.warn(O.NC("diff.tooLarge","Cannot compare files because one file is too large.")))}_cleanViewZonesAndDecorations(){this._originalEditorState.clean(this._originalEditor),this._modifiedEditorState.clean(this._modifiedEditor)}_updateDecorations(){if(!this._originalEditor.getModel()||!this._modifiedEditor.getModel())return;const e=this._diffComputationResult?this._diffComputationResult.changes:[],i=this._originalEditorState.getForeignViewZones(this._originalEditor.getWhitespaces()),t=this._modifiedEditorState.getForeignViewZones(this._modifiedEditor.getWhitespaces()),o=this._options.renderMarginRevertIcon&&!this._modifiedEditor.getOption(88),n=this._strategy.getEditorsDiffDecorations(e,this._options.ignoreTrimWhitespace,this._options.renderIndicators,o,i,t);try{this._currentlyChangingViewZones=!0,this._originalEditorState.apply(this._originalEditor,this._originalOverviewRuler,n.original,!1),this._modifiedEditorState.apply(this._modifiedEditor,this._modifiedOverviewRuler,n.modified,!0)}finally{this._currentlyChangingViewZones=!1}}_adjustOptionsForSubEditor(e){const i=Object.assign({},e);return i.inDiffEditor=!0,i.automaticLayout=!1,i.scrollbar=Object.assign({},i.scrollbar||{}),i.scrollbar.vertical="visible",i.folding=!1,i.codeLens=this._options.diffCodeLens,i.fixedOverflowWidgets=!0,i.minimap=Object.assign({},i.minimap||{}),i.minimap.enabled=!1,i}_adjustOptionsForLeftHandSide(e){const i=this._adjustOptionsForSubEditor(e);return this._options.renderSideBySide?i.wordWrapOverride1=this._options.diffWordWrap:(i.wordWrapOverride1="off",i.wordWrapOverride2="off"),e.originalAriaLabel&&(i.ariaLabel=e.originalAriaLabel),this._updateAriaLabel(i),i.readOnly=!this._options.originalEditable,i.dropIntoEditor={enabled:!i.readOnly},i.extraEditorClassName="original-in-monaco-diff-editor",Object.assign(Object.assign({},i),{dimension:{height:0,width:0}})}_updateAriaLabel(e){var i;let t=null!==(i=e.ariaLabel)&&void 0!==i?i:"";this._options.accessibilityVerbose?t+=Re:t&&(t=t.replaceAll(Re,"")),e.ariaLabel=t}_adjustOptionsForRightHandSide(i){const t=this._adjustOptionsForSubEditor(i);return i.modifiedAriaLabel&&(t.ariaLabel=i.modifiedAriaLabel),this._updateAriaLabel(t),t.wordWrapOverride1=this._options.diffWordWrap,t.revealHorizontalRightPadding=E.BH.revealHorizontalRightPadding.defaultValue+e.ENTIRE_DIFF_OVERVIEW_WIDTH,t.scrollbar.verticalHasArrows=!1,t.extraEditorClassName="modified-in-monaco-diff-editor",Object.assign(Object.assign({},t),{dimension:{height:0,width:0}})}doLayout(){this._elementSizeObserver.observe(),this._doLayout()}_doLayout(){const i=this._elementSizeObserver.getWidth(),t=this._elementSizeObserver.getHeight(),o=this._getReviewHeight(),n=this._strategy.layout();this._originalDomNode.style.width=n+"px",this._originalDomNode.style.left="0px",this._modifiedDomNode.style.width=i-n+"px",this._modifiedDomNode.style.left=n+"px",this._overviewDomElement.style.top="0px",this._overviewDomElement.style.height=t-o+"px",this._overviewDomElement.style.width=e.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",this._overviewDomElement.style.left=i-e.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",this._overviewViewportDomElement.setWidth(e.ENTIRE_DIFF_OVERVIEW_WIDTH),this._overviewViewportDomElement.setHeight(30),this._originalEditor.layout({width:n,height:t-o}),this._modifiedEditor.layout({width:i-n-(this._options.renderOverviewRuler?e.ENTIRE_DIFF_OVERVIEW_WIDTH:0),height:t-o}),(this._originalOverviewRuler||this._modifiedOverviewRuler)&&this._layoutOverviewRulers(),this._reviewPane.layout(t-o,i,o),this._layoutOverviewViewport()}_layoutOverviewViewport(){const e=this._computeOverviewViewport();e?(this._overviewViewportDomElement.setTop(e.top),this._overviewViewportDomElement.setHeight(e.height)):(this._overviewViewportDomElement.setTop(0),this._overviewViewportDomElement.setHeight(0))}_computeOverviewViewport(){const e=this._modifiedEditor.getLayoutInfo();if(!e)return null;const i=this._modifiedEditor.getScrollTop(),t=this._modifiedEditor.getScrollHeight(),o=Math.max(0,e.height),n=Math.max(0,o-0),s=t>0?n/t:0;return{height:Math.max(0,Math.floor(e.height*s)),top:Math.floor(i*s)}}_createDataSource(){return{getWidth:()=>this._elementSizeObserver.getWidth(),getHeight:()=>this._elementSizeObserver.getHeight()-this._getReviewHeight(),getOptions:()=>({renderOverviewRuler:this._options.renderOverviewRuler}),getContainerDomNode:()=>this._containerDomElement,relayoutEditors:()=>{this._doLayout()},getOriginalEditor:()=>this._originalEditor,getModifiedEditor:()=>this._modifiedEditor}}_setStrategy(e){var i;null===(i=this._strategy)||void 0===i||i.dispose(),this._strategy=e,this._boundarySashes&&e.setBoundarySashes(this._boundarySashes),e.applyColors(this._themeService.getColorTheme()),this._diffComputationResult&&this._updateDecorations(),this._doLayout()}_getLineChangeAtOrBeforeLineNumber(e,i){const t=this._diffComputationResult?this._diffComputationResult.changes:[];if(0===t.length||e<i(t[0]))return null;let o=0,n=t.length-1;for(;o<n;){const s=Math.floor((o+n)/2),r=i(t[s]),a=s+1<=n?i(t[s+1]):1073741824;e<r?n=s-1:e>=a?o=s+1:(o=s,n=s)}return t[o]}_getEquivalentLineForOriginalLineNumber(e){const i=this._getLineChangeAtOrBeforeLineNumber(e,(e=>e.originalStartLineNumber));if(!i)return e;const t=i.originalStartLineNumber+(i.originalEndLineNumber>0?-1:0),o=i.modifiedStartLineNumber+(i.modifiedEndLineNumber>0?-1:0),n=i.originalEndLineNumber>0?i.originalEndLineNumber-i.originalStartLineNumber+1:0,s=i.modifiedEndLineNumber>0?i.modifiedEndLineNumber-i.modifiedStartLineNumber+1:0,r=e-t;return r<=n?o+Math.min(r,s):o+s-n+r}_getEquivalentLineForModifiedLineNumber(e){const i=this._getLineChangeAtOrBeforeLineNumber(e,(e=>e.modifiedStartLineNumber));if(!i)return e;const t=i.originalStartLineNumber+(i.originalEndLineNumber>0?-1:0),o=i.modifiedStartLineNumber+(i.modifiedEndLineNumber>0?-1:0),n=i.originalEndLineNumber>0?i.originalEndLineNumber-i.originalStartLineNumber+1:0,s=i.modifiedEndLineNumber>0?i.modifiedEndLineNumber-i.modifiedStartLineNumber+1:0,r=e-o;return r<=s?t+Math.min(r,n):t+n-s+r}getDiffLineInformationForOriginal(e){return this._diffComputationResult?{equivalentLineNumber:this._getEquivalentLineForOriginalLineNumber(e)}:null}getDiffLineInformationForModified(e){return this._diffComputationResult?{equivalentLineNumber:this._getEquivalentLineForModifiedLineNumber(e)}:null}};Ie.ONE_OVERVIEW_WIDTH=15,Ie.ENTIRE_DIFF_OVERVIEW_WIDTH=30,Ie.UPDATE_DIFF_DECORATIONS_DELAY=200,Ie=be([Le(3,me.p),Le(4,V.i6),Le(5,fe.TG),Le(6,C.$),Le(7,we.XE),Le(8,pe.lT),Le(9,_e.i),Le(10,Ce.ek)],Ie);class Te extends m.JT{constructor(e){super(),this._dataSource=e,this._insertColor=null,this._removeColor=null}applyColors(e){const i=e.getColor(De.P6Y)||(e.getColor(De.ypS)||De.CzK).transparent(2),t=e.getColor(De.F9q)||(e.getColor(De.P4M)||De.keg).transparent(2),o=!i.equals(this._insertColor)||!t.equals(this._removeColor);return this._insertColor=i,this._removeColor=t,o}getEditorsDiffDecorations(e,i,t,o,n,s){s=s.sort(((e,i)=>e.afterLineNumber-i.afterLineNumber)),n=n.sort(((e,i)=>e.afterLineNumber-i.afterLineNumber));const r=this._getViewZones(e,n,s,t),a=this._getOriginalEditorDecorations(r,e,i,t),d=this._getModifiedEditorDecorations(r,e,i,t,o);return{original:{decorations:a.decorations,overviewZones:a.overviewZones,zones:r.original},modified:{decorations:d.decorations,overviewZones:d.overviewZones,zones:r.modified}}}setBoundarySashes(e){}}class Oe{constructor(e){this._source=e,this._index=-1,this.current=null,this.advance()}advance(){this._index++,this._index<this._source.length?this.current=this._source[this._index]:this.current=null}}class xe{constructor(e,i,t,o,n){this._lineChanges=e,this._originalForeignVZ=i,this._modifiedForeignVZ=t,this._originalEditor=o,this._modifiedEditor=n}static _getViewLineCount(e,i,t){const o=e.getModel(),n=e._getViewModel();if(o&&n){const e=Ke(o,n,i,t);return e.endLineNumber-e.startLineNumber+1}return t-i+1}getViewZones(){const e=this._originalEditor.getOption(64),i=this._modifiedEditor.getOption(64),t=-1!==this._originalEditor.getOption(141).wrappingColumn,o=-1!==this._modifiedEditor.getOption(141).wrappingColumn,n=t||o,s=this._originalEditor.getModel(),r=this._originalEditor._getViewModel().coordinatesConverter,a=this._modifiedEditor._getViewModel().coordinatesConverter,d=[],l=[];let h=0,u=0,c=0,g=0,m=0,_=0;const f=(e,i)=>e.afterLineNumber-i.afterLineNumber,v=(e,i)=>{if(null===i.domNode&&e.length>0){const t=e[e.length-1];if(t.afterLineNumber===i.afterLineNumber&&null===t.domNode)return void(t.heightInLines+=i.heightInLines)}e.push(i)},p=new Oe(this._modifiedForeignVZ),C=new Oe(this._originalForeignVZ);let D=1,w=1;for(let b=0,L=this._lineChanges.length;b<=L;b++){const t=b<L?this._lineChanges[b]:null;null!==t?(c=t.originalStartLineNumber+(t.originalEndLineNumber>0?-1:0),g=t.modifiedStartLineNumber+(t.modifiedEndLineNumber>0?-1:0),u=t.originalEndLineNumber>0?xe._getViewLineCount(this._originalEditor,t.originalStartLineNumber,t.originalEndLineNumber):0,h=t.modifiedEndLineNumber>0?xe._getViewLineCount(this._modifiedEditor,t.modifiedStartLineNumber,t.modifiedEndLineNumber):0,m=Math.max(t.originalStartLineNumber,t.originalEndLineNumber),_=Math.max(t.modifiedStartLineNumber,t.modifiedEndLineNumber)):(c+=1e7+u,g+=1e7+h,m=c,_=g);let o=[],S=[];if(n){let e;e=t?t.originalEndLineNumber>0?t.originalStartLineNumber-D:t.modifiedStartLineNumber-w:s.getLineCount()-D+1;for(let i=0;i<e;i++){const e=D+i,t=w+i,n=r.getModelLineViewLineCount(e),s=a.getModelLineViewLineCount(t);n<s?o.push({afterLineNumber:e,heightInLines:s-n,domNode:null,marginDomNode:null}):n>s&&S.push({afterLineNumber:t,heightInLines:n-s,domNode:null,marginDomNode:null})}t&&(D=(t.originalEndLineNumber>0?t.originalEndLineNumber:t.originalStartLineNumber)+1,w=(t.modifiedEndLineNumber>0?t.modifiedEndLineNumber:t.modifiedStartLineNumber)+1)}for(;p.current&&p.current.afterLineNumber<=_;){let e;e=p.current.afterLineNumber<=g?c-g+p.current.afterLineNumber:m;let n=null;t&&t.modifiedStartLineNumber<=p.current.afterLineNumber&&p.current.afterLineNumber<=t.modifiedEndLineNumber&&(n=this._createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion()),o.push({afterLineNumber:e,heightInLines:p.current.height/i,domNode:null,marginDomNode:n}),p.advance()}for(;C.current&&C.current.afterLineNumber<=m;){let i;i=C.current.afterLineNumber<=c?g-c+C.current.afterLineNumber:_,S.push({afterLineNumber:i,heightInLines:C.current.height/e,domNode:null}),C.advance()}if(null!==t&&ke(t)){const e=this._produceOriginalFromDiff(t,u,h);e&&o.push(e)}if(null!==t&&ze(t)){const e=this._produceModifiedFromDiff(t,u,h);e&&S.push(e)}let N=0,E=0;for(o=o.sort(f),S=S.sort(f);N<o.length&&E<S.length;){const e=o[N],i=S[E],t=e.afterLineNumber-c,n=i.afterLineNumber-g;t<n?(v(d,e),N++):n<t?(v(l,i),E++):e.shouldNotShrink?(v(d,e),N++):i.shouldNotShrink?(v(l,i),E++):e.heightInLines>=i.heightInLines?(e.heightInLines-=i.heightInLines,E++):(i.heightInLines-=e.heightInLines,N++)}for(;N<o.length;)v(d,o[N]),N++;for(;E<S.length;)v(l,S[E]),E++}return{original:xe._ensureDomNodes(d),modified:xe._ensureDomNodes(l)}}static _ensureDomNodes(e){return e.map((e=>(e.domNode||(e.domNode=Qe()),e)))}}function Pe(e,i,t,o,n){return{range:new J.e(e,i,t,o),options:n}}const Ve={arrowRevertChange:ue.qx.register({description:"diff-editor-arrow-revert-change",glyphMarginHoverMessage:new g.W5(void 0,{isTrusted:!0,supportThemeIcons:!0}).appendMarkdown(O.NC("revertChangeHoverMessage","Click to revert change")),glyphMarginClassName:"arrow-revert-change "+_.k.asClassName(h.l.arrowRight),zIndex:10001}),charDelete:ue.qx.register({description:"diff-editor-char-delete",className:"char-delete"}),charDeleteWholeLine:ue.qx.register({description:"diff-editor-char-delete-whole-line",className:"char-delete",isWholeLine:!0}),charInsert:ue.qx.register({description:"diff-editor-char-insert",className:"char-insert"}),charInsertWholeLine:ue.qx.register({description:"diff-editor-char-insert-whole-line",className:"char-insert",isWholeLine:!0}),lineInsert:ue.qx.register({description:"diff-editor-line-insert",className:"line-insert",marginClassName:"gutter-insert",isWholeLine:!0}),lineInsertWithSign:ue.qx.register({description:"diff-editor-line-insert-with-sign",className:"line-insert",linesDecorationsClassName:"insert-sign "+_.k.asClassName(Ee),marginClassName:"gutter-insert",isWholeLine:!0}),lineDelete:ue.qx.register({description:"diff-editor-line-delete",className:"line-delete",marginClassName:"gutter-delete",isWholeLine:!0}),lineDeleteWithSign:ue.qx.register({description:"diff-editor-line-delete-with-sign",className:"line-delete",linesDecorationsClassName:"delete-sign "+_.k.asClassName(ye),marginClassName:"gutter-delete",isWholeLine:!0}),lineDeleteMargin:ue.qx.register({description:"diff-editor-line-delete-margin",marginClassName:"gutter-delete"})};class We extends Te{constructor(e,i,t){super(e),this._disableSash=!1===i,this._defaultRatio=t,this._sashRatio=null,this._sashPosition=null,this._startSashPosition=null,this._sash=this._register(new a.g(this._dataSource.getContainerDomNode(),this,{orientation:0})),this._disableSash&&(this._sash.state=0),this._sash.onDidStart((()=>this._onSashDragStart())),this._sash.onDidChange((e=>this._onSashDrag(e))),this._sash.onDidEnd((()=>this._onSashDragEnd())),this._sash.onDidReset((()=>this._onSashReset()))}setEnableSplitViewResizing(e,i){this._defaultRatio=i;const t=!1===e;this._disableSash!==t&&(this._disableSash=t,this._sash.state=this._disableSash?0:3)}layout(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._sashRatio||this._defaultRatio;const i=this._dataSource.getWidth()-(this._dataSource.getOptions().renderOverviewRuler?Ie.ENTIRE_DIFF_OVERVIEW_WIDTH:0);let t=Math.floor((e||this._defaultRatio)*i);const o=Math.floor(this._defaultRatio*i);return t=this._disableSash?o:t||o,i>2*We.MINIMUM_EDITOR_WIDTH?(t<We.MINIMUM_EDITOR_WIDTH&&(t=We.MINIMUM_EDITOR_WIDTH),t>i-We.MINIMUM_EDITOR_WIDTH&&(t=i-We.MINIMUM_EDITOR_WIDTH)):t=o,this._sashPosition!==t&&(this._sashPosition=t),this._sash.layout(),this._sashPosition}_onSashDragStart(){this._startSashPosition=this._sashPosition}_onSashDrag(e){const i=this._dataSource.getWidth()-(this._dataSource.getOptions().renderOverviewRuler?Ie.ENTIRE_DIFF_OVERVIEW_WIDTH:0),t=this.layout((this._startSashPosition+(e.currentX-e.startX))/i);this._sashRatio=t/i,this._dataSource.relayoutEditors()}_onSashDragEnd(){this._sash.layout()}_onSashReset(){this._sashRatio=this._defaultRatio,this._dataSource.relayoutEditors(),this._sash.layout()}getVerticalSashTop(e){return 0}getVerticalSashLeft(e){return this._sashPosition}getVerticalSashHeight(e){return this._dataSource.getHeight()}setBoundarySashes(e){this._sash.orthogonalEndSash=e.bottom}_getViewZones(e,i,t){const o=this._dataSource.getOriginalEditor(),n=this._dataSource.getModifiedEditor();return new Fe(e,i,t,o,n).getViewZones()}_getOriginalEditorDecorations(e,i,t,o){const n=this._dataSource.getOriginalEditor(),s=String(this._removeColor),r={decorations:[],overviewZones:[]},a=n.getModel(),d=n._getViewModel();for(const l of i)if(ze(l)){r.decorations.push({range:new J.e(l.originalStartLineNumber,1,l.originalEndLineNumber,1073741824),options:o?Ve.lineDeleteWithSign:Ve.lineDelete}),ke(l)&&l.charChanges||r.decorations.push(Pe(l.originalStartLineNumber,1,l.originalEndLineNumber,1073741824,Ve.charDeleteWholeLine));const e=Ke(a,d,l.originalStartLineNumber,l.originalEndLineNumber);if(r.overviewZones.push(new ge.EY(e.startLineNumber,e.endLineNumber,0,s)),l.charChanges)for(const i of l.charChanges)if(Be(i))if(t)for(let e=i.originalStartLineNumber;e<=i.originalEndLineNumber;e++){let t,o;t=e===i.originalStartLineNumber?i.originalStartColumn:a.getLineFirstNonWhitespaceColumn(e),o=e===i.originalEndLineNumber?i.originalEndColumn:a.getLineLastNonWhitespaceColumn(e),r.decorations.push(Pe(e,t,e,o,Ve.charDelete))}else r.decorations.push(Pe(i.originalStartLineNumber,i.originalStartColumn,i.originalEndLineNumber,i.originalEndColumn,Ve.charDelete))}return r}_getModifiedEditorDecorations(e,i,t,o,n){const s=this._dataSource.getModifiedEditor(),r=String(this._insertColor),a={decorations:[],overviewZones:[]},d=s.getModel(),l=s._getViewModel();for(const h of i){if(n)if(h.modifiedEndLineNumber>0)a.decorations.push({range:new J.e(h.modifiedStartLineNumber,1,h.modifiedStartLineNumber,1),options:Ve.arrowRevertChange});else{const i=e.modified.find((e=>e.afterLineNumber===h.modifiedStartLineNumber));i&&(i.marginDomNode=Ze())}if(ke(h)){a.decorations.push({range:new J.e(h.modifiedStartLineNumber,1,h.modifiedEndLineNumber,1073741824),options:o?Ve.lineInsertWithSign:Ve.lineInsert}),ze(h)&&h.charChanges||a.decorations.push(Pe(h.modifiedStartLineNumber,1,h.modifiedEndLineNumber,1073741824,Ve.charInsertWholeLine));const e=Ke(d,l,h.modifiedStartLineNumber,h.modifiedEndLineNumber);if(a.overviewZones.push(new ge.EY(e.startLineNumber,e.endLineNumber,0,r)),h.charChanges)for(const i of h.charChanges)if(Ue(i))if(t)for(let e=i.modifiedStartLineNumber;e<=i.modifiedEndLineNumber;e++){let t,o;t=e===i.modifiedStartLineNumber?i.modifiedStartColumn:d.getLineFirstNonWhitespaceColumn(e),o=e===i.modifiedEndLineNumber?i.modifiedEndColumn:d.getLineLastNonWhitespaceColumn(e),a.decorations.push(Pe(e,t,e,o,Ve.charInsert))}else a.decorations.push(Pe(i.modifiedStartLineNumber,i.modifiedStartColumn,i.modifiedEndLineNumber,i.modifiedEndColumn,Ve.charInsert))}}return a}}We.MINIMUM_EDITOR_WIDTH=100;class Fe extends xe{constructor(e,i,t,o,n){super(e,i,t,o,n)}_createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion(){return null}_produceOriginalFromDiff(e,i,t){return t>i?{afterLineNumber:Math.max(e.originalStartLineNumber,e.originalEndLineNumber),heightInLines:t-i,domNode:null}:null}_produceModifiedFromDiff(e,i,t){return i>t?{afterLineNumber:Math.max(e.modifiedStartLineNumber,e.modifiedEndLineNumber),heightInLines:i-t,domNode:null}:null}}class Ae extends Te{constructor(e,i){super(e),this._decorationsLeft=e.getOriginalEditor().getLayoutInfo().decorationsLeft,this._register(e.getOriginalEditor().onDidLayoutChange((i=>{this._decorationsLeft!==i.decorationsLeft&&(this._decorationsLeft=i.decorationsLeft,e.relayoutEditors())})))}setEnableSplitViewResizing(e){}_getViewZones(e,i,t,o){const n=this._dataSource.getOriginalEditor(),s=this._dataSource.getModifiedEditor();return new He(e,i,t,n,s,o).getViewZones()}_getOriginalEditorDecorations(e,i,t,o){const n=String(this._removeColor),s={decorations:[],overviewZones:[]},r=this._dataSource.getOriginalEditor(),a=r.getModel(),d=r._getViewModel();let l=0;for(const h of i)if(ze(h)){for(s.decorations.push({range:new J.e(h.originalStartLineNumber,1,h.originalEndLineNumber,1073741824),options:Ve.lineDeleteMargin});l<e.modified.length;){const i=e.modified[l];if(i.diff&&i.diff.originalStartLineNumber>=h.originalStartLineNumber)break;l++}let i=0;if(l<e.modified.length){const t=e.modified[l];t.diff&&t.diff.originalStartLineNumber===h.originalStartLineNumber&&t.diff.originalEndLineNumber===h.originalEndLineNumber&&t.diff.modifiedStartLineNumber===h.modifiedStartLineNumber&&t.diff.modifiedEndLineNumber===h.modifiedEndLineNumber&&(i=t.heightInLines)}const t=Ke(a,d,h.originalStartLineNumber,h.originalEndLineNumber);s.overviewZones.push(new ge.EY(t.startLineNumber,t.endLineNumber,i,n))}return s}_getModifiedEditorDecorations(e,i,t,o,n){const s=this._dataSource.getModifiedEditor(),r=String(this._insertColor),a={decorations:[],overviewZones:[]},d=s.getModel(),l=s._getViewModel();for(const h of i)if(ke(h)){a.decorations.push({range:new J.e(h.modifiedStartLineNumber,1,h.modifiedEndLineNumber,1073741824),options:o?Ve.lineInsertWithSign:Ve.lineInsert});const e=Ke(d,l,h.modifiedStartLineNumber,h.modifiedEndLineNumber);if(a.overviewZones.push(new ge.EY(e.startLineNumber,e.endLineNumber,0,r)),h.charChanges){for(const i of h.charChanges)if(Ue(i))if(t)for(let e=i.modifiedStartLineNumber;e<=i.modifiedEndLineNumber;e++){let t,o;t=e===i.modifiedStartLineNumber?i.modifiedStartColumn:d.getLineFirstNonWhitespaceColumn(e),o=e===i.modifiedEndLineNumber?i.modifiedEndColumn:d.getLineLastNonWhitespaceColumn(e),a.decorations.push(Pe(e,t,e,o,Ve.charInsert))}else a.decorations.push(Pe(i.modifiedStartLineNumber,i.modifiedStartColumn,i.modifiedEndLineNumber,i.modifiedEndColumn,Ve.charInsert))}else a.decorations.push(Pe(h.modifiedStartLineNumber,1,h.modifiedEndLineNumber,1073741824,Ve.charInsertWholeLine))}return a}layout(){return Math.max(5,this._decorationsLeft)}}class He extends xe{constructor(e,i,t,o,n,s){super(e,i,t,o,n),this._originalModel=o.getModel(),this._renderIndicators=s,this._pendingLineChange=[],this._pendingViewZones=[],this._lineBreaksComputer=this._modifiedEditor._getViewModel().createLineBreaksComputer()}getViewZones(){const e=super.getViewZones();return this._finalize(e),e}_createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion(){const e=document.createElement("div");return e.className="inline-added-margin-view-zone",e}_produceOriginalFromDiff(e,i,t){const o=document.createElement("div");return o.className="inline-added-margin-view-zone",{afterLineNumber:Math.max(e.originalStartLineNumber,e.originalEndLineNumber),heightInLines:t,domNode:document.createElement("div"),marginDomNode:o}}_produceModifiedFromDiff(e,i,t){const o=document.createElement("div");o.className="view-lines line-delete ".concat(r.S);const n=document.createElement("div");n.className="inline-deleted-margin-view-zone";const s={shouldNotShrink:!0,afterLineNumber:0===e.modifiedEndLineNumber?e.modifiedStartLineNumber:e.modifiedStartLineNumber-1,heightInLines:i,minWidthInPx:0,domNode:o,marginDomNode:n,diff:{originalStartLineNumber:e.originalStartLineNumber,originalEndLineNumber:e.originalEndLineNumber,modifiedStartLineNumber:e.modifiedStartLineNumber,modifiedEndLineNumber:e.modifiedEndLineNumber,originalModel:this._originalModel,viewLineCounts:null}};for(let r=e.originalStartLineNumber;r<=e.originalEndLineNumber;r++)this._lineBreaksComputer.addRequest(this._originalModel.getLineContent(r),null,null);return this._pendingLineChange.push(e),this._pendingViewZones.push(s),s}_finalize(e){const i=this._modifiedEditor.getOptions(),t=this._modifiedEditor.getModel().getOptions().tabSize,o=i.get(48),n=i.get(31),s=o.typicalHalfwidthCharacterWidth,r=i.get(100),a=this._originalModel.mightContainNonBasicASCII(),d=this._originalModel.mightContainRTL(),l=i.get(64),h=i.get(140).decorationsWidth,u=i.get(113),c=i.get(95),g=i.get(90),m=i.get(49),_=this._lineBreaksComputer.finalize();let v=0;for(let p=0;p<this._pendingLineChange.length;p++){const i=this._pendingLineChange[p],C=this._pendingViewZones[p],D=C.domNode;(0,f.N)(D,o);const w=C.marginDomNode;(0,f.N)(w,o);const b=[];if(i.charChanges)for(const e of i.charChanges)Be(e)&&b.push(new T.$t(new J.e(e.originalStartLineNumber,e.originalStartColumn,e.originalEndLineNumber,e.originalEndColumn),"char-delete",0));const L=b.length>0,S=new de.HT(1e4);let N=0,E=0,y=null;for(let s=i.originalStartLineNumber;s<=i.originalEndLineNumber;s++){const r=s-i.originalStartLineNumber,f=this._originalModel.tokenization.getLineTokens(s),p=f.getLineContent(),D=_[v++],M=ce.Kp.filter(b,s,1,p.length+1);if(D){let i=0;for(const e of D.breakOffsets){const s=f.sliceAndInflate(i,e,0),r=p.substring(i,e);N=Math.max(N,this._renderOriginalLine(E++,r,s,ce.Kp.extractWrapped(M,i,e),L,a,d,o,n,l,h,u,c,g,m,t,S,w)),i=e}for(y||(y=[]);y.length<r;)y[y.length]=1;y[r]=D.breakOffsets.length,C.heightInLines+=D.breakOffsets.length-1;const _=document.createElement("div");_.className="gutter-delete",e.original.push({afterLineNumber:s,afterColumn:0,heightInLines:D.breakOffsets.length-1,domNode:Qe(),marginDomNode:_})}else N=Math.max(N,this._renderOriginalLine(E++,p,f,M,L,a,d,o,n,l,h,u,c,g,m,t,S,w))}N+=r;const M=S.build(),R=Me?Me.createHTML(M):M;if(D.innerHTML=R,C.minWidthInPx=N*s,y){const e=i.originalEndLineNumber-i.originalStartLineNumber;for(;y.length<=e;)y[y.length]=1}C.diff.viewLineCounts=y}e.original.sort(((e,i)=>e.afterLineNumber-i.afterLineNumber))}_renderOriginalLine(e,i,t,o,n,s,r,a,d,l,h,u,c,g,m,f,v,p){v.appendString('<div class="view-line'),n||v.appendString(" char-delete"),v.appendString('" style="top:'),v.appendString(String(e*l)),v.appendString('px;width:1000000px;">');const C=T.wA.isBasicASCII(i,s),D=T.wA.containsRTL(i,C,r),w=(0,I.d1)(new I.IJ(a.isMonospace&&!d,a.canUseHalfwidthRightwardsArrow,i,!1,C,D,0,t,o,f,0,a.spaceWidth,a.middotWidth,a.wsmiddotWidth,u,c,g,m!==E.n0.OFF,null),v);if(v.appendString("</div>"),this._renderIndicators){const i=document.createElement("div");i.className="delete-sign ".concat(_.k.asClassName(ye)),i.setAttribute("style","position:absolute;top:".concat(e*l,"px;width:").concat(h,"px;height:").concat(l,"px;right:0;")),p.appendChild(i)}return w.characterMapping.getHorizontalOffset(w.characterMapping.length)}}function ke(e){return e.modifiedEndLineNumber>0}function ze(e){return e.originalEndLineNumber>0}function Ue(e){return e.modifiedStartLineNumber===e.modifiedEndLineNumber?e.modifiedEndColumn-e.modifiedStartColumn>0:e.modifiedEndLineNumber-e.modifiedStartLineNumber>0}function Be(e){return e.originalStartLineNumber===e.originalEndLineNumber?e.originalEndColumn-e.originalStartColumn>0:e.originalEndLineNumber-e.originalStartLineNumber>0}function Qe(){const e=document.createElement("div");return e.className="diagonal-fill",e}function Ze(){const e=document.createElement("div");return e.className="arrow-revert-change "+_.k.asClassName(h.l.arrowRight),o.$("div",{},e)}function Ke(e,i,t,o){const n=e.getLineCount();return t=Math.min(n,Math.max(1,t)),o=Math.min(n,Math.max(1,o)),i.coordinatesConverter.convertModelRangeToViewRange(new J.e(t,e.getLineMinColumn(t),o,e.getLineMaxColumn(o)))}function qe(e,i){return{enableSplitViewResizing:(0,E.O7)(e.enableSplitViewResizing,i.enableSplitViewResizing),splitViewDefaultRatio:(0,E.L_)(e.splitViewDefaultRatio,.5,.1,.9),renderSideBySide:(0,E.O7)(e.renderSideBySide,i.renderSideBySide),renderMarginRevertIcon:(0,E.O7)(e.renderMarginRevertIcon,i.renderMarginRevertIcon),maxComputationTime:(0,E.Zc)(e.maxComputationTime,i.maxComputationTime,0,1073741824),maxFileSize:(0,E.Zc)(e.maxFileSize,i.maxFileSize,0,1073741824),ignoreTrimWhitespace:(0,E.O7)(e.ignoreTrimWhitespace,i.ignoreTrimWhitespace),renderIndicators:(0,E.O7)(e.renderIndicators,i.renderIndicators),originalEditable:(0,E.O7)(e.originalEditable,i.originalEditable),diffCodeLens:(0,E.O7)(e.diffCodeLens,i.diffCodeLens),renderOverviewRuler:(0,E.O7)(e.renderOverviewRuler,i.renderOverviewRuler),diffWordWrap:(t=e.diffWordWrap,o=i.diffWordWrap,(0,E.NY)(t,o,["off","on","inherit"])),diffAlgorithm:(0,E.NY)(e.diffAlgorithm,i.diffAlgorithm,["legacy","advanced"],{smart:"legacy",experimental:"advanced"}),accessibilityVerbose:(0,E.O7)(e.accessibilityVerbose,i.accessibilityVerbose),experimental:{collapseUnchangedRegions:!1}};var t,o}(0,we.Ic)(((e,i)=>{const t=e.getColor(De.L_t);i.addRule("\n\t.monaco-editor .diagonal-fill {\n\t\tbackground-image: linear-gradient(\n\t\t\t-45deg,\n\t\t\t".concat(t," 12.5%,\n\t\t\t#0000 12.5%, #0000 50%,\n\t\t\t").concat(t," 50%, ").concat(t," 62.5%,\n\t\t\t#0000 62.5%, #0000 100%\n\t\t);\n\t\tbackground-size: 8px 8px;\n\t}\n\t"))}))},48830:(e,i,t)=>{t.d(i,{F:()=>m});var o=t(26728),n=t(68515),s=t(59652),r=t(62922),a=t(55597),d=t(49396),l=t(3527),h=t(65429),u=function(e,i,t,o){var n,s=arguments.length,r=s<3?i:null===o?o=Object.getOwnPropertyDescriptor(i,t):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,i,t,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(r=(s<3?n(r):s>3?n(i,t,r):n(i,t))||r);return s>3&&r&&Object.defineProperty(i,t,r),r},c=function(e,i){return function(t,o){i(t,o,e)}};const g={followsCaret:!0,ignoreCharChanges:!0,alwaysRevealFirst:!0,findResultLoop:!0};let m=class extends s.JT{constructor(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;super(),this._audioCueService=t,this._codeEditorService=o,this._accessibilityService=s,this._onDidUpdate=this._register(new n.Q5),this._editor=e,this._options=r.jB(i,g,!1),this.disposed=!1,this.nextIdx=-1,this.ranges=[],this.ignoreSelectionChange=!1,this.revealFirst=Boolean(this._options.alwaysRevealFirst),this._register(this._editor.onDidUpdateDiff((()=>this._onDiffUpdated()))),this._options.followsCaret&&this._register(this._editor.getModifiedEditor().onDidChangeCursorPosition((e=>{this.ignoreSelectionChange||(this._updateAccessibilityState(e.position.lineNumber),this.nextIdx=-1)}))),this._init()}_init(){this._editor.getLineChanges()}_onDiffUpdated(){this._init(),this._compute(this._editor.getLineChanges()),this.revealFirst&&null!==this._editor.getLineChanges()&&(this.revealFirst=!1,this.nextIdx=-1,this.next(1))}_compute(e){this.ranges=[],e&&e.forEach((e=>{!this._options.ignoreCharChanges&&e.charChanges?e.charChanges.forEach((e=>{this.ranges.push({rhs:!0,range:new a.e(e.modifiedStartLineNumber,e.modifiedStartColumn,e.modifiedEndLineNumber,e.modifiedEndColumn)})})):0===e.modifiedEndLineNumber?this.ranges.push({rhs:!0,range:new a.e(e.modifiedStartLineNumber,1,e.modifiedStartLineNumber+1,1)}):this.ranges.push({rhs:!0,range:new a.e(e.modifiedStartLineNumber,1,e.modifiedEndLineNumber+1,1)})})),this.ranges.sort(((e,i)=>a.e.compareRangesUsingStarts(e.range,i.range))),this._onDidUpdate.fire(this)}_initIdx(e){let i=!1;const t=this._editor.getPosition();if(t){for(let o=0,n=this.ranges.length;o<n&&!i;o++){const n=this.ranges[o].range;t.isBeforeOrEqual(n.getStartPosition())&&(this.nextIdx=o+(e?0:-1),i=!0)}i||(this.nextIdx=e?0:this.ranges.length-1),this.nextIdx<0&&(this.nextIdx=this.ranges.length-1)}else this.nextIdx=0}_move(e,i){if(o.ok(!this.disposed,"Illegal State - diff navigator has been disposed"),!this.canNavigate())return;-1===this.nextIdx?this._initIdx(e):e?(this.nextIdx+=1,this.nextIdx>=this.ranges.length&&(this.nextIdx=0)):(this.nextIdx-=1,this.nextIdx<0&&(this.nextIdx=this.ranges.length-1));const t=this.ranges[this.nextIdx];this.ignoreSelectionChange=!0;try{const e=t.range.getStartPosition();this._editor.setPosition(e),this._editor.revealRangeInCenter(t.range,i),this._updateAccessibilityState(e.lineNumber,!0)}finally{this.ignoreSelectionChange=!1}}_updateAccessibilityState(e,i){var t;const o=null===(t=this._editor.getModel())||void 0===t?void 0:t.modified;if(!o)return;const n=o.getLineDecorations(e).find((e=>"line-insert"===e.options.className));if(n)this._audioCueService.playAudioCue(d.y$.diffLineModified,!0);else{if(!i)return;this._audioCueService.playAudioCue(d.y$.diffLineDeleted,!0)}const s=this._codeEditorService.getActiveCodeEditor();i&&s&&n&&this._accessibilityService.isScreenReaderOptimized()&&(s.setSelection({startLineNumber:e,startColumn:0,endLineNumber:e,endColumn:Number.MAX_VALUE}),s.writeScreenReaderContent("diff-navigation"))}canNavigate(){return this.ranges&&this.ranges.length>0}next(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.canNavigateNext()&&this._move(!0,e)}previous(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.canNavigatePrevious()&&this._move(!1,e)}canNavigateNext(){return this.canNavigateLoop()||this.nextIdx<this.ranges.length-1}canNavigatePrevious(){return this.canNavigateLoop()||0!==this.nextIdx}canNavigateLoop(){return Boolean(this._options.findResultLoop)}dispose(){super.dispose(),this.ranges=[],this.disposed=!0}};m=u([c(2,d.e7),c(3,l.$),c(4,h.F)],m)},84017:(e,i,t)=>{t.d(i,{H:()=>f});var o=t(62922),n=t(3527),s=t(21290),r=t(39049),a=t(10071),d=t(22046),l=t(37709),h=t(58023),u=t(65429),c=t(41598),g=t(90024),m=function(e,i,t,o){var n,s=arguments.length,r=s<3?i:null===o?o=Object.getOwnPropertyDescriptor(i,t):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,i,t,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(r=(s<3?n(r):s>3?n(i,t,r):n(i,t))||r);return s>3&&r&&Object.defineProperty(i,t,r),r},_=function(e,i){return function(t,o){i(t,o,e)}};let f=class extends s.Gm{constructor(e,i,t,o,n,s,r,a,d,l,h,u,c){super(e,Object.assign(Object.assign({},o.getRawOptions()),{overflowWidgetsDomNode:o.getOverflowWidgetsDomNode()}),t,n,s,r,a,d,l,h,u,c),this._parentEditor=o,this._overwriteOptions=i,super.updateOptions(this._overwriteOptions),this._register(o.onDidChangeConfiguration((e=>this._onParentConfigurationChanged(e))))}getParentEditor(){return this._parentEditor}_onParentConfigurationChanged(e){super.updateOptions(this._parentEditor.getRawOptions()),super.updateOptions(this._overwriteOptions)}updateOptions(e){o.jB(this._overwriteOptions,e,!0),super.updateOptions(this._overwriteOptions)}};f=m([_(4,d.TG),_(5,n.$),_(6,r.H),_(7,a.i6),_(8,h.XE),_(9,l.lT),_(10,u.F),_(11,c.c_),_(12,g.p)],f)}}]);
//# sourceMappingURL=monaco-editor-vendor.55a95165.f7e471fd.js.map